<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Python for Data Analysis, 3E - 4&nbsp; NumPy Basics: Arrays and Vectorized Computation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./pandas-basics.html" rel="next">
<link href="./python-builtin.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Python for Data Analysis, 3E - 4&nbsp; NumPy Basics: Arrays and Vectorized Computation">
<meta property="og:description" content="">
<meta property="og:image" content="images/cover.png">
<meta property="og:site-name" content="Python for Data Analysis, 3E">
<meta name="twitter:title" content="Python for Data Analysis, 3E - 4&nbsp; NumPy Basics: Arrays and Vectorized Computation">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="images/cover.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class='navbar-brand' href='/book/'>
    <span class="navbar-title">Python for Data Analysis, 3E</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class='nav-link' href='https://wesmckinney.com/archives' rel target>
 <span class="menu-text">Wes’s Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/wesmckinn" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">    
        <li>
    <a class="dropdown-item" href="https://github.com/wesm/pydata-book" rel="" target="">
 <span class="dropdown-text">Data and Notebooks (GitHub)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://gitee.com/wesmckinn/pydata-book" rel="" target="">
 <span class="dropdown-text">Data and Notebooks (Gitee)</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href='/book/preface'>Chapters</a></li><li class="breadcrumb-item"><a href='/book/numpy-basics'><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">NumPy Basics: Arrays and Vectorized Computation</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/'>
 <span class="menu-text">About the Open Edition</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Chapters</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/preface'>
 <span class="menu-text">Preface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/preliminaries'>
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preliminaries</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/python-basics'>
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Python Language Basics, IPython, and Jupyter Notebooks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/python-builtin'>
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Built-In Data Structures, Functions, and Files</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link active' href='/book/numpy-basics'>
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">NumPy Basics: Arrays and Vectorized Computation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/pandas-basics'>
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Getting Started with pandas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/accessing-data'>
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Loading, Storage, and File Formats</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/data-cleaning'>
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Cleaning and Preparation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/data-wrangling'>
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data Wrangling: Join, Combine, and Reshape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/plotting-and-visualization'>
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Plotting and Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/data-aggregation'>
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Aggregation and Group Operations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/time-series'>
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Time Series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/modeling'>
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Modeling Libraries in Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/data-analysis-examples'>
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Analysis Examples</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/advanced-numpy'>
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Advanced NumPy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/ipython'>
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">More on the IPython System</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<a href="https://amzn.to/3DyLaJc"><img src="images/cover.png" class="img-fluid"></a>
<div data-ea-publisher="wesmckinneycom" data-ea-type="image">

</div>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#numpy_ndarrays" id="toc-numpy_ndarrays" class="nav-link active" data-scroll-target="#numpy_ndarrays"><span class="header-section-number">4.1</span> The NumPy ndarray: A Multidimensional Array Object</a>
  <ul class="collapse">
  <li><a href="#numpy_construction" id="toc-numpy_construction" class="nav-link" data-scroll-target="#numpy_construction">Creating ndarrays</a></li>
  <li><a href="#numpy_dtypes" id="toc-numpy_dtypes" class="nav-link" data-scroll-target="#numpy_dtypes">Data Types for ndarrays</a></li>
  <li><a href="#ndarray_binops" id="toc-ndarray_binops" class="nav-link" data-scroll-target="#ndarray_binops">Arithmetic with NumPy Arrays</a></li>
  <li><a href="#ndarray_indexing" id="toc-ndarray_indexing" class="nav-link" data-scroll-target="#ndarray_indexing">Basic Indexing and Slicing</a></li>
  <li><a href="#ndarray_boolean" id="toc-ndarray_boolean" class="nav-link" data-scroll-target="#ndarray_boolean">Boolean Indexing</a></li>
  <li><a href="#ndarray_fancy" id="toc-ndarray_fancy" class="nav-link" data-scroll-target="#ndarray_fancy">Fancy Indexing</a></li>
  <li><a href="#numpy_transposing" id="toc-numpy_transposing" class="nav-link" data-scroll-target="#numpy_transposing">Transposing Arrays and Swapping Axes</a></li>
  </ul></li>
  <li><a href="#numpy_random" id="toc-numpy_random" class="nav-link" data-scroll-target="#numpy_random"><span class="header-section-number">4.2</span> Pseudorandom Number Generation</a></li>
  <li><a href="#numpy_ufuncs" id="toc-numpy_ufuncs" class="nav-link" data-scroll-target="#numpy_ufuncs"><span class="header-section-number">4.3</span> Universal Functions: Fast Element-Wise <span class="pagebreak-before">Array Functions</span></a></li>
  <li><a href="#numpy_processing" id="toc-numpy_processing" class="nav-link" data-scroll-target="#numpy_processing"><span class="header-section-number">4.4</span> Array-Oriented Programming with Arrays</a>
  <ul class="collapse">
  <li><a href="#numpy_where" id="toc-numpy_where" class="nav-link" data-scroll-target="#numpy_where">Expressing Conditional Logic as Array Operations</a></li>
  <li><a href="#ndarray_statistics" id="toc-ndarray_statistics" class="nav-link" data-scroll-target="#ndarray_statistics">Mathematical and Statistical Methods</a></li>
  <li><a href="#numpy_boolean_array_methods" id="toc-numpy_boolean_array_methods" class="nav-link" data-scroll-target="#numpy_boolean_array_methods">Methods for Boolean Arrays</a></li>
  <li><a href="#numpy_sorting" id="toc-numpy_sorting" class="nav-link" data-scroll-target="#numpy_sorting">Sorting</a></li>
  <li><a href="#numpy_algos_sets" id="toc-numpy_algos_sets" class="nav-link" data-scroll-target="#numpy_algos_sets">Unique and Other Set Logic</a></li>
  </ul></li>
  <li><a href="#numpy_io_basics" id="toc-numpy_io_basics" class="nav-link" data-scroll-target="#numpy_io_basics"><span class="header-section-number">4.5</span> File Input and Output with Arrays</a></li>
  <li><a href="#numpy_linalg" id="toc-numpy_linalg" class="nav-link" data-scroll-target="#numpy_linalg"><span class="header-section-number">4.6</span> Linear Algebra</a></li>
  <li><a href="#example_random_walks" id="toc-example_random_walks" class="nav-link" data-scroll-target="#example_random_walks"><span class="header-section-number">4.7</span> Example: Random Walks</a>
  <ul class="collapse">
  <li><a href="#example_random_walks_many" id="toc-example_random_walks_many" class="nav-link" data-scroll-target="#example_random_walks_many">Simulating Many Random Walks at Once</a></li>
  </ul></li>
  <li><a href="#numpy_moving_forward" id="toc-numpy_moving_forward" class="nav-link" data-scroll-target="#numpy_moving_forward"><span class="header-section-number">4.8</span> Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="numpy" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">NumPy Basics: Arrays and Vectorized Computation</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>This Open Access web version of <em>Python for Data Analysis 3rd Edition</em> is now available as a companion to the <a href="https://amzn.to/3DyLaJc">print and digital editions</a>. If you encounter any errata, <a href="https://oreilly.com/catalog/0636920519829/errata">please report them here</a>. Please note that some aspects of this site as produced by Quarto will differ from the formatting of the print and eBook versions from O’Reilly.</p>
<p>If you find the online edition of the book useful, please consider <a href="https://amzn.to/3DyLaJc">ordering a paper copy</a> or a <a href="https://www.ebooks.com/en-us/book/210644288/python-for-data-analysis/wes-mckinney/?affId=WES398681F">DRM-free eBook</a> to support the author. The content from this website may not be copied or reproduced. The code examples are MIT licensed and can be found on GitHub or Gitee.</p>
</div>
</div>
</div>
<p>NumPy, short for Numerical Python, is one of the most important foundational packages for numerical computing in Python. Many computational packages providing scientific functionality use NumPy's array objects as one of the standard interface <em>lingua francas</em> for data exchange. Much of the knowledge about NumPy that I cover is transferable to pandas as well.</p>
<p>Here are some of the things you'll find in NumPy:</p>
<ul>
<li><p>ndarray, an efficient multidimensional array providing fast array-oriented arithmetic operations and flexible <em>broadcasting</em> capabilities</p></li>
<li><p>Mathematical functions for fast operations on entire arrays of data without having to write loops</p></li>
<li><p>Tools for reading/writing array data to disk and working with memory-mapped files</p></li>
<li><p>Linear algebra, random number generation, and Fourier transform capabilities</p></li>
<li><p>A C API for connecting NumPy with libraries written in C, C++, or FORTRAN</p></li>
</ul>
<p>Because NumPy provides a comprehensive and well-documented C API, it is straightforward to pass data to external libraries written in a low-level language, and for external libraries to return data to Python as NumPy arrays. This feature has made Python a language of choice for wrapping legacy C, C++, or FORTRAN codebases and giving them a dynamic and accessible interface.</p>
<p>While NumPy by itself does not provide modeling or scientific functionality, having an understanding of NumPy arrays and array-oriented computing will help you use tools with array computing semantics, like pandas, much more effectively. Since NumPy is a large topic, I will cover many advanced NumPy features like broadcasting in more depth later (see <a href='/book/advanced-numpy'>Appendix A: Advanced NumPy</a>). Many of these advanced features are not needed to follow the rest of this book, but they may help you as you go deeper into scientific computing in Python.</p>
<p>For most data analysis applications, the main areas of functionality I’ll focus on are:</p>
<ul>
<li><p>Fast array-based operations for data munging and cleaning, subsetting and filtering, transformation, and any other kind of computation</p></li>
<li><p>Common array algorithms like sorting, unique, and set operations</p></li>
<li><p>Efficient descriptive statistics and aggregating/summarizing data</p></li>
<li><p>Data alignment and relational data manipulations for merging and joining heterogeneous datasets</p></li>
<li><p>Expressing conditional logic as array expressions instead of loops with <code>if-elif-else</code> branches</p></li>
<li><p>Group-wise data manipulations (aggregation, transformation, and function application)</p></li>
</ul>
<p>While NumPy provides a computational foundation for general numerical data processing, many readers will want to use pandas as the basis for most kinds of statistics or analytics, especially on tabular data. Also, pandas provides some more domain-specific functionality like time series manipulation, which is not present in NumPy.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Array-oriented computing in Python traces its roots back to 1995, when Jim Hugunin created the Numeric library. Over the next 10 years, many scientific programming communities began doing array programming in Python, but the library ecosystem had become fragmented in the early 2000s. In 2005, Travis Oliphant was able to forge the NumPy project from the then Numeric and Numarray projects to bring the community together around a single array computing framework.</p>
</div>
</div>
<p>One of the reasons NumPy is so important for numerical computations in Python is because it is designed for efficiency on large arrays of data. There are a number of reasons for this:</p>
<ul>
<li><p>NumPy internally stores data in a contiguous block of memory, independent of other built-in Python objects. NumPy's library of algorithms written in the C language can operate on this memory without any type checking or other overhead. NumPy arrays also use much less memory than built-in Python sequences.</p></li>
<li><p>NumPy operations perform complex computations on entire arrays without the need for Python <code>for</code> loops, which can be slow for large sequences. NumPy is faster than regular Python code because its C-based algorithms avoid overhead present with regular interpreted Python code.</p></li>
</ul>
<p>To give you an idea of the performance difference, consider a NumPy array of one million integers, and the equivalent Python list:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">7</span>]: <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">8</span>]: my_arr <span class="op">=</span> np.arange(<span class="dv">1_000_000</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">9</span>]: my_list <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1_000_000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now let's multiply each sequence by 2:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">10</span>]: <span class="op">%</span>timeit my_arr2 <span class="op">=</span> my_arr <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="dv">309</span> us <span class="op">+-</span> <span class="fl">7.48</span> us per loop (mean <span class="op">+-</span> std. dev. of <span class="dv">7</span> runs, <span class="dv">1000</span> loops each)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">11</span>]: <span class="op">%</span>timeit my_list2 <span class="op">=</span> [x <span class="op">*</span> <span class="dv">2</span> <span class="cf">for</span> x <span class="kw">in</span> my_list]</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fl">46.4</span> ms <span class="op">+-</span> <span class="dv">526</span> us per loop (mean <span class="op">+-</span> std. dev. of <span class="dv">7</span> runs, <span class="dv">10</span> loops each)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>NumPy-based algorithms are generally 10 to 100 times faster (or more) than their pure Python counterparts and use significantly less memory.</p>
<section id="numpy_ndarrays" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="numpy_ndarrays"><span class="header-section-number">4.1</span> The NumPy ndarray: A Multidimensional Array Object</h2>
<p>One of the key features of NumPy is its N-dimensional array object, or ndarray, which is a fast, flexible container for large datasets in Python. Arrays enable you to perform mathematical operations on whole blocks of data using similar syntax to the equivalent operations between scalar elements.</p>
<p>To give you a flavor of how NumPy enables batch computations with similar syntax to scalar values on built-in Python objects, I first import NumPy and create a small array:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">12</span>]: <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">13</span>]: data <span class="op">=</span> np.array([[<span class="fl">1.5</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="dv">3</span>], [<span class="dv">0</span>, <span class="op">-</span><span class="dv">3</span>, <span class="fl">6.5</span>]])</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">14</span>]: data</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">14</span>]: </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>array([[ <span class="fl">1.5</span>, <span class="op">-</span><span class="fl">0.1</span>,  <span class="fl">3.</span> ],</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.</span> , <span class="op">-</span><span class="fl">3.</span> ,  <span class="fl">6.5</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>I then write mathematical operations with <code>data</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">15</span>]: data <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">15</span>]: </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>array([[ <span class="fl">15.</span>,  <span class="op">-</span><span class="fl">1.</span>,  <span class="fl">30.</span>],</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>       [  <span class="fl">0.</span>, <span class="op">-</span><span class="fl">30.</span>,  <span class="fl">65.</span>]])</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">16</span>]: data <span class="op">+</span> data</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">16</span>]: </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>array([[ <span class="fl">3.</span> , <span class="op">-</span><span class="fl">0.2</span>,  <span class="fl">6.</span> ],</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.</span> , <span class="op">-</span><span class="fl">6.</span> , <span class="fl">13.</span> ]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In the first example, all of the elements have been multiplied by 10. In the second, the corresponding values in each "cell" in the array have been added to each other.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this chapter and throughout the book, I use the standard NumPy convention of always using <code>import numpy as np</code>. It would be possible to put <code>from numpy import *</code> in your code to avoid having to write <code>np.</code>, but I advise against making a habit of this. The <code>numpy</code> namespace is large and contains a number of functions whose names conflict with built-in Python functions (like <code>min</code> and <code>max</code>). Following standard conventions like these is almost always a good idea.</p>
</div>
</div>
<p>An ndarray is a generic multidimensional container for homogeneous data; that is, all of the elements must be the same type. Every array has a <code>shape</code>, a tuple indicating the size of each dimension, and a <code>dtype</code>, an object describing the <em>data type</em> of the array:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">17</span>]: data.shape</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">17</span>]: (<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">18</span>]: data.dtype</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">18</span>]: dtype(<span class="st">'float64'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This chapter will introduce you to the basics of using NumPy arrays, and it should be sufficient for following along with the rest of the book. While it’s not necessary to have a deep understanding of NumPy for many data analytical applications, becoming proficient in array-oriented programming and thinking is a key step along the way to becoming a scientific Python guru.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Whenever you see “array,” “NumPy array,” or “ndarray” in the book text, in most cases they all refer to the ndarray object.</p>
</div>
</div>
<section id="numpy_construction" class="level3">
<h3 class="anchored" data-anchor-id="numpy_construction">Creating ndarrays</h3>
<p>The easiest way to create an array is to use the <code>array</code> function. This accepts any sequence-like object (including other arrays) and produces a new NumPy array containing the passed data. For example, a list is a good candidate for conversion:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">19</span>]: data1 <span class="op">=</span> [<span class="dv">6</span>, <span class="fl">7.5</span>, <span class="dv">8</span>, <span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">20</span>]: arr1 <span class="op">=</span> np.array(data1)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">21</span>]: arr1</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">21</span>]: array([<span class="fl">6.</span> , <span class="fl">7.5</span>, <span class="fl">8.</span> , <span class="fl">0.</span> , <span class="fl">1.</span> ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Nested sequences, like a list of equal-length lists, will be converted into a multidimensional array:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">22</span>]: data2 <span class="op">=</span> [[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], [<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>]]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">23</span>]: arr2 <span class="op">=</span> np.array(data2)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">24</span>]: arr2</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">24</span>]: </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Since <code>data2</code> was a list of lists, the NumPy array <code>arr2</code> has two dimensions, with shape inferred from the data. We can confirm this by inspecting the <code>ndim</code> and <code>shape</code> attributes:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">25</span>]: arr2.ndim</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">25</span>]: <span class="dv">2</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">26</span>]: arr2.shape</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">26</span>]: (<span class="dv">2</span>, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Unless explicitly specified (discussed in <a href="#numpy_dtypes">Data Types for ndarrays</a>), <code>numpy.array</code> tries to infer a good data type for the array that it creates. The data type is stored in a special <code>dtype</code> metadata object; for example, in the previous two examples we have:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">27</span>]: arr1.dtype</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">27</span>]: dtype(<span class="st">'float64'</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">28</span>]: arr2.dtype</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">28</span>]: dtype(<span class="st">'int64'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In addition to <code>numpy.array</code>, there are a number of other functions for creating new arrays. As examples, <code>numpy.zeros</code> and <code>numpy.ones</code> create arrays of 0s or 1s, respectively, with a given length or shape. <code>numpy.empty</code> creates an array without initializing its values to any particular value. To create a higher dimensional array with these methods, pass a tuple for the shape:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">29</span>]: np.zeros(<span class="dv">10</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">29</span>]: array([<span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>])</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">30</span>]: np.zeros((<span class="dv">3</span>, <span class="dv">6</span>))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">30</span>]: </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>array([[<span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>],</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>],</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>]])</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">31</span>]: np.empty((<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">31</span>]: </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>array([[[<span class="fl">0.</span>, <span class="fl">0.</span>],</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>        [<span class="fl">0.</span>, <span class="fl">0.</span>],</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>        [<span class="fl">0.</span>, <span class="fl">0.</span>]],</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>       [[<span class="fl">0.</span>, <span class="fl">0.</span>],</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        [<span class="fl">0.</span>, <span class="fl">0.</span>],</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        [<span class="fl">0.</span>, <span class="fl">0.</span>]]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>It’s not safe to assume that <code>numpy.empty</code> will return an array of all zeros. This function returns uninitialized memory and thus may contain nonzero "garbage" values. You should use this function only if you intend to populate the new array with data.</p>
</div>
</div>
<p><code>numpy.arange</code> is an array-valued version of the built-in Python <code>range</code> function:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">32</span>]: np.arange(<span class="dv">15</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">32</span>]: array([ <span class="dv">0</span>,  <span class="dv">1</span>,  <span class="dv">2</span>,  <span class="dv">3</span>,  <span class="dv">4</span>,  <span class="dv">5</span>,  <span class="dv">6</span>,  <span class="dv">7</span>,  <span class="dv">8</span>,  <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>See <a href="#tbl-table_array_ctor">Table&nbsp;<span>4.1</span></a> for a short list of standard array creation functions. Since NumPy is focused on numerical computing, the data type, if not specified, will in many cases be <code>float64</code> (floating point).</p>
<div id="tbl-table_array_ctor" class="anchored">
<table class="table">
<caption>Table&nbsp;4.1: Some important NumPy array creation functions</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>array</code></td>
<td style="text-align: left;">Convert input data (list, tuple, array, or other sequence type) to an ndarray either by inferring a data type or explicitly specifying a data type; copies the input data by default</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>asarray</code></td>
<td style="text-align: left;">Convert input to ndarray, but do not copy if the input is already an ndarray</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>arange</code></td>
<td style="text-align: left;">Like the built-in <code>range</code> but returns an ndarray instead of a list</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ones, ones_like</code></td>
<td style="text-align: left;">Produce an array of all 1s with the given shape and data type; <code>ones_like</code> takes another array and produces a <code>ones</code> array of the same shape and data type</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>zeros, zeros_like</code></td>
<td style="text-align: left;">Like <code>ones</code> and <code>ones_like</code> but producing arrays of 0s instead</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>empty, empty_like</code></td>
<td style="text-align: left;">Create new arrays by allocating new memory, but do not populate with any values like <code>ones</code> and <code>zeros</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>full, full_like</code></td>
<td style="text-align: left;">Produce an array of the given shape and data type with all values set to the indicated "fill value"; <code>full_like</code> takes another array and produces a filled array of the same shape and data type</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>eye, identity</code></td>
<td style="text-align: left;">Create a square N × N identity matrix (1s on the diagonal and 0s elsewhere)</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="numpy_dtypes" class="level3">
<h3 class="anchored" data-anchor-id="numpy_dtypes">Data Types for ndarrays</h3>
<p>The <em>data type</em> or <code>dtype</code> is a special object containing the information (or <em>metadata</em>, data about data) the ndarray needs to interpret a chunk of memory as a particular type of data:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">33</span>]: arr1 <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], dtype<span class="op">=</span>np.float64)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">34</span>]: arr2 <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], dtype<span class="op">=</span>np.int32)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">35</span>]: arr1.dtype</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">35</span>]: dtype(<span class="st">'float64'</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">36</span>]: arr2.dtype</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">36</span>]: dtype(<span class="st">'int32'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Data types are a source of NumPy's flexibility for interacting with data coming from other systems. In most cases they provide a mapping directly onto an underlying disk or memory representation, which makes it possible to read and write binary streams of data to disk and to connect to code written in a low-level language like C or FORTRAN. The numerical data types are named the same way: a type name, like <code>float</code> or <code>int</code>, followed by a number indicating the number of bits per element. A standard double-precision floating-point value (what’s used under the hood in Python’s <code>float</code> object) takes up 8 bytes or 64 bits. Thus, this type is known in NumPy as <code>float64</code>. See <a href="#tbl-table_array_dtypes">Table&nbsp;<span>4.2</span></a> for a full listing of NumPy’s supported data types.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Don’t worry about memorizing the NumPy data types, especially if you’re a new user. It’s often only necessary to care about the general <em>kind</em> of data you’re dealing with, whether floating point, complex, integer, Boolean, string, or general Python object. When you need more control over how data is stored in memory and on disk, especially large datasets, it is good to know that you have control over the storage type.</p>
</div>
</div>
<div id="tbl-table_array_dtypes" class="anchored">
<table class="table">
<caption>Table&nbsp;4.2: NumPy data types</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Type code</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>int8, uint8</code></td>
<td style="text-align: left;"><code>i1, u1</code></td>
<td style="text-align: left;">Signed and unsigned 8-bit (1 byte) integer types</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>int16, uint16</code></td>
<td style="text-align: left;"><code>i2, u2</code></td>
<td style="text-align: left;">Signed and unsigned 16-bit integer types</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>int32, uint32</code></td>
<td style="text-align: left;"><code>i4, u4</code></td>
<td style="text-align: left;">Signed and unsigned 32-bit integer types</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>int64, uint64</code></td>
<td style="text-align: left;"><code>i8, u8</code></td>
<td style="text-align: left;">Signed and unsigned 64-bit integer types</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>float16</code></td>
<td style="text-align: left;"><code>f2</code></td>
<td style="text-align: left;">Half-precision floating point</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>float32</code></td>
<td style="text-align: left;"><code>f4 or f</code></td>
<td style="text-align: left;">Standard single-precision floating point; compatible with C float</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>float64</code></td>
<td style="text-align: left;"><code>f8 or d</code></td>
<td style="text-align: left;">Standard double-precision floating point; compatible with C double and Python <code>float</code> object</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>float128</code></td>
<td style="text-align: left;"><code>f16 or g</code></td>
<td style="text-align: left;">Extended-precision floating point</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>complex64</code>, <code>complex128</code>, <code>complex256</code></td>
<td style="text-align: left;"><code>c8, c16, c32</code></td>
<td style="text-align: left;">Complex numbers represented by two 32, 64, or 128 floats, respectively</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">?</td>
<td style="text-align: left;">Boolean type storing <code>True</code> and <code>False</code> values</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>object</code></td>
<td style="text-align: left;">O</td>
<td style="text-align: left;">Python object type; a value can be any Python object</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>string_</code></td>
<td style="text-align: left;">S</td>
<td style="text-align: left;">Fixed-length ASCII string type (1 byte per character); for example, to create a string data type with length 10, use <code>'S10'</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>unicode_</code></td>
<td style="text-align: left;">U</td>
<td style="text-align: left;">Fixed-length Unicode type (number of bytes platform specific); same specification semantics as <code>string_</code> (e.g., <code>'U10'</code>)</td>
</tr>
</tbody>
</table>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>There are both <em>signed</em> and <em>unsigned</em> integer types, and many readers will not be familiar with this terminology. A <em>signed</em> integer can represent both positive and negative integers, while an <em>unsigned</em> integer can only represent nonzero integers. For example, <code>int8</code> (signed 8-bit integer) can represent integers from -128 to 127 (inclusive), while <code>uint8</code> (unsigned 8-bit integer) can represent 0 through 255.</p>
</div>
</div>
<p>You can explicitly convert or <em>cast</em> an array from one data type to another using ndarray’s <code>astype</code> method:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">37</span>]: arr <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">38</span>]: arr.dtype</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">38</span>]: dtype(<span class="st">'int64'</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">39</span>]: float_arr <span class="op">=</span> arr.astype(np.float64)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">40</span>]: float_arr</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">40</span>]: array([<span class="fl">1.</span>, <span class="fl">2.</span>, <span class="fl">3.</span>, <span class="fl">4.</span>, <span class="fl">5.</span>])</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">41</span>]: float_arr.dtype</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">41</span>]: dtype(<span class="st">'float64'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In this example, integers were cast to floating point. If I cast some floating-point numbers to be of integer data type, the decimal part will be truncated:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">42</span>]: arr <span class="op">=</span> np.array([<span class="fl">3.7</span>, <span class="op">-</span><span class="fl">1.2</span>, <span class="op">-</span><span class="fl">2.6</span>, <span class="fl">0.5</span>, <span class="fl">12.9</span>, <span class="fl">10.1</span>])</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">43</span>]: arr</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">43</span>]: array([ <span class="fl">3.7</span>, <span class="op">-</span><span class="fl">1.2</span>, <span class="op">-</span><span class="fl">2.6</span>,  <span class="fl">0.5</span>, <span class="fl">12.9</span>, <span class="fl">10.1</span>])</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">44</span>]: arr.astype(np.int32)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">44</span>]: array([ <span class="dv">3</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">2</span>,  <span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">10</span>], dtype<span class="op">=</span>int32)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you have an array of strings representing numbers, you can use <code>astype</code> to convert them to numeric form:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">45</span>]: numeric_strings <span class="op">=</span> np.array([<span class="st">"1.25"</span>, <span class="st">"-9.6"</span>, <span class="st">"42"</span>], dtype<span class="op">=</span>np.string_)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">46</span>]: numeric_strings.astype(<span class="bu">float</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">46</span>]: array([ <span class="fl">1.25</span>, <span class="op">-</span><span class="fl">9.6</span> , <span class="fl">42.</span>  ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Be cautious when using the <code>numpy.string_</code> type, as string data in NumPy is fixed size and may truncate input without warning. pandas has more intuitive out-of-the-box behavior on non-numeric data.</p>
</div>
</div>
<p>If casting were to fail for some reason (like a string that cannot be converted to <code>float64</code>), a <code>ValueError</code> will be raised. Before, I was a bit lazy and wrote <code>float</code> instead of <code>np.float64</code>; NumPy aliases the Python types to its own equivalent data types.</p>
<p>You can also use another array’s <code>dtype</code> attribute:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">47</span>]: int_array <span class="op">=</span> np.arange(<span class="dv">10</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">48</span>]: calibers <span class="op">=</span> np.array([<span class="fl">.22</span>, <span class="fl">.270</span>, <span class="fl">.357</span>, <span class="fl">.380</span>, <span class="fl">.44</span>, <span class="fl">.50</span>], dtype<span class="op">=</span>np.float64)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">49</span>]: int_array.astype(calibers.dtype)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">49</span>]: array([<span class="fl">0.</span>, <span class="fl">1.</span>, <span class="fl">2.</span>, <span class="fl">3.</span>, <span class="fl">4.</span>, <span class="fl">5.</span>, <span class="fl">6.</span>, <span class="fl">7.</span>, <span class="fl">8.</span>, <span class="fl">9.</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>There are shorthand type code strings you can also use to refer to a <code>dtype</code>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">50</span>]: zeros_uint32 <span class="op">=</span> np.zeros(<span class="dv">8</span>, dtype<span class="op">=</span><span class="st">"u4"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">51</span>]: zeros_uint32</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">51</span>]: array([<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], dtype<span class="op">=</span>uint32)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Calling <code>astype</code> <em>always</em> creates a new array (a copy of the data), even if the new data type is the same as the old data type.</p>
</div>
</div>
</section>
<section id="ndarray_binops" class="level3">
<h3 class="anchored" data-anchor-id="ndarray_binops">Arithmetic with NumPy Arrays</h3>
<p>Arrays are important because they enable you to express batch operations on data without writing any <code>for</code> loops. NumPy users call this <em>vectorization</em>. Any arithmetic operations between equal-size arrays apply the operation element-wise:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">52</span>]: arr <span class="op">=</span> np.array([[<span class="fl">1.</span>, <span class="fl">2.</span>, <span class="fl">3.</span>], [<span class="fl">4.</span>, <span class="fl">5.</span>, <span class="fl">6.</span>]])</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">53</span>]: arr</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">53</span>]: </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>array([[<span class="fl">1.</span>, <span class="fl">2.</span>, <span class="fl">3.</span>],</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">4.</span>, <span class="fl">5.</span>, <span class="fl">6.</span>]])</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">54</span>]: arr <span class="op">*</span> arr</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">54</span>]: </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>array([[ <span class="fl">1.</span>,  <span class="fl">4.</span>,  <span class="fl">9.</span>],</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">16.</span>, <span class="fl">25.</span>, <span class="fl">36.</span>]])</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">55</span>]: arr <span class="op">-</span> arr</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">55</span>]: </span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>array([[<span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>],</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Arithmetic operations with scalars propagate the scalar argument to each element in the array:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">56</span>]: <span class="dv">1</span> <span class="op">/</span> arr</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">56</span>]: </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>array([[<span class="fl">1.</span>    , <span class="fl">0.5</span>   , <span class="fl">0.3333</span>],</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">0.25</span>  , <span class="fl">0.2</span>   , <span class="fl">0.1667</span>]])</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">57</span>]: arr <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">57</span>]: </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>array([[ <span class="fl">1.</span>,  <span class="fl">4.</span>,  <span class="fl">9.</span>],</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">16.</span>, <span class="fl">25.</span>, <span class="fl">36.</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Comparisons between arrays of the same size yield Boolean arrays:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">58</span>]: arr2 <span class="op">=</span> np.array([[<span class="fl">0.</span>, <span class="fl">4.</span>, <span class="fl">1.</span>], [<span class="fl">7.</span>, <span class="fl">2.</span>, <span class="fl">12.</span>]])</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">59</span>]: arr2</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">59</span>]: </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>array([[ <span class="fl">0.</span>,  <span class="fl">4.</span>,  <span class="fl">1.</span>],</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">7.</span>,  <span class="fl">2.</span>, <span class="fl">12.</span>]])</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">60</span>]: arr2 <span class="op">&gt;</span> arr</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">60</span>]: </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>array([[<span class="va">False</span>,  <span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>       [ <span class="va">True</span>, <span class="va">False</span>,  <span class="va">True</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Evaluating operations between differently sized arrays is called <em>broadcasting</em> and will be discussed in more detail in <a href='/book/advanced-numpy'>Appendix A: Advanced NumPy</a>. Having a deep understanding of broadcasting is not necessary for most of this book.</p>
</section>
<section id="ndarray_indexing" class="level3">
<h3 class="anchored" data-anchor-id="ndarray_indexing">Basic Indexing and Slicing</h3>
<p>NumPy array indexing is a deep topic, as there are many ways you may want to select a subset of your data or individual elements. One-dimensional arrays are simple; on the surface they act similarly to Python lists:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">61</span>]: arr <span class="op">=</span> np.arange(<span class="dv">10</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">62</span>]: arr</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">62</span>]: array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>])</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">63</span>]: arr[<span class="dv">5</span>]</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">63</span>]: <span class="dv">5</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">64</span>]: arr[<span class="dv">5</span>:<span class="dv">8</span>]</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">64</span>]: array([<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>])</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">65</span>]: arr[<span class="dv">5</span>:<span class="dv">8</span>] <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">66</span>]: arr</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">66</span>]: array([ <span class="dv">0</span>,  <span class="dv">1</span>,  <span class="dv">2</span>,  <span class="dv">3</span>,  <span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">12</span>, <span class="dv">12</span>,  <span class="dv">8</span>,  <span class="dv">9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>As you can see, if you assign a scalar value to a slice, as in <code>arr[5:8] = 12</code>, the value is propagated (or <em>broadcast</em> henceforth) to the entire selection.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>An important first distinction from Python's built-in lists is that array slices are views on the original array. This means that the data is not copied, and any modifications to the view will be reflected in the source array.</p>
</div>
</div>
<p>To give an example of this, I first create a slice of <code>arr</code>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">67</span>]: arr_slice <span class="op">=</span> arr[<span class="dv">5</span>:<span class="dv">8</span>]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">68</span>]: arr_slice</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">68</span>]: array([<span class="dv">12</span>, <span class="dv">12</span>, <span class="dv">12</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now, when I change values in <code>arr_slice</code>, the mutations are reflected in the original array <code>arr</code>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">69</span>]: arr_slice[<span class="dv">1</span>] <span class="op">=</span> <span class="dv">12345</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">70</span>]: arr</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">70</span>]: </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>array([    <span class="dv">0</span>,     <span class="dv">1</span>,     <span class="dv">2</span>,     <span class="dv">3</span>,     <span class="dv">4</span>,    <span class="dv">12</span>, <span class="dv">12345</span>,    <span class="dv">12</span>,     <span class="dv">8</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>           <span class="dv">9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The "bare" slice <code>[:]</code> will assign to all values in an array:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">71</span>]: arr_slice[:] <span class="op">=</span> <span class="dv">64</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">72</span>]: arr</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">72</span>]: array([ <span class="dv">0</span>,  <span class="dv">1</span>,  <span class="dv">2</span>,  <span class="dv">3</span>,  <span class="dv">4</span>, <span class="dv">64</span>, <span class="dv">64</span>, <span class="dv">64</span>,  <span class="dv">8</span>,  <span class="dv">9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you are new to NumPy, you might be surprised by this, especially if you have used other array programming languages that copy data more eagerly. As NumPy has been designed to be able to work with very large arrays, you could imagine performance and memory problems if NumPy insisted on always copying data.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you want a copy of a slice of an ndarray instead of a view, you will need to explicitly copy the array—for example, <code>arr[5:8].copy()</code>. As you will see, pandas works this way, too.</p>
</div>
</div>
<p>With higher dimensional arrays, you have many more options. In a two-dimensional array, the elements at each index are no longer scalars but rather one-dimensional arrays:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">73</span>]: arr2d <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">74</span>]: arr2d[<span class="dv">2</span>]</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">74</span>]: array([<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Thus, individual elements can be accessed recursively. But that is a bit too much work, so you can pass a comma-separated list of indices to select individual elements. So these are equivalent:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">75</span>]: arr2d[<span class="dv">0</span>][<span class="dv">2</span>]</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">75</span>]: <span class="dv">3</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">76</span>]: arr2d[<span class="dv">0</span>, <span class="dv">2</span>]</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">76</span>]: <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>See <a href="#fig-figure_ndarray_indexing">Figure&nbsp;<span>4.1</span></a> for an illustration of indexing on a two-dimensional array. I find it helpful to think of axis 0 as the "rows" of the array and axis 1 as the "columns."</p>
<div id="fig-figure_ndarray_indexing" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/pda3_0401.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.1: Indexing elements in a NumPy array</figcaption>
</figure>
</div>
<p>In multidimensional arrays, if you omit later indices, the returned object will be a lower dimensional ndarray consisting of all the data along the higher dimensions. So in the 2 × 2 × 3 array <code>arr3d</code>:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">77</span>]: arr3d <span class="op">=</span> np.array([[[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]], [[<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>], [<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]]])</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">78</span>]: arr3d</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">78</span>]: </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>array([[[ <span class="dv">1</span>,  <span class="dv">2</span>,  <span class="dv">3</span>],</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        [ <span class="dv">4</span>,  <span class="dv">5</span>,  <span class="dv">6</span>]],</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>       [[ <span class="dv">7</span>,  <span class="dv">8</span>,  <span class="dv">9</span>],</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>        [<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>arr3d[0]</code> is a 2 × 3 array:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">79</span>]: arr3d[<span class="dv">0</span>]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">79</span>]: </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Both scalar values and arrays can be assigned to <code>arr3d[0]</code>:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">80</span>]: old_values <span class="op">=</span> arr3d[<span class="dv">0</span>].copy()</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">81</span>]: arr3d[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">82</span>]: arr3d</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">82</span>]: </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>array([[[<span class="dv">42</span>, <span class="dv">42</span>, <span class="dv">42</span>],</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>        [<span class="dv">42</span>, <span class="dv">42</span>, <span class="dv">42</span>]],</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>       [[ <span class="dv">7</span>,  <span class="dv">8</span>,  <span class="dv">9</span>],</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>        [<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]]])</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">83</span>]: arr3d[<span class="dv">0</span>] <span class="op">=</span> old_values</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">84</span>]: arr3d</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">84</span>]: </span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>array([[[ <span class="dv">1</span>,  <span class="dv">2</span>,  <span class="dv">3</span>],</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>        [ <span class="dv">4</span>,  <span class="dv">5</span>,  <span class="dv">6</span>]],</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>       [[ <span class="dv">7</span>,  <span class="dv">8</span>,  <span class="dv">9</span>],</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>        [<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Similarly, <code>arr3d[1, 0]</code> gives you all of the values whose indices start with <code>(1, 0)</code>, forming a one-dimensional array:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">85</span>]: arr3d[<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">85</span>]: array([<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This expression is the same as though we had indexed in two steps:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">86</span>]: x <span class="op">=</span> arr3d[<span class="dv">1</span>]</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">87</span>]: x</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">87</span>]: </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>array([[ <span class="dv">7</span>,  <span class="dv">8</span>,  <span class="dv">9</span>],</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]])</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">88</span>]: x[<span class="dv">0</span>]</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">88</span>]: array([<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that in all of these cases where subsections of the array have been selected, the returned arrays are views.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>This multidimensional indexing syntax for NumPy arrays will not work with regular Python objects, such as lists of lists.</p>
</div>
</div>
<section id="numpy_indexing_slices" class="level4">
<h4 class="anchored" data-anchor-id="numpy_indexing_slices">Indexing with slices</h4>
<p>Like one-dimensional objects such as Python lists, ndarrays can be sliced with the familiar syntax:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">89</span>]: arr</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">89</span>]: array([ <span class="dv">0</span>,  <span class="dv">1</span>,  <span class="dv">2</span>,  <span class="dv">3</span>,  <span class="dv">4</span>, <span class="dv">64</span>, <span class="dv">64</span>, <span class="dv">64</span>,  <span class="dv">8</span>,  <span class="dv">9</span>])</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">90</span>]: arr[<span class="dv">1</span>:<span class="dv">6</span>]</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">90</span>]: array([ <span class="dv">1</span>,  <span class="dv">2</span>,  <span class="dv">3</span>,  <span class="dv">4</span>, <span class="dv">64</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Consider the two-dimensional array from before, <code>arr2d</code>. Slicing this array is a bit different:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">91</span>]: arr2d</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">91</span>]: </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>],</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">92</span>]: arr2d[:<span class="dv">2</span>]</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">92</span>]: </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>As you can see, it has sliced along axis 0, the first axis. A slice, therefore, selects a range of elements along an axis. It can be helpful to read the expression <code>arr2d[:2]</code> as "select the first two rows of <code>arr2d</code>."</p>
<p>You can pass multiple slices just like you can pass multiple indexes:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">93</span>]: arr2d[:<span class="dv">2</span>, <span class="dv">1</span>:]</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">93</span>]: </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>array([[<span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">5</span>, <span class="dv">6</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>When slicing like this, you always obtain array views of the same number of dimensions. By mixing integer indexes and slices, you get lower dimensional slices.</p>
<p>For example, I can select the second row but only the first two columns, like so:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">94</span>]: lower_dim_slice <span class="op">=</span> arr2d[<span class="dv">1</span>, :<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Here, while <code>arr2d</code> is two-dimensional, <code>lower_dim_slice</code> is one-dimensional, and its shape is a tuple with one axis size:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">95</span>]: lower_dim_slice.shape</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">95</span>]: (<span class="dv">2</span>,)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Similarly, I can select the third column but only the first two rows, like so:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">96</span>]: arr2d[:<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">96</span>]: array([<span class="dv">3</span>, <span class="dv">6</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>See <a href="#fig-figure_ndarray_slicing">Figure&nbsp;<span>4.2</span></a> for an illustration. Note that a colon by itself means to take the entire axis, so you can slice only higher dimensional axes by doing:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">97</span>]: arr2d[:, :<span class="dv">1</span>]</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">97</span>]: </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>array([[<span class="dv">1</span>],</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">4</span>],</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">7</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Of course, assigning to a slice expression assigns to the whole selection:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">98</span>]: arr2d[:<span class="dv">2</span>, <span class="dv">1</span>:] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">99</span>]: arr2d</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">99</span>]: </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-figure_ndarray_slicing" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/pda3_0402.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.2: Two-dimensional array slicing</figcaption>
</figure>
</div>
</section>
</section>
<section id="ndarray_boolean" class="level3">
<h3 class="anchored" data-anchor-id="ndarray_boolean">Boolean Indexing</h3>
<p>Let’s consider an example where we have some data in an array and an array of names with duplicates:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">100</span>]: names <span class="op">=</span> np.array([<span class="st">"Bob"</span>, <span class="st">"Joe"</span>, <span class="st">"Will"</span>, <span class="st">"Bob"</span>, <span class="st">"Will"</span>, <span class="st">"Joe"</span>, <span class="st">"Joe"</span>])</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">101</span>]: data <span class="op">=</span> np.array([[<span class="dv">4</span>, <span class="dv">7</span>], [<span class="dv">0</span>, <span class="dv">2</span>], [<span class="op">-</span><span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>   .....:                  [<span class="op">-</span><span class="dv">12</span>, <span class="op">-</span><span class="dv">4</span>], [<span class="dv">3</span>, <span class="dv">4</span>]])</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">102</span>]: names</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">102</span>]: array([<span class="st">'Bob'</span>, <span class="st">'Joe'</span>, <span class="st">'Will'</span>, <span class="st">'Bob'</span>, <span class="st">'Will'</span>, <span class="st">'Joe'</span>, <span class="st">'Joe'</span>], dtype<span class="op">=</span><span class="st">'&lt;U4'</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">103</span>]: data</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">103</span>]: </span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>array([[  <span class="dv">4</span>,   <span class="dv">7</span>],</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>       [  <span class="dv">0</span>,   <span class="dv">2</span>],</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>       [ <span class="op">-</span><span class="dv">5</span>,   <span class="dv">6</span>],</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>       [  <span class="dv">0</span>,   <span class="dv">0</span>],</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>       [  <span class="dv">1</span>,   <span class="dv">2</span>],</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="dv">12</span>,  <span class="op">-</span><span class="dv">4</span>],</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>       [  <span class="dv">3</span>,   <span class="dv">4</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Suppose each name corresponds to a row in the <code>data</code> array and we wanted to select all the rows with the corresponding name <code>"Bob"</code>. Like arithmetic operations, comparisons (such as <code>==</code>) with arrays are also vectorized. Thus, comparing <code>names</code> with the string <code>"Bob"</code> yields a Boolean array:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">104</span>]: names <span class="op">==</span> <span class="st">"Bob"</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">104</span>]: array([ <span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>,  <span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>, <span class="va">False</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This Boolean array can be passed when indexing the array:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">105</span>]: data[names <span class="op">==</span> <span class="st">"Bob"</span>]</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">105</span>]: </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>array([[<span class="dv">4</span>, <span class="dv">7</span>],</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">0</span>, <span class="dv">0</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The Boolean array must be of the same length as the array axis it’s indexing. You can even mix and match Boolean arrays with slices or integers (or sequences of integers; more on this later).</p>
<p>In these examples, I select from the rows where <code>names == "Bob"</code> and index the columns, too:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">106</span>]: data[names <span class="op">==</span> <span class="st">"Bob"</span>, <span class="dv">1</span>:]</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">106</span>]: </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>array([[<span class="dv">7</span>],</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">0</span>]])</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">107</span>]: data[names <span class="op">==</span> <span class="st">"Bob"</span>, <span class="dv">1</span>]</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">107</span>]: array([<span class="dv">7</span>, <span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To select everything but <code>"Bob"</code> you can either use <code>!=</code> or negate the condition using <code>~</code>:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">108</span>]: names <span class="op">!=</span> <span class="st">"Bob"</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">108</span>]: array([<span class="va">False</span>,  <span class="va">True</span>,  <span class="va">True</span>, <span class="va">False</span>,  <span class="va">True</span>,  <span class="va">True</span>,  <span class="va">True</span>])</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">109</span>]: <span class="op">~</span>(names <span class="op">==</span> <span class="st">"Bob"</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">109</span>]: array([<span class="va">False</span>,  <span class="va">True</span>,  <span class="va">True</span>, <span class="va">False</span>,  <span class="va">True</span>,  <span class="va">True</span>,  <span class="va">True</span>])</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">110</span>]: data[<span class="op">~</span>(names <span class="op">==</span> <span class="st">"Bob"</span>)]</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">110</span>]: </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>array([[  <span class="dv">0</span>,   <span class="dv">2</span>],</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>       [ <span class="op">-</span><span class="dv">5</span>,   <span class="dv">6</span>],</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>       [  <span class="dv">1</span>,   <span class="dv">2</span>],</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="dv">12</span>,  <span class="op">-</span><span class="dv">4</span>],</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>       [  <span class="dv">3</span>,   <span class="dv">4</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>~</code> operator can be useful when you want to invert a Boolean array referenced by a variable:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">111</span>]: cond <span class="op">=</span> names <span class="op">==</span> <span class="st">"Bob"</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">112</span>]: data[<span class="op">~</span>cond]</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">112</span>]: </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>array([[  <span class="dv">0</span>,   <span class="dv">2</span>],</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>       [ <span class="op">-</span><span class="dv">5</span>,   <span class="dv">6</span>],</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>       [  <span class="dv">1</span>,   <span class="dv">2</span>],</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="dv">12</span>,  <span class="op">-</span><span class="dv">4</span>],</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>       [  <span class="dv">3</span>,   <span class="dv">4</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To select two of the three names to combine multiple Boolean conditions, use Boolean arithmetic operators like <code>&amp;</code> (and) and <code>|</code> (or):</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">113</span>]: mask <span class="op">=</span> (names <span class="op">==</span> <span class="st">"Bob"</span>) <span class="op">|</span> (names <span class="op">==</span> <span class="st">"Will"</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">114</span>]: mask</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">114</span>]: array([ <span class="va">True</span>, <span class="va">False</span>,  <span class="va">True</span>,  <span class="va">True</span>,  <span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>])</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">115</span>]: data[mask]</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">115</span>]: </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>array([[ <span class="dv">4</span>,  <span class="dv">7</span>],</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="dv">5</span>,  <span class="dv">6</span>],</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">0</span>,  <span class="dv">0</span>],</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">1</span>,  <span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Selecting data from an array by Boolean indexing and assigning the result to a new variable <em>always</em> creates a copy of the data, even if the returned array is unchanged.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The Python keywords <code>and</code> and <code>or</code> do not work with Boolean arrays. Use <code>&amp;</code> (and) and <code>|</code> (or) instead.</p>
</div>
</div>
<p>Setting values with Boolean arrays works by substituting the value or values on the righthand side into the locations where the Boolean array's values are <code>True</code>. To set all of the negative values in <code>data</code> to 0, we need only do:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">116</span>]: data[data <span class="op">&lt;</span> <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">117</span>]: data</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">117</span>]: </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>array([[<span class="dv">4</span>, <span class="dv">7</span>],</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">0</span>, <span class="dv">2</span>],</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">0</span>, <span class="dv">6</span>],</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">3</span>, <span class="dv">4</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can also set whole rows or columns using a one-dimensional Boolean array:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">118</span>]: data[names <span class="op">!=</span> <span class="st">"Joe"</span>] <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">119</span>]: data</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">119</span>]: </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>array([[<span class="dv">7</span>, <span class="dv">7</span>],</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">0</span>, <span class="dv">2</span>],</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">7</span>, <span class="dv">7</span>],</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">7</span>, <span class="dv">7</span>],</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">7</span>, <span class="dv">7</span>],</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">3</span>, <span class="dv">4</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>As we will see later, these types of operations on two-dimensional data are convenient to do with pandas.</p>
</section>
<section id="ndarray_fancy" class="level3">
<h3 class="anchored" data-anchor-id="ndarray_fancy">Fancy Indexing</h3>
<p><em>Fancy indexing</em> is a term adopted by NumPy to describe indexing using integer arrays. Suppose we had an 8 × 4 array:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">120</span>]: arr <span class="op">=</span> np.zeros((<span class="dv">8</span>, <span class="dv">4</span>))</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">121</span>]: <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">8</span>):</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>   .....:     arr[i] <span class="op">=</span> i</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">122</span>]: arr</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">122</span>]: </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>array([[<span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>],</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">1.</span>, <span class="fl">1.</span>, <span class="fl">1.</span>, <span class="fl">1.</span>],</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">2.</span>, <span class="fl">2.</span>, <span class="fl">2.</span>, <span class="fl">2.</span>],</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">3.</span>, <span class="fl">3.</span>, <span class="fl">3.</span>, <span class="fl">3.</span>],</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">4.</span>, <span class="fl">4.</span>, <span class="fl">4.</span>, <span class="fl">4.</span>],</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">5.</span>, <span class="fl">5.</span>, <span class="fl">5.</span>, <span class="fl">5.</span>],</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">6.</span>, <span class="fl">6.</span>, <span class="fl">6.</span>, <span class="fl">6.</span>],</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">7.</span>, <span class="fl">7.</span>, <span class="fl">7.</span>, <span class="fl">7.</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To select a subset of the rows in a particular order, you can simply pass a list or ndarray of integers specifying the desired order:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">123</span>]: arr[[<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">6</span>]]</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">123</span>]: </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>array([[<span class="fl">4.</span>, <span class="fl">4.</span>, <span class="fl">4.</span>, <span class="fl">4.</span>],</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">3.</span>, <span class="fl">3.</span>, <span class="fl">3.</span>, <span class="fl">3.</span>],</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>],</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">6.</span>, <span class="fl">6.</span>, <span class="fl">6.</span>, <span class="fl">6.</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Hopefully this code did what you expected! Using negative indices selects rows from the end:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">124</span>]: arr[[<span class="op">-</span><span class="dv">3</span>, <span class="op">-</span><span class="dv">5</span>, <span class="op">-</span><span class="dv">7</span>]]</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">124</span>]: </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>array([[<span class="fl">5.</span>, <span class="fl">5.</span>, <span class="fl">5.</span>, <span class="fl">5.</span>],</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">3.</span>, <span class="fl">3.</span>, <span class="fl">3.</span>, <span class="fl">3.</span>],</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">1.</span>, <span class="fl">1.</span>, <span class="fl">1.</span>, <span class="fl">1.</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Passing multiple index arrays does something slightly different; it selects a one-dimensional array of elements corresponding to each tuple of indices:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">125</span>]: arr <span class="op">=</span> np.arange(<span class="dv">32</span>).reshape((<span class="dv">8</span>, <span class="dv">4</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">126</span>]: arr</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">126</span>]: </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>array([[ <span class="dv">0</span>,  <span class="dv">1</span>,  <span class="dv">2</span>,  <span class="dv">3</span>],</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">4</span>,  <span class="dv">5</span>,  <span class="dv">6</span>,  <span class="dv">7</span>],</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">8</span>,  <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>],</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>],</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">19</span>],</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">20</span>, <span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">23</span>],</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">27</span>],</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">30</span>, <span class="dv">31</span>]])</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">127</span>]: arr[[<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">2</span>], [<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>]]</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">127</span>]: array([ <span class="dv">4</span>, <span class="dv">23</span>, <span class="dv">29</span>, <span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To learn more about the <code>reshape</code> method, have a look at <a href='/book/advanced-numpy'>Appendix A: Advanced NumPy</a>.</p>
<p>Here the elements <code>(1, 0), (5, 3), (7, 1)</code>, and <code>(2, 2)</code> were selected. The result of fancy indexing with as many integer arrays as there are axes is always one-dimensional.</p>
<p>The behavior of fancy indexing in this case is a bit different from what some users might have expected (myself included), which is the rectangular region formed by selecting a subset of the matrix’s rows and columns. Here is one way to get that:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">128</span>]: arr[[<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">2</span>]][:, [<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>]]</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">128</span>]: </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>array([[ <span class="dv">4</span>,  <span class="dv">7</span>,  <span class="dv">5</span>,  <span class="dv">6</span>],</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">20</span>, <span class="dv">23</span>, <span class="dv">21</span>, <span class="dv">22</span>],</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">28</span>, <span class="dv">31</span>, <span class="dv">29</span>, <span class="dv">30</span>],</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">8</span>, <span class="dv">11</span>,  <span class="dv">9</span>, <span class="dv">10</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Keep in mind that fancy indexing, unlike slicing, always copies the data into a new array when assigning the result to a new variable. If you assign values with fancy indexing, the indexed values will be modified:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">129</span>]: arr[[<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">2</span>], [<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>]]</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">129</span>]: array([ <span class="dv">4</span>, <span class="dv">23</span>, <span class="dv">29</span>, <span class="dv">10</span>])</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">130</span>]: arr[[<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">2</span>], [<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>]] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">131</span>]: arr</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">131</span>]: </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>array([[ <span class="dv">0</span>,  <span class="dv">1</span>,  <span class="dv">2</span>,  <span class="dv">3</span>],</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">0</span>,  <span class="dv">5</span>,  <span class="dv">6</span>,  <span class="dv">7</span>],</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">8</span>,  <span class="dv">9</span>,  <span class="dv">0</span>, <span class="dv">11</span>],</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">15</span>],</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">18</span>, <span class="dv">19</span>],</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">20</span>, <span class="dv">21</span>, <span class="dv">22</span>,  <span class="dv">0</span>],</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">24</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">27</span>],</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">28</span>,  <span class="dv">0</span>, <span class="dv">30</span>, <span class="dv">31</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="numpy_transposing" class="level3">
<h3 class="anchored" data-anchor-id="numpy_transposing">Transposing Arrays and Swapping Axes</h3>
<p>Transposing is a special form of reshaping that similarly returns a view on the underlying data without copying anything. Arrays have the <code>transpose</code> method and the special <code>T</code> attribute:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">132</span>]: arr <span class="op">=</span> np.arange(<span class="dv">15</span>).reshape((<span class="dv">3</span>, <span class="dv">5</span>))</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">133</span>]: arr</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">133</span>]: </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>array([[ <span class="dv">0</span>,  <span class="dv">1</span>,  <span class="dv">2</span>,  <span class="dv">3</span>,  <span class="dv">4</span>],</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">5</span>,  <span class="dv">6</span>,  <span class="dv">7</span>,  <span class="dv">8</span>,  <span class="dv">9</span>],</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>]])</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">134</span>]: arr.T</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">134</span>]: </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>array([[ <span class="dv">0</span>,  <span class="dv">5</span>, <span class="dv">10</span>],</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">1</span>,  <span class="dv">6</span>, <span class="dv">11</span>],</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">2</span>,  <span class="dv">7</span>, <span class="dv">12</span>],</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">3</span>,  <span class="dv">8</span>, <span class="dv">13</span>],</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">4</span>,  <span class="dv">9</span>, <span class="dv">14</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>When doing matrix computations, you may do this very often—for example, when computing the inner matrix product using <code>numpy.dot</code>:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">135</span>]: arr <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>], [<span class="dv">1</span>, <span class="dv">2</span>, <span class="op">-</span><span class="dv">2</span>], [<span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">2</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>]])</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">136</span>]: arr</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">136</span>]: </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>array([[ <span class="dv">0</span>,  <span class="dv">1</span>,  <span class="dv">0</span>],</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">1</span>,  <span class="dv">2</span>, <span class="op">-</span><span class="dv">2</span>],</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">6</span>,  <span class="dv">3</span>,  <span class="dv">2</span>],</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="dv">1</span>,  <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">1</span>,  <span class="dv">0</span>,  <span class="dv">1</span>]])</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">137</span>]: np.dot(arr.T, arr)</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">137</span>]: </span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>array([[<span class="dv">39</span>, <span class="dv">20</span>, <span class="dv">12</span>],</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">20</span>, <span class="dv">14</span>,  <span class="dv">2</span>],</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">12</span>,  <span class="dv">2</span>, <span class="dv">10</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>@</code> infix operator is another way to do matrix multiplication:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">138</span>]: arr.T <span class="op">@</span> arr</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">138</span>]: </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>array([[<span class="dv">39</span>, <span class="dv">20</span>, <span class="dv">12</span>],</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">20</span>, <span class="dv">14</span>,  <span class="dv">2</span>],</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">12</span>,  <span class="dv">2</span>, <span class="dv">10</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Simple transposing with <code>.T</code> is a special case of swapping axes. ndarray has the method <code>swapaxes</code>, which takes a pair of axis numbers and switches the indicated axes to rearrange the data:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">139</span>]: arr</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">139</span>]: </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>array([[ <span class="dv">0</span>,  <span class="dv">1</span>,  <span class="dv">0</span>],</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">1</span>,  <span class="dv">2</span>, <span class="op">-</span><span class="dv">2</span>],</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">6</span>,  <span class="dv">3</span>,  <span class="dv">2</span>],</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="dv">1</span>,  <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">1</span>,  <span class="dv">0</span>,  <span class="dv">1</span>]])</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">140</span>]: arr.swapaxes(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">140</span>]: </span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>array([[ <span class="dv">0</span>,  <span class="dv">1</span>,  <span class="dv">6</span>, <span class="op">-</span><span class="dv">1</span>,  <span class="dv">1</span>],</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">1</span>,  <span class="dv">2</span>,  <span class="dv">3</span>,  <span class="dv">0</span>,  <span class="dv">0</span>],</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">0</span>, <span class="op">-</span><span class="dv">2</span>,  <span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>,  <span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>swapaxes</code> similarly returns a view on the data without making a copy.</p>
</section>
</section>
<section id="numpy_random" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="numpy_random"><span class="header-section-number">4.2</span> Pseudorandom Number Generation</h2>
<p>The <code>numpy.random</code> module supplements the built-in Python <code>random</code> module with functions for efficiently generating whole arrays of sample values from many kinds of probability distributions. For example, you can get a 4 × 4 array of samples from the standard normal distribution using <code>numpy.random.standard_normal</code>:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">141</span>]: samples <span class="op">=</span> np.random.standard_normal(size<span class="op">=</span>(<span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">142</span>]: samples</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">142</span>]: </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>array([[<span class="op">-</span><span class="fl">0.2047</span>,  <span class="fl">0.4789</span>, <span class="op">-</span><span class="fl">0.5194</span>, <span class="op">-</span><span class="fl">0.5557</span>],</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">1.9658</span>,  <span class="fl">1.3934</span>,  <span class="fl">0.0929</span>,  <span class="fl">0.2817</span>],</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.769</span> ,  <span class="fl">1.2464</span>,  <span class="fl">1.0072</span>, <span class="op">-</span><span class="fl">1.2962</span>],</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.275</span> ,  <span class="fl">0.2289</span>,  <span class="fl">1.3529</span>,  <span class="fl">0.8864</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Python’s built-in <code>random</code> module, by contrast, samples only one value at a time. As you can see from this benchmark, <code>numpy.random</code> is well over an order of magnitude faster for generating very large samples:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">143</span>]: <span class="im">from</span> random <span class="im">import</span> normalvariate</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">144</span>]: N <span class="op">=</span> <span class="dv">1_000_000</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">145</span>]: <span class="op">%</span>timeit samples <span class="op">=</span> [normalvariate(<span class="dv">0</span>, <span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(N)]</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="dv">490</span> ms <span class="op">+-</span> <span class="fl">2.23</span> ms per loop (mean <span class="op">+-</span> std. dev. of <span class="dv">7</span> runs, <span class="dv">1</span> loop each)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">146</span>]: <span class="op">%</span>timeit np.random.standard_normal(N)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="fl">32.6</span> ms <span class="op">+-</span> <span class="dv">271</span> us per loop (mean <span class="op">+-</span> std. dev. of <span class="dv">7</span> runs, <span class="dv">10</span> loops each)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>These random numbers are not truly random (rather, <em>pseudorandom</em>) but instead are generated by a configurable random number generator that determines deterministically what values are created. Functions like <code>numpy.random.standard_normal</code> use the <code>numpy.random</code> module's default random number generator, but your code can be configured to use an explicit generator:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">147</span>]: rng <span class="op">=</span> np.random.default_rng(seed<span class="op">=</span><span class="dv">12345</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">148</span>]: data <span class="op">=</span> rng.standard_normal((<span class="dv">2</span>, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>seed</code> argument is what determines the initial state of the generator, and the state changes each time the <code>rng</code> object is used to generate data. The generator object <code>rng</code> is also isolated from other code which might use the <code>numpy.random</code> module:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">149</span>]: <span class="bu">type</span>(rng)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">149</span>]: numpy.random._generator.Generator</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>See <a href="#tbl-table_numpy_random">Table&nbsp;<span>4.3</span></a> for a partial list of methods available on random generator objects like <code>rng</code>. I will use the <code>rng</code> object I created above to generate random data throughout the rest of the chapter.</p>
<div id="tbl-table_numpy_random" class="anchored">
<table class="table">
<caption>Table&nbsp;4.3: NumPy random number generator methods</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>permutation</code></td>
<td style="text-align: left;">Return a random permutation of a sequence, or return a permuted range</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>shuffle</code></td>
<td style="text-align: left;">Randomly permute a sequence in place</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>uniform</code></td>
<td style="text-align: left;">Draw samples from a uniform distribution</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>integers</code></td>
<td style="text-align: left;">Draw random integers from a given low-to-high range</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>standard_normal</code></td>
<td style="text-align: left;">Draw samples from a normal distribution with mean 0 and standard deviation 1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>binomial</code></td>
<td style="text-align: left;">Draw samples from a binomial distribution</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>normal</code></td>
<td style="text-align: left;">Draw samples from a normal (Gaussian) distribution</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>beta</code></td>
<td style="text-align: left;">Draw samples from a beta distribution</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>chisquare</code></td>
<td style="text-align: left;">Draw samples from a chi-square distribution</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>gamma</code></td>
<td style="text-align: left;">Draw samples from a gamma distribution</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>uniform</code></td>
<td style="text-align: left;">Draw samples from a uniform [0, 1) distribution</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="numpy_ufuncs" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="numpy_ufuncs"><span class="header-section-number">4.3</span> Universal Functions: Fast Element-Wise <span class="pagebreak-before">Array Functions</span></h2>
<p>A universal function, or <em>ufunc</em>, is a function that performs element-wise operations on data in ndarrays. You can think of them as fast vectorized wrappers for simple functions that take one or more scalar values and produce one or more scalar results.</p>
<p>Many ufuncs are simple element-wise transformations, like <code>numpy.sqrt</code> or <code>numpy.exp</code>:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">150</span>]: arr <span class="op">=</span> np.arange(<span class="dv">10</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">151</span>]: arr</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">151</span>]: array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>])</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">152</span>]: np.sqrt(arr)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">152</span>]: </span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>array([<span class="fl">0.</span>    , <span class="fl">1.</span>    , <span class="fl">1.4142</span>, <span class="fl">1.7321</span>, <span class="fl">2.</span>    , <span class="fl">2.2361</span>, <span class="fl">2.4495</span>, <span class="fl">2.6458</span>,</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>       <span class="fl">2.8284</span>, <span class="fl">3.</span>    ])</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">153</span>]: np.exp(arr)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">153</span>]: </span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>array([   <span class="fl">1.</span>    ,    <span class="fl">2.7183</span>,    <span class="fl">7.3891</span>,   <span class="fl">20.0855</span>,   <span class="fl">54.5982</span>,  <span class="fl">148.4132</span>,</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>        <span class="fl">403.4288</span>, <span class="fl">1096.6332</span>, <span class="fl">2980.958</span> , <span class="fl">8103.0839</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>These are referred to as <em>unary</em> ufuncs. Others, such as <code>numpy.add</code> or <code>numpy.maximum</code>, take two arrays (thus, <em>binary</em> ufuncs) and return a single array as the result:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">154</span>]: x <span class="op">=</span> rng.standard_normal(<span class="dv">8</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">155</span>]: y <span class="op">=</span> rng.standard_normal(<span class="dv">8</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">156</span>]: x</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">156</span>]: </span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>array([<span class="op">-</span><span class="fl">1.3678</span>,  <span class="fl">0.6489</span>,  <span class="fl">0.3611</span>, <span class="op">-</span><span class="fl">1.9529</span>,  <span class="fl">2.3474</span>,  <span class="fl">0.9685</span>, <span class="op">-</span><span class="fl">0.7594</span>,</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.9022</span>])</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">157</span>]: y</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">157</span>]: </span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>array([<span class="op">-</span><span class="fl">0.467</span> , <span class="op">-</span><span class="fl">0.0607</span>,  <span class="fl">0.7888</span>, <span class="op">-</span><span class="fl">1.2567</span>,  <span class="fl">0.5759</span>,  <span class="fl">1.399</span> ,  <span class="fl">1.3223</span>,</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>       <span class="op">-</span><span class="fl">0.2997</span>])</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">158</span>]: np.maximum(x, y)</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">158</span>]: </span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>array([<span class="op">-</span><span class="fl">0.467</span> ,  <span class="fl">0.6489</span>,  <span class="fl">0.7888</span>, <span class="op">-</span><span class="fl">1.2567</span>,  <span class="fl">2.3474</span>,  <span class="fl">1.399</span> ,  <span class="fl">1.3223</span>,</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.9022</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In this example, <code>numpy.maximum</code> computed the element-wise maximum of the elements in <code>x</code> and <code>y</code>.</p>
<p>While not common, a ufunc can return multiple arrays. <code>numpy.modf</code> is one example: a vectorized version of the built-in Python <code>math.modf</code>, it returns the fractional and integral parts of a floating-point array:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">159</span>]: arr <span class="op">=</span> rng.standard_normal(<span class="dv">7</span>) <span class="op">*</span> <span class="dv">5</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">160</span>]: arr</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">160</span>]: array([ <span class="fl">4.5146</span>, <span class="op">-</span><span class="fl">8.1079</span>, <span class="op">-</span><span class="fl">0.7909</span>,  <span class="fl">2.2474</span>, <span class="op">-</span><span class="fl">6.718</span> , <span class="op">-</span><span class="fl">0.4084</span>,  <span class="fl">8.6237</span>])</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">161</span>]: remainder, whole_part <span class="op">=</span> np.modf(arr)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">162</span>]: remainder</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">162</span>]: array([ <span class="fl">0.5146</span>, <span class="op">-</span><span class="fl">0.1079</span>, <span class="op">-</span><span class="fl">0.7909</span>,  <span class="fl">0.2474</span>, <span class="op">-</span><span class="fl">0.718</span> , <span class="op">-</span><span class="fl">0.4084</span>,  <span class="fl">0.6237</span>])</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">163</span>]: whole_part</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">163</span>]: array([ <span class="fl">4.</span>, <span class="op">-</span><span class="fl">8.</span>, <span class="op">-</span><span class="fl">0.</span>,  <span class="fl">2.</span>, <span class="op">-</span><span class="fl">6.</span>, <span class="op">-</span><span class="fl">0.</span>,  <span class="fl">8.</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Ufuncs accept an optional <code>out</code> argument that allows them to assign their results into an existing array rather than create a new one:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">164</span>]: arr</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">164</span>]: array([ <span class="fl">4.5146</span>, <span class="op">-</span><span class="fl">8.1079</span>, <span class="op">-</span><span class="fl">0.7909</span>,  <span class="fl">2.2474</span>, <span class="op">-</span><span class="fl">6.718</span> , <span class="op">-</span><span class="fl">0.4084</span>,  <span class="fl">8.6237</span>])</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">165</span>]: out <span class="op">=</span> np.zeros_like(arr)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">166</span>]: np.add(arr, <span class="dv">1</span>)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">166</span>]: array([ <span class="fl">5.5146</span>, <span class="op">-</span><span class="fl">7.1079</span>,  <span class="fl">0.2091</span>,  <span class="fl">3.2474</span>, <span class="op">-</span><span class="fl">5.718</span> ,  <span class="fl">0.5916</span>,  <span class="fl">9.6237</span>])</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">167</span>]: np.add(arr, <span class="dv">1</span>, out<span class="op">=</span>out)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">167</span>]: array([ <span class="fl">5.5146</span>, <span class="op">-</span><span class="fl">7.1079</span>,  <span class="fl">0.2091</span>,  <span class="fl">3.2474</span>, <span class="op">-</span><span class="fl">5.718</span> ,  <span class="fl">0.5916</span>,  <span class="fl">9.6237</span>])</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">168</span>]: out</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">168</span>]: array([ <span class="fl">5.5146</span>, <span class="op">-</span><span class="fl">7.1079</span>,  <span class="fl">0.2091</span>,  <span class="fl">3.2474</span>, <span class="op">-</span><span class="fl">5.718</span> ,  <span class="fl">0.5916</span>,  <span class="fl">9.6237</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>See Tables <a href="#tbl-table_unary_ufuncs">Table&nbsp;<span>4.4</span></a> and <a href="#tbl-table_binary_ufuncs">Table&nbsp;<span>4.5</span></a> for a listing of some of NumPy's ufuncs. New ufuncs continue to be added to NumPy, so consulting the online NumPy documentation is the best way to get a comprehensive listing and stay up to date.</p>
<div id="tbl-table_unary_ufuncs" class="anchored">
<table class="table">
<caption>Table&nbsp;4.4: Some unary universal functions</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>abs, fabs</code></td>
<td style="text-align: left;">Compute the absolute value element-wise for integer, floating-point, or complex values</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>sqrt</code></td>
<td style="text-align: left;">Compute the square root of each element (equivalent to <code>arr ** 0.5</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>square</code></td>
<td style="text-align: left;">Compute the square of each element (equivalent to <code>arr ** 2</code>)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>exp</code></td>
<td style="text-align: left;">Compute the exponent e<sup>x</sup> of each element</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>log, log10, log2, log1p</code></td>
<td style="text-align: left;">Natural logarithm (base <em>e</em>), log base 10, log base 2, and log(1 + x), respectively</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>sign</code></td>
<td style="text-align: left;">Compute the sign of each element: 1 (positive), 0 (zero), or –1 (negative)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ceil</code></td>
<td style="text-align: left;">Compute the ceiling of each element (i.e., the smallest integer greater than or equal to that number)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>floor</code></td>
<td style="text-align: left;">Compute the floor of each element (i.e., the largest integer less than or equal to each element)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>rint</code></td>
<td style="text-align: left;">Round elements to the nearest integer, preserving the <code>dtype</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>modf</code></td>
<td style="text-align: left;">Return fractional and integral parts of array as separate arrays</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>isnan</code></td>
<td style="text-align: left;">Return Boolean array indicating whether each value is <code>NaN</code> (Not a Number)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>isfinite, isinf</code></td>
<td style="text-align: left;">Return Boolean array indicating whether each element is finite (non-<code>inf</code>, non-<code>NaN</code>) or infinite, respectively</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>cos, cosh, sin, sinh, tan, tanh</code></td>
<td style="text-align: left;">Regular and hyperbolic trigonometric functions</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>arccos, arccosh, arcsin, arcsinh, arctan, arctanh</code></td>
<td style="text-align: left;">Inverse trigonometric functions</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>logical_not</code></td>
<td style="text-align: left;">Compute truth value of <code>not</code> <code>x</code> element-wise (equivalent to <code>~arr</code>)</td>
</tr>
</tbody>
</table>
</div>
<div id="tbl-table_binary_ufuncs" class="anchored">
<table class="table">
<caption>Table&nbsp;4.5: Some binary universal functions</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>add</code></td>
<td style="text-align: left;">Add corresponding elements in arrays</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>subtract</code></td>
<td style="text-align: left;">Subtract elements in second array from first array</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>multiply</code></td>
<td style="text-align: left;">Multiply array elements</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>divide, floor_divide</code></td>
<td style="text-align: left;">Divide or floor divide (truncating the remainder)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>power</code></td>
<td style="text-align: left;">Raise elements in first array to powers indicated in second array</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>maximum, fmax</code></td>
<td style="text-align: left;">Element-wise maximum; <code>fmax</code> ignores <code>NaN</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>minimum, fmin</code></td>
<td style="text-align: left;">Element-wise minimum; <code>fmin</code> ignores <code>NaN</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>mod</code></td>
<td style="text-align: left;">Element-wise modulus (remainder of division)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>copysign</code></td>
<td style="text-align: left;">Copy sign of values in second argument to values in first argument</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>greater, greater_equal, less, less_equal, equal, not_equal</code></td>
<td style="text-align: left;">Perform element-wise comparison, yielding Boolean array (equivalent to infix operators <code>&gt;, &gt;=, &lt;, &lt;=, ==, !=</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>logical_and</code></td>
<td style="text-align: left;">Compute element-wise truth value of AND (<code>&amp;</code>) logical operation</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>logical_or</code></td>
<td style="text-align: left;">Compute element-wise truth value of OR (<code>|</code>) logical operation</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>logical_xor</code></td>
<td style="text-align: left;">Compute element-wise truth value of XOR (<code>^</code>) logical operation</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="numpy_processing" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="numpy_processing"><span class="header-section-number">4.4</span> Array-Oriented Programming with Arrays</h2>
<p>Using NumPy arrays enables you to express many kinds of data processing tasks as concise array expressions that might otherwise require writing loops. This practice of replacing explicit loops with array expressions is referred to by some people as <em>vectorization</em>. In general, vectorized array operations will usually be significantly faster than their pure Python equivalents, with the biggest impact in any kind of numerical computations. Later, in <a href='/book/advanced-numpy'>Appendix A: Advanced NumPy</a>, I explain <em>broadcasting</em>, a powerful method for vectorizing computations.</p>
<p>As a simple example, suppose we wished to evaluate the function <code>sqrt(x^2 + y^2)</code> across a regular grid of values. The <code>numpy.meshgrid</code> function takes two one-dimensional arrays and produces two two-dimensional matrices corresponding to all pairs of <code>(x, y)</code> in the two arrays:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">169</span>]: points <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.01</span>) <span class="co"># 100 equally spaced points</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">170</span>]: xs, ys <span class="op">=</span> np.meshgrid(points, points)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">171</span>]: ys</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">171</span>]: </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>array([[<span class="op">-</span><span class="fl">5.</span>  , <span class="op">-</span><span class="fl">5.</span>  , <span class="op">-</span><span class="fl">5.</span>  , ..., <span class="op">-</span><span class="fl">5.</span>  , <span class="op">-</span><span class="fl">5.</span>  , <span class="op">-</span><span class="fl">5.</span>  ],</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">4.99</span>, <span class="op">-</span><span class="fl">4.99</span>, <span class="op">-</span><span class="fl">4.99</span>, ..., <span class="op">-</span><span class="fl">4.99</span>, <span class="op">-</span><span class="fl">4.99</span>, <span class="op">-</span><span class="fl">4.99</span>],</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">4.98</span>, <span class="op">-</span><span class="fl">4.98</span>, <span class="op">-</span><span class="fl">4.98</span>, ..., <span class="op">-</span><span class="fl">4.98</span>, <span class="op">-</span><span class="fl">4.98</span>, <span class="op">-</span><span class="fl">4.98</span>],</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>       ...,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">4.97</span>,  <span class="fl">4.97</span>,  <span class="fl">4.97</span>, ...,  <span class="fl">4.97</span>,  <span class="fl">4.97</span>,  <span class="fl">4.97</span>],</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">4.98</span>,  <span class="fl">4.98</span>,  <span class="fl">4.98</span>, ...,  <span class="fl">4.98</span>,  <span class="fl">4.98</span>,  <span class="fl">4.98</span>],</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">4.99</span>,  <span class="fl">4.99</span>,  <span class="fl">4.99</span>, ...,  <span class="fl">4.99</span>,  <span class="fl">4.99</span>,  <span class="fl">4.99</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now, evaluating the function is a matter of writing the same expression you would write with two points:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">172</span>]: z <span class="op">=</span> np.sqrt(xs <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> ys <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">173</span>]: z</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">173</span>]: </span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>array([[<span class="fl">7.0711</span>, <span class="fl">7.064</span> , <span class="fl">7.0569</span>, ..., <span class="fl">7.0499</span>, <span class="fl">7.0569</span>, <span class="fl">7.064</span> ],</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">7.064</span> , <span class="fl">7.0569</span>, <span class="fl">7.0499</span>, ..., <span class="fl">7.0428</span>, <span class="fl">7.0499</span>, <span class="fl">7.0569</span>],</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">7.0569</span>, <span class="fl">7.0499</span>, <span class="fl">7.0428</span>, ..., <span class="fl">7.0357</span>, <span class="fl">7.0428</span>, <span class="fl">7.0499</span>],</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>       ...,</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">7.0499</span>, <span class="fl">7.0428</span>, <span class="fl">7.0357</span>, ..., <span class="fl">7.0286</span>, <span class="fl">7.0357</span>, <span class="fl">7.0428</span>],</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">7.0569</span>, <span class="fl">7.0499</span>, <span class="fl">7.0428</span>, ..., <span class="fl">7.0357</span>, <span class="fl">7.0428</span>, <span class="fl">7.0499</span>],</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">7.064</span> , <span class="fl">7.0569</span>, <span class="fl">7.0499</span>, ..., <span class="fl">7.0428</span>, <span class="fl">7.0499</span>, <span class="fl">7.0569</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>As a preview of <a href='/book/plotting-and-visualization'>Ch 9: Plotting and Visualization</a>, I use matplotlib to create visualizations of this two-dimensional array:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">174</span>]: <span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">175</span>]: plt.imshow(z, cmap<span class="op">=</span>plt.cm.gray, extent<span class="op">=</span>[<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>])</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">175</span>]: <span class="op">&lt;</span>matplotlib.image.AxesImage at <span class="bn">0x17f04b040</span><span class="op">&gt;</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">176</span>]: plt.colorbar()</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">176</span>]: <span class="op">&lt;</span>matplotlib.colorbar.Colorbar at <span class="bn">0x1810661a0</span><span class="op">&gt;</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">177</span>]: plt.title(<span class="st">"Image plot of $\sqrt{x^2 + y^2}$ for a grid of values"</span>)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">177</span>]: Text(<span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="st">'Image plot of $</span><span class="ch">\\</span><span class="st">sqrt{x^2 + y^2}$ for a grid of values'</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In <a href="#numpy_vectorize_circle">Plot of function evaluated on a grid</a>, I used the matplotlib function <code>imshow</code> to create an image plot from a two-dimensional array of function values.</p>
<div id="fig-numpy_vectorize_circle" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figs/numpy_vectorize_circle.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.3: Plot of function evaluated on a grid</figcaption>
</figure>
</div>
<p>If you're working in IPython, you can close all open plot windows by executing <code>plt.close("all")</code>:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">179</span>]: plt.close(<span class="st">"all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The term <em>vectorization</em> is used to describe some other computer science concepts, but in this book I use it to describe operations on whole arrays of data at once rather than going value by value using a Python <code>for</code> loop.</p>
</div>
</div>
<section id="numpy_where" class="level3">
<h3 class="anchored" data-anchor-id="numpy_where">Expressing Conditional Logic as Array Operations</h3>
<p>The <code>numpy.where</code> function is a vectorized version of the ternary expression <code>x if condition else y</code>. Suppose we had a Boolean array and two arrays of values:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">180</span>]: xarr <span class="op">=</span> np.array([<span class="fl">1.1</span>, <span class="fl">1.2</span>, <span class="fl">1.3</span>, <span class="fl">1.4</span>, <span class="fl">1.5</span>])</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">181</span>]: yarr <span class="op">=</span> np.array([<span class="fl">2.1</span>, <span class="fl">2.2</span>, <span class="fl">2.3</span>, <span class="fl">2.4</span>, <span class="fl">2.5</span>])</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">182</span>]: cond <span class="op">=</span> np.array([<span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>, <span class="va">True</span>, <span class="va">False</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Suppose we wanted to take a value from <code>xarr</code> whenever the corresponding value in <code>cond</code> is <code>True</code>, and otherwise take the value from <code>yarr</code>. A list comprehension doing this might look like:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">183</span>]: result <span class="op">=</span> [(x <span class="cf">if</span> c <span class="cf">else</span> y)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>   .....:           <span class="cf">for</span> x, y, c <span class="kw">in</span> <span class="bu">zip</span>(xarr, yarr, cond)]</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">184</span>]: result</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">184</span>]: [<span class="fl">1.1</span>, <span class="fl">2.2</span>, <span class="fl">1.3</span>, <span class="fl">1.4</span>, <span class="fl">2.5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This has multiple problems. First, it will not be very fast for large arrays (because all the work is being done in interpreted Python code). Second, it will not work with multidimensional arrays. With <code>numpy.where</code> you can do this with a single function call:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">185</span>]: result <span class="op">=</span> np.where(cond, xarr, yarr)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">186</span>]: result</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">186</span>]: array([<span class="fl">1.1</span>, <span class="fl">2.2</span>, <span class="fl">1.3</span>, <span class="fl">1.4</span>, <span class="fl">2.5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The second and third arguments to <code>numpy.where</code> don’t need to be arrays; one or both of them can be scalars. A typical use of <code>where</code> in data analysis is to produce a new array of values based on another array. Suppose you had a matrix of randomly generated data and you wanted to replace all positive values with 2 and all negative values with –2. This is possible to do with <code>numpy.where</code>:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">187</span>]: arr <span class="op">=</span> rng.standard_normal((<span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">188</span>]: arr</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">188</span>]: </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>array([[ <span class="fl">2.6182</span>,  <span class="fl">0.7774</span>,  <span class="fl">0.8286</span>, <span class="op">-</span><span class="fl">0.959</span> ],</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">1.2094</span>, <span class="op">-</span><span class="fl">1.4123</span>,  <span class="fl">0.5415</span>,  <span class="fl">0.7519</span>],</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.6588</span>, <span class="op">-</span><span class="fl">1.2287</span>,  <span class="fl">0.2576</span>,  <span class="fl">0.3129</span>],</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.1308</span>,  <span class="fl">1.27</span>  , <span class="op">-</span><span class="fl">0.093</span> , <span class="op">-</span><span class="fl">0.0662</span>]])</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">189</span>]: arr <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">189</span>]: </span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>array([[ <span class="va">True</span>,  <span class="va">True</span>,  <span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>       [<span class="va">False</span>, <span class="va">False</span>,  <span class="va">True</span>,  <span class="va">True</span>],</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>       [<span class="va">False</span>, <span class="va">False</span>,  <span class="va">True</span>,  <span class="va">True</span>],</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>       [<span class="va">False</span>,  <span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>]])</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">190</span>]: np.where(arr <span class="op">&gt;</span> <span class="dv">0</span>, <span class="dv">2</span>, <span class="op">-</span><span class="dv">2</span>)</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">190</span>]: </span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>array([[ <span class="dv">2</span>,  <span class="dv">2</span>,  <span class="dv">2</span>, <span class="op">-</span><span class="dv">2</span>],</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="dv">2</span>, <span class="op">-</span><span class="dv">2</span>,  <span class="dv">2</span>,  <span class="dv">2</span>],</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="dv">2</span>, <span class="op">-</span><span class="dv">2</span>,  <span class="dv">2</span>,  <span class="dv">2</span>],</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="dv">2</span>,  <span class="dv">2</span>, <span class="op">-</span><span class="dv">2</span>, <span class="op">-</span><span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can combine scalars and arrays when using <code>numpy.where</code>. For example, I can replace all positive values in <code>arr</code> with the constant 2, like so:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">191</span>]: np.where(arr <span class="op">&gt;</span> <span class="dv">0</span>, <span class="dv">2</span>, arr) <span class="co"># set only positive values to 2</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">191</span>]: </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>array([[ <span class="fl">2.</span>    ,  <span class="fl">2.</span>    ,  <span class="fl">2.</span>    , <span class="op">-</span><span class="fl">0.959</span> ],</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">1.2094</span>, <span class="op">-</span><span class="fl">1.4123</span>,  <span class="fl">2.</span>    ,  <span class="fl">2.</span>    ],</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.6588</span>, <span class="op">-</span><span class="fl">1.2287</span>,  <span class="fl">2.</span>    ,  <span class="fl">2.</span>    ],</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.1308</span>,  <span class="fl">2.</span>    , <span class="op">-</span><span class="fl">0.093</span> , <span class="op">-</span><span class="fl">0.0662</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="ndarray_statistics" class="level3">
<h3 class="anchored" data-anchor-id="ndarray_statistics">Mathematical and Statistical Methods</h3>
<p>A set of mathematical functions that compute statistics about an entire array or about the data along an axis are accessible as methods of the array class. You can use aggregations (sometimes called <em>reductions</em>) like <code>sum</code>, <code>mean</code>, and <code>std</code> (standard deviation) either by calling the array instance method or using the top-level NumPy function. When you use the NumPy function, like <code>numpy.sum</code>, you have to pass the array you want to aggregate as the first argument.</p>
<p>Here I generate some normally distributed random data and compute some aggregate statistics:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">192</span>]: arr <span class="op">=</span> rng.standard_normal((<span class="dv">5</span>, <span class="dv">4</span>))</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">193</span>]: arr</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">193</span>]: </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>array([[<span class="op">-</span><span class="fl">1.1082</span>,  <span class="fl">0.136</span> ,  <span class="fl">1.3471</span>,  <span class="fl">0.0611</span>],</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.0709</span>,  <span class="fl">0.4337</span>,  <span class="fl">0.2775</span>,  <span class="fl">0.5303</span>],</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.5367</span>,  <span class="fl">0.6184</span>, <span class="op">-</span><span class="fl">0.795</span> ,  <span class="fl">0.3</span>   ],</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">1.6027</span>,  <span class="fl">0.2668</span>, <span class="op">-</span><span class="fl">1.2616</span>, <span class="op">-</span><span class="fl">0.0713</span>],</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.474</span> , <span class="op">-</span><span class="fl">0.4149</span>,  <span class="fl">0.0977</span>, <span class="op">-</span><span class="fl">1.6404</span>]])</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">194</span>]: arr.mean()</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">194</span>]: <span class="op">-</span><span class="fl">0.08719744457434529</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">195</span>]: np.mean(arr)</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">195</span>]: <span class="op">-</span><span class="fl">0.08719744457434529</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">196</span>]: arr.<span class="bu">sum</span>()</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">196</span>]: <span class="op">-</span><span class="fl">1.743948891486906</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Functions like <code>mean</code> and <code>sum</code> take an optional <code>axis</code> argument that computes the statistic over the given axis, resulting in an array with one less dimension:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">197</span>]: arr.mean(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">197</span>]: array([ <span class="fl">0.109</span> ,  <span class="fl">0.3281</span>,  <span class="fl">0.165</span> , <span class="op">-</span><span class="fl">0.6672</span>, <span class="op">-</span><span class="fl">0.3709</span>])</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">198</span>]: arr.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">198</span>]: array([<span class="op">-</span><span class="fl">1.6292</span>,  <span class="fl">1.0399</span>, <span class="op">-</span><span class="fl">0.3344</span>, <span class="op">-</span><span class="fl">0.8203</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Here, <code>arr.mean(axis=1)</code> means "compute mean across the columns," where <code>arr.sum(axis=0)</code> means "compute sum down the rows."</p>
<p>Other methods like <code>cumsum</code> and <code>cumprod</code> do not aggregate, instead producing an array of the intermediate results:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">199</span>]: arr <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>])</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">200</span>]: arr.cumsum()</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">200</span>]: array([ <span class="dv">0</span>,  <span class="dv">1</span>,  <span class="dv">3</span>,  <span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">21</span>, <span class="dv">28</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In multidimensional arrays, accumulation functions like <code>cumsum</code> return an array of the same size but with the partial aggregates computed along the indicated axis according to each lower dimensional slice:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">201</span>]: arr <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>], [<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>]])</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">202</span>]: arr</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">202</span>]: </span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>array([[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>       [<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The expression <code>arr.cumsum(axis=0)</code> computes the cumulative sum along the rows, while <code>arr.cumsum(axis=1)</code> computes the sums along the columns:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">203</span>]: arr.cumsum(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">203</span>]: </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>array([[ <span class="dv">0</span>,  <span class="dv">1</span>,  <span class="dv">2</span>],</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">3</span>,  <span class="dv">5</span>,  <span class="dv">7</span>],</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">15</span>]])</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">204</span>]: arr.cumsum(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">204</span>]: </span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>array([[ <span class="dv">0</span>,  <span class="dv">1</span>,  <span class="dv">3</span>],</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">3</span>,  <span class="dv">7</span>, <span class="dv">12</span>],</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>       [ <span class="dv">6</span>, <span class="dv">13</span>, <span class="dv">21</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>See <a href="#tbl-table_statistical_methods">Table&nbsp;<span>4.6</span></a> for a full listing. We’ll see many examples of these methods in action in later chapters.</p>
<div id="tbl-table_statistical_methods" class="anchored">
<table class="table">
<caption>Table&nbsp;4.6: Basic array statistical methods</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>sum</code></td>
<td style="text-align: left;">Sum of all the elements in the array or along an axis; zero-length arrays have sum 0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>mean</code></td>
<td style="text-align: left;">Arithmetic mean; invalid (returns <code>NaN</code>) on zero-length arrays</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>std, var</code></td>
<td style="text-align: left;">Standard deviation and variance, respectively</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>min, max</code></td>
<td style="text-align: left;">Minimum and maximum</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>argmin, argmax</code></td>
<td style="text-align: left;">Indices of minimum and maximum elements, respectively</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>cumsum</code></td>
<td style="text-align: left;">Cumulative sum of elements starting from 0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>cumprod</code></td>
<td style="text-align: left;">Cumulative product of elements starting from 1</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="numpy_boolean_array_methods" class="level3">
<h3 class="anchored" data-anchor-id="numpy_boolean_array_methods">Methods for Boolean Arrays</h3>
<p>Boolean values are coerced to 1 (<code>True</code>) and 0 (<code>False</code>) in the preceding methods. Thus, <code>sum</code> is often used as a means of counting <code>True</code> values in a Boolean array:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">205</span>]: arr <span class="op">=</span> rng.standard_normal(<span class="dv">100</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">206</span>]: (arr <span class="op">&gt;</span> <span class="dv">0</span>).<span class="bu">sum</span>() <span class="co"># Number of positive values</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">206</span>]: <span class="dv">48</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">207</span>]: (arr <span class="op">&lt;=</span> <span class="dv">0</span>).<span class="bu">sum</span>() <span class="co"># Number of non-positive values</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">207</span>]: <span class="dv">52</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The parentheses here in the expression <code>(arr &gt; 0).sum()</code> are necessary to be able to call <code>sum()</code> on the temporary result of <code>arr &gt; 0</code>.</p>
<p>Two additional methods, <code>any</code> and <code>all</code>, are useful especially for Boolean arrays. <code>any</code> tests whether one or more values in an array is <code>True</code>, while <code>all</code> checks if every value is <code>True</code>:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">208</span>]: bools <span class="op">=</span> np.array([<span class="va">False</span>, <span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>])</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">209</span>]: bools.<span class="bu">any</span>()</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">209</span>]: <span class="va">True</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">210</span>]: bools.<span class="bu">all</span>()</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">210</span>]: <span class="va">False</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>These methods also work with non-Boolean arrays, where nonzero elements are treated as <code>True</code>.</p>
</section>
<section id="numpy_sorting" class="level3">
<h3 class="anchored" data-anchor-id="numpy_sorting">Sorting</h3>
<p>Like Python’s built-in list type, NumPy arrays can be sorted in place with the <code>sort</code> method:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">211</span>]: arr <span class="op">=</span> rng.standard_normal(<span class="dv">6</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">212</span>]: arr</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">212</span>]: array([ <span class="fl">0.0773</span>, <span class="op">-</span><span class="fl">0.6839</span>, <span class="op">-</span><span class="fl">0.7208</span>,  <span class="fl">1.1206</span>, <span class="op">-</span><span class="fl">0.0548</span>, <span class="op">-</span><span class="fl">0.0824</span>])</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">213</span>]: arr.sort()</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">214</span>]: arr</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">214</span>]: array([<span class="op">-</span><span class="fl">0.7208</span>, <span class="op">-</span><span class="fl">0.6839</span>, <span class="op">-</span><span class="fl">0.0824</span>, <span class="op">-</span><span class="fl">0.0548</span>,  <span class="fl">0.0773</span>,  <span class="fl">1.1206</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can sort each one-dimensional section of values in a multidimensional array in place along an axis by passing the axis number to <code>sort</code>. In this example data:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">215</span>]: arr <span class="op">=</span> rng.standard_normal((<span class="dv">5</span>, <span class="dv">3</span>))</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">216</span>]: arr</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">216</span>]: </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>array([[ <span class="fl">0.936</span> ,  <span class="fl">1.2385</span>,  <span class="fl">1.2728</span>],</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.4059</span>, <span class="op">-</span><span class="fl">0.0503</span>,  <span class="fl">0.2893</span>],</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.1793</span>,  <span class="fl">1.3975</span>,  <span class="fl">0.292</span> ],</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.6384</span>, <span class="op">-</span><span class="fl">0.0279</span>,  <span class="fl">1.3711</span>],</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">2.0528</span>,  <span class="fl">0.3805</span>,  <span class="fl">0.7554</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>arr.sort(axis=0)</code> sorts the values within each column, while <code>arr.sort(axis=1)</code> sorts across each row:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">217</span>]: arr.sort(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">218</span>]: arr</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">218</span>]: </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>array([[<span class="op">-</span><span class="fl">2.0528</span>, <span class="op">-</span><span class="fl">0.0503</span>,  <span class="fl">0.2893</span>],</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.1793</span>, <span class="op">-</span><span class="fl">0.0279</span>,  <span class="fl">0.292</span> ],</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.4059</span>,  <span class="fl">0.3805</span>,  <span class="fl">0.7554</span>],</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.6384</span>,  <span class="fl">1.2385</span>,  <span class="fl">1.2728</span>],</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.936</span> ,  <span class="fl">1.3975</span>,  <span class="fl">1.3711</span>]])</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">219</span>]: arr.sort(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">220</span>]: arr</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">220</span>]: </span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>array([[<span class="op">-</span><span class="fl">2.0528</span>, <span class="op">-</span><span class="fl">0.0503</span>,  <span class="fl">0.2893</span>],</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.0279</span>,  <span class="fl">0.1793</span>,  <span class="fl">0.292</span> ],</span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.3805</span>,  <span class="fl">0.4059</span>,  <span class="fl">0.7554</span>],</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.6384</span>,  <span class="fl">1.2385</span>,  <span class="fl">1.2728</span>],</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.936</span> ,  <span class="fl">1.3711</span>,  <span class="fl">1.3975</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The top-level method <code>numpy.sort</code> returns a sorted copy of an array (like the Python built-in function <code>sorted</code>) instead of modifying the array in place. For example:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">221</span>]: arr2 <span class="op">=</span> np.array([<span class="dv">5</span>, <span class="op">-</span><span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">3</span>])</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">222</span>]: sorted_arr2 <span class="op">=</span> np.sort(arr2)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">223</span>]: sorted_arr2</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">223</span>]: array([<span class="op">-</span><span class="dv">10</span>,  <span class="op">-</span><span class="dv">3</span>,   <span class="dv">0</span>,   <span class="dv">1</span>,   <span class="dv">5</span>,   <span class="dv">7</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For more details on using NumPy’s sorting methods, and more advanced techniques like indirect sorts, see <a href='/book/advanced-numpy'>Appendix A: Advanced NumPy</a>. Several other kinds of data manipulations related to sorting (e.g., sorting a table of data by one or more columns) can also be found in pandas.</p>
</section>
<section id="numpy_algos_sets" class="level3">
<h3 class="anchored" data-anchor-id="numpy_algos_sets">Unique and Other Set Logic</h3>
<p>NumPy has some basic set operations for one-dimensional ndarrays. A commonly used one is <code>numpy.unique</code>, which returns the sorted unique values in an array:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">224</span>]: names <span class="op">=</span> np.array([<span class="st">"Bob"</span>, <span class="st">"Will"</span>, <span class="st">"Joe"</span>, <span class="st">"Bob"</span>, <span class="st">"Will"</span>, <span class="st">"Joe"</span>, <span class="st">"Joe"</span>])</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">225</span>]: np.unique(names)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">225</span>]: array([<span class="st">'Bob'</span>, <span class="st">'Joe'</span>, <span class="st">'Will'</span>], dtype<span class="op">=</span><span class="st">'&lt;U4'</span>)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">226</span>]: ints <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">4</span>])</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">227</span>]: np.unique(ints)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">227</span>]: array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Contrast <code>numpy.unique</code> with the pure Python alternative:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">228</span>]: <span class="bu">sorted</span>(<span class="bu">set</span>(names))</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">228</span>]: [<span class="st">'Bob'</span>, <span class="st">'Joe'</span>, <span class="st">'Will'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In many cases, the NumPy version is faster and returns a NumPy array rather than a Python list.</p>
<p>Another function, <code>numpy.in1d</code>, tests membership of the values in one array in another, returning a Boolean array:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">229</span>]: values <span class="op">=</span> np.array([<span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">6</span>])</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">230</span>]: np.in1d(values, [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>])</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">230</span>]: array([ <span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>,  <span class="va">True</span>,  <span class="va">True</span>, <span class="va">False</span>,  <span class="va">True</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>See <a href="#tbl-table_setops">Table&nbsp;<span>4.7</span></a> for a listing of array set operations in NumPy.</p>
<div id="tbl-table_setops" class="anchored">
<table class="table">
<caption>Table&nbsp;4.7: Array set operations</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>unique(x)</code></td>
<td style="text-align: left;">Compute the sorted, unique elements in <code>x</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>intersect1d(x, y)</code></td>
<td style="text-align: left;">Compute the sorted, common elements in <code>x</code> and <code>y</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>union1d(x, y)</code></td>
<td style="text-align: left;">Compute the sorted union of elements</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>in1d(x, y)</code></td>
<td style="text-align: left;">Compute a Boolean array indicating whether each element of <code>x</code> is contained in <code>y</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>setdiff1d(x, y)</code></td>
<td style="text-align: left;">Set difference, elements in <code>x</code> that are not in <code>y</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>setxor1d(x, y)</code></td>
<td style="text-align: left;">Set symmetric differences; elements that are in either of the arrays, but not both</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="numpy_io_basics" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="numpy_io_basics"><span class="header-section-number">4.5</span> File Input and Output with Arrays</h2>
<p>NumPy is able to save and load data to and from disk in some text or binary formats. In this section I discuss only NumPy's built-in binary format, since most users will prefer pandas and other tools for loading text or tabular data (see <a href='/book/accessing-data'>Ch 6: Data Loading, Storage, and File Formats</a> for much more).</p>
<p><code>numpy.save</code> and <code>numpy.load</code> are the two workhorse functions for efficiently saving and loading array data on disk. Arrays are saved by default in an uncompressed raw binary format with file extension <em>.npy</em>:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">231</span>]: arr <span class="op">=</span> np.arange(<span class="dv">10</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">232</span>]: np.save(<span class="st">"some_array"</span>, arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If the file path does not already end in <em>.npy</em>, the extension will be appended. The array on disk can then be loaded with <code>numpy.load</code>:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">233</span>]: np.load(<span class="st">"some_array.npy"</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">233</span>]: array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can save multiple arrays in an uncompressed archive using <code>numpy.savez</code> and passing the arrays as keyword arguments:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">234</span>]: np.savez(<span class="st">"array_archive.npz"</span>, a<span class="op">=</span>arr, b<span class="op">=</span>arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>When loading an <em>.npz</em> file, you get back a dictionary-like object that loads the individual arrays lazily:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">235</span>]: arch <span class="op">=</span> np.load(<span class="st">"array_archive.npz"</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">236</span>]: arch[<span class="st">"b"</span>]</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">236</span>]: array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If your data compresses well, you may wish to use <code>numpy.savez_compressed</code> instead:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">237</span>]: np.savez_compressed(<span class="st">"arrays_compressed.npz"</span>, a<span class="op">=</span>arr, b<span class="op">=</span>arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="numpy_linalg" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="numpy_linalg"><span class="header-section-number">4.6</span> Linear Algebra</h2>
<p>Linear algebra operations, like matrix multiplication, decompositions, determinants, and other square matrix math, are an important part of many array libraries. Multiplying two two-dimensional arrays with <code>*</code> is an element-wise product, while matrix multiplications require either using the <code>dot</code> function or the <code>@</code> infix operator. <code>dot</code> is both an array method and a function in the <code>numpy</code> namespace for doing matrix multiplication:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">241</span>]: x <span class="op">=</span> np.array([[<span class="fl">1.</span>, <span class="fl">2.</span>, <span class="fl">3.</span>], [<span class="fl">4.</span>, <span class="fl">5.</span>, <span class="fl">6.</span>]])</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">242</span>]: y <span class="op">=</span> np.array([[<span class="fl">6.</span>, <span class="fl">23.</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">7</span>], [<span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">243</span>]: x</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">243</span>]: </span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>array([[<span class="fl">1.</span>, <span class="fl">2.</span>, <span class="fl">3.</span>],</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>       [<span class="fl">4.</span>, <span class="fl">5.</span>, <span class="fl">6.</span>]])</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">244</span>]: y</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">244</span>]: </span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>array([[ <span class="fl">6.</span>, <span class="fl">23.</span>],</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">1.</span>,  <span class="fl">7.</span>],</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">8.</span>,  <span class="fl">9.</span>]])</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">245</span>]: x.dot(y)</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">245</span>]: </span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>array([[ <span class="fl">28.</span>,  <span class="fl">64.</span>],</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">67.</span>, <span class="fl">181.</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>x.dot(y)</code> is equivalent to <code>np.dot(x, y)</code>:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">246</span>]: np.dot(x, y)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">246</span>]: </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>array([[ <span class="fl">28.</span>,  <span class="fl">64.</span>],</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">67.</span>, <span class="fl">181.</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A matrix product between a two-dimensional array and a suitably sized one-dimensional array results in a one-dimensional array:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">247</span>]: x <span class="op">@</span> np.ones(<span class="dv">3</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">247</span>]: array([ <span class="fl">6.</span>, <span class="fl">15.</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>numpy.linalg</code> has a standard set of matrix decompositions and things like inverse and determinant:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">248</span>]: <span class="im">from</span> numpy.linalg <span class="im">import</span> inv, qr</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">249</span>]: X <span class="op">=</span> rng.standard_normal((<span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">250</span>]: mat <span class="op">=</span> X.T <span class="op">@</span> X</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">251</span>]: inv(mat)</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">251</span>]: </span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>array([[  <span class="fl">3.4993</span>,   <span class="fl">2.8444</span>,   <span class="fl">3.5956</span>, <span class="op">-</span><span class="fl">16.5538</span>,   <span class="fl">4.4733</span>],</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>       [  <span class="fl">2.8444</span>,   <span class="fl">2.5667</span>,   <span class="fl">2.9002</span>, <span class="op">-</span><span class="fl">13.5774</span>,   <span class="fl">3.7678</span>],</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>       [  <span class="fl">3.5956</span>,   <span class="fl">2.9002</span>,   <span class="fl">4.4823</span>, <span class="op">-</span><span class="fl">18.3453</span>,   <span class="fl">4.7066</span>],</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">16.5538</span>, <span class="op">-</span><span class="fl">13.5774</span>, <span class="op">-</span><span class="fl">18.3453</span>,  <span class="fl">84.0102</span>, <span class="op">-</span><span class="fl">22.0484</span>],</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>       [  <span class="fl">4.4733</span>,   <span class="fl">3.7678</span>,   <span class="fl">4.7066</span>, <span class="op">-</span><span class="fl">22.0484</span>,   <span class="fl">6.0525</span>]])</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">252</span>]: mat <span class="op">@</span> inv(mat)</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">252</span>]: </span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>array([[ <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>],</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.</span>,  <span class="fl">1.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>],</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>, <span class="op">-</span><span class="fl">0.</span>,  <span class="fl">0.</span>],</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>       [ <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>,  <span class="fl">0.</span>],</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>       [<span class="op">-</span><span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">0.</span>,  <span class="fl">1.</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The expression <code>X.T.dot(X)</code> computes the dot product of <code>X</code> with its transpose <code>X.T</code>.</p>
<p>See <a href="#tbl-table_numpy_linalg">Table&nbsp;<span>4.8</span></a> for a list of some of the most commonly used linear algebra functions.</p>
<div id="tbl-table_numpy_linalg" class="anchored">
<table class="table">
<caption>Table&nbsp;4.8: Commonly used <code>numpy.linalg</code> functions</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>diag</code></td>
<td style="text-align: left;">Return the diagonal (or off-diagonal) elements of a square matrix as a 1D array, or convert a 1D array into a square matrix with zeros on the off-diagonal</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>dot</code></td>
<td style="text-align: left;">Matrix multiplication</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>trace</code></td>
<td style="text-align: left;">Compute the sum of the diagonal elements</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>det</code></td>
<td style="text-align: left;">Compute the matrix determinant</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>eig</code></td>
<td style="text-align: left;">Compute the eigenvalues and eigenvectors of a square matrix</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>inv</code></td>
<td style="text-align: left;">Compute the inverse of a square matrix</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>pinv</code></td>
<td style="text-align: left;">Compute the Moore-Penrose pseudoinverse of a matrix</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>qr</code></td>
<td style="text-align: left;">Compute the QR decomposition</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>svd</code></td>
<td style="text-align: left;">Compute the singular value decomposition (SVD)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>solve</code></td>
<td style="text-align: left;">Solve the linear system Ax = b for x, where A is a square matrix</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>lstsq</code></td>
<td style="text-align: left;">Compute the least-squares solution to <code>Ax = b</code></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="example_random_walks" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="example_random_walks"><span class="header-section-number">4.7</span> Example: Random Walks</h2>
<p>The simulation of <a href="https://en.wikipedia.org/wiki/Random_walk"><em>random walks</em></a> provides an illustrative application of utilizing array operations. Let’s first consider a simple random walk starting at 0 with steps of 1 and –1 occurring with equal probability.</p>
<p>Here is a pure Python way to implement a single random walk with 1,000 steps using the built-in <code>random</code> module:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#! blockstart</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>position <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>walk <span class="op">=</span> [position]</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>nsteps <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(nsteps):</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>    step <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> random.randint(<span class="dv">0</span>, <span class="dv">1</span>) <span class="cf">else</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>    position <span class="op">+=</span> step</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>    walk.append(position)</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="co">#! blockend</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>See <a href="#fig-figure_random_walk1">Figure&nbsp;<span>4.4</span></a> for an example plot of the first 100 values on one of these random walks:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">255</span>]: plt.plot(walk[:<span class="dv">100</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-figure_random_walk1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figs/figure_random_walk1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4.4: A simple random walk</figcaption>
</figure>
</div>
<p>You might make the observation that <code>walk</code> is the cumulative sum of the random steps and could be evaluated as an array expression. Thus, I use the <code>numpy.random</code> module to draw 1,000 coin flips at once, set these to 1 and –1, and compute the cumulative sum:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">256</span>]: nsteps <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">257</span>]: rng <span class="op">=</span> np.random.default_rng(seed<span class="op">=</span><span class="dv">12345</span>)  <span class="co"># fresh random generator</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">258</span>]: draws <span class="op">=</span> rng.integers(<span class="dv">0</span>, <span class="dv">2</span>, size<span class="op">=</span>nsteps)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">259</span>]: steps <span class="op">=</span> np.where(draws <span class="op">==</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">260</span>]: walk <span class="op">=</span> steps.cumsum()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>From this we can begin to extract statistics like the minimum and maximum value along the walk’s trajectory:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">261</span>]: walk.<span class="bu">min</span>()</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">261</span>]: <span class="op">-</span><span class="dv">8</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">262</span>]: walk.<span class="bu">max</span>()</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">262</span>]: <span class="dv">50</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A more complicated statistic is the <em>first crossing time</em>, the step at which the random walk reaches a particular value. Here we might want to know how long it took the random walk to get at least 10 steps away from the origin 0 in either direction. <code>np.abs(walk) &gt;= 10</code> gives us a Boolean array indicating where the walk has reached or exceeded 10, but we want the index of the <em>first</em> 10 or –10. Turns out, we can compute this using <code>argmax</code>, which returns the first index of the maximum value in the Boolean array (<code>True</code> is the maximum value):</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">263</span>]: (np.<span class="bu">abs</span>(walk) <span class="op">&gt;=</span> <span class="dv">10</span>).argmax()</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">263</span>]: <span class="dv">155</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that using <code>argmax</code> here is not always efficient because it always makes a full scan of the array. In this special case, once a <code>True</code> is observed we know it to be the maximum value.</p>
<section id="example_random_walks_many" class="level3">
<h3 class="anchored" data-anchor-id="example_random_walks_many">Simulating Many Random Walks at Once</h3>
<p>If your goal was to simulate many random walks, say five thousand of them, you can generate all of the random walks with minor modifications to the preceding code. If passed a 2-tuple, the <code>numpy.random</code> functions will generate a two-dimensional array of draws, and we can compute the cumulative sum for each row to compute all five thousand random walks in one shot:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">264</span>]: nwalks <span class="op">=</span> <span class="dv">5000</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">265</span>]: nsteps <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">266</span>]: draws <span class="op">=</span> rng.integers(<span class="dv">0</span>, <span class="dv">2</span>, size<span class="op">=</span>(nwalks, nsteps)) <span class="co"># 0 or 1</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">267</span>]: steps <span class="op">=</span> np.where(draws <span class="op">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">268</span>]: walks <span class="op">=</span> steps.cumsum(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">269</span>]: walks</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">269</span>]: </span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>array([[  <span class="dv">1</span>,   <span class="dv">2</span>,   <span class="dv">3</span>, ...,  <span class="dv">22</span>,  <span class="dv">23</span>,  <span class="dv">22</span>],</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>       [  <span class="dv">1</span>,   <span class="dv">0</span>,  <span class="op">-</span><span class="dv">1</span>, ..., <span class="op">-</span><span class="dv">50</span>, <span class="op">-</span><span class="dv">49</span>, <span class="op">-</span><span class="dv">48</span>],</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>       [  <span class="dv">1</span>,   <span class="dv">2</span>,   <span class="dv">3</span>, ...,  <span class="dv">50</span>,  <span class="dv">49</span>,  <span class="dv">48</span>],</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>       ...,</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>       [ <span class="op">-</span><span class="dv">1</span>,  <span class="op">-</span><span class="dv">2</span>,  <span class="op">-</span><span class="dv">1</span>, ..., <span class="op">-</span><span class="dv">10</span>,  <span class="op">-</span><span class="dv">9</span>, <span class="op">-</span><span class="dv">10</span>],</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>       [ <span class="op">-</span><span class="dv">1</span>,  <span class="op">-</span><span class="dv">2</span>,  <span class="op">-</span><span class="dv">3</span>, ...,   <span class="dv">8</span>,   <span class="dv">9</span>,   <span class="dv">8</span>],</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>       [ <span class="op">-</span><span class="dv">1</span>,   <span class="dv">0</span>,   <span class="dv">1</span>, ...,  <span class="op">-</span><span class="dv">4</span>,  <span class="op">-</span><span class="dv">3</span>,  <span class="op">-</span><span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now, we can compute the maximum and minimum values obtained over all of the walks:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">270</span>]: walks.<span class="bu">max</span>()</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">270</span>]: <span class="dv">114</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">271</span>]: walks.<span class="bu">min</span>()</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">271</span>]: <span class="op">-</span><span class="dv">120</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Out of these walks, let’s compute the minimum crossing time to 30 or –30. This is slightly tricky because not all 5,000 of them reach 30. We can check this using the <code>any</code> method:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">272</span>]: hits30 <span class="op">=</span> (np.<span class="bu">abs</span>(walks) <span class="op">&gt;=</span> <span class="dv">30</span>).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">273</span>]: hits30</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">273</span>]: array([<span class="va">False</span>,  <span class="va">True</span>,  <span class="va">True</span>, ...,  <span class="va">True</span>, <span class="va">False</span>,  <span class="va">True</span>])</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">274</span>]: hits30.<span class="bu">sum</span>() <span class="co"># Number that hit 30 or -30</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">274</span>]: <span class="dv">3395</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We can use this Boolean array to select the rows of <code>walks</code> that actually cross the absolute 30 level, and call <code>argmax</code> across axis 1 to get the crossing times:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">275</span>]: crossing_times <span class="op">=</span> (np.<span class="bu">abs</span>(walks[hits30]) <span class="op">&gt;=</span> <span class="dv">30</span>).argmax(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">276</span>]: crossing_times</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">276</span>]: array([<span class="dv">201</span>, <span class="dv">491</span>, <span class="dv">283</span>, ..., <span class="dv">219</span>, <span class="dv">259</span>, <span class="dv">541</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Lastly, we compute the average minimum crossing time:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">277</span>]: crossing_times.mean()</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">277</span>]: <span class="fl">500.5699558173785</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Feel free to experiment with other distributions for the steps other than equal-sized coin flips. You need only use a different random generator method, like <code>standard_normal</code> to generate normally distributed steps with some mean and standard deviation:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">278</span>]: draws <span class="op">=</span> <span class="fl">0.25</span> <span class="op">*</span> rng.standard_normal((nwalks, nsteps))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Keep in mind that this vectorized approach requires creating an array with <code>nwalks * nsteps</code> elements, which may use a large amount of memory for large simulations. If memory is more constrained, then a different approach will be required.</p>
</div>
</div>
</section>
</section>
<section id="numpy_moving_forward" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="numpy_moving_forward"><span class="header-section-number">4.8</span> Conclusion</h2>
<p>While much of the rest of the book will focus on building data wrangling skills with pandas, we will continue to work in a similar array-based style. In <a href='/book/advanced-numpy'>Appendix A: Advanced NumPy</a>, we will dig deeper into NumPy features to help you further develop your array computing skills.</p>


</section>

<script async="" defer="" src="https://scripts.simpleanalyticscdn.com/latest.js"></script></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a class='pagination-link' href='/book/python-builtin'>
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Built-In Data Structures, Functions, and Files</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a class='pagination-link' href='/book/pandas-basics'>
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Getting Started with pandas</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2023, Wes McKinney. All Rights Reserved.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/wesmckinn">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script async="" src="https://media.ethicalads.io/media/client/ethicalads.min.js"></script>



</body></html>