<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Python for Data Analysis, 3E - 6&nbsp; Data Loading, Storage, and File Formats</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./data-cleaning.html" rel="next">
<link href="./pandas-basics.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Python for Data Analysis, 3E - 6&nbsp; Data Loading, Storage, and File Formats">
<meta property="og:description" content="">
<meta property="og:image" content="images/cover.png">
<meta property="og:site-name" content="Python for Data Analysis, 3E">
<meta name="twitter:title" content="Python for Data Analysis, 3E - 6&nbsp; Data Loading, Storage, and File Formats">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="images/cover.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class='navbar-brand' href='/book/'>
    <span class="navbar-title">Python for Data Analysis, 3E</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class='nav-link' href='https://wesmckinney.com/archives' rel target>
 <span class="menu-text">Wes’s Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/wesmckinn" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">    
        <li>
    <a class="dropdown-item" href="https://github.com/wesm/pydata-book" rel="" target="">
 <span class="dropdown-text">Data and Notebooks (GitHub)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://gitee.com/wesmckinn/pydata-book" rel="" target="">
 <span class="dropdown-text">Data and Notebooks (Gitee)</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href='/book/preface'>Chapters</a></li><li class="breadcrumb-item"><a href='/book/accessing-data'><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Loading, Storage, and File Formats</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/'>
 <span class="menu-text">About the Open Edition</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Chapters</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/preface'>
 <span class="menu-text">Preface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/preliminaries'>
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preliminaries</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/python-basics'>
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Python Language Basics, IPython, and Jupyter Notebooks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/python-builtin'>
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Built-In Data Structures, Functions, and Files</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/numpy-basics'>
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">NumPy Basics: Arrays and Vectorized Computation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/pandas-basics'>
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Getting Started with pandas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link active' href='/book/accessing-data'>
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Loading, Storage, and File Formats</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/data-cleaning'>
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Cleaning and Preparation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/data-wrangling'>
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data Wrangling: Join, Combine, and Reshape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/plotting-and-visualization'>
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Plotting and Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/data-aggregation'>
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Aggregation and Group Operations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/time-series'>
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Time Series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/modeling'>
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Modeling Libraries in Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/data-analysis-examples'>
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Analysis Examples</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/advanced-numpy'>
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Advanced NumPy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/ipython'>
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">More on the IPython System</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<a href="https://amzn.to/3DyLaJc"><img src="images/cover.png" class="img-fluid"></a>
<div data-ea-publisher="wesmckinneycom" data-ea-type="image">

</div>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#io_flat_files" id="toc-io_flat_files" class="nav-link active" data-scroll-target="#io_flat_files"><span class="header-section-number">6.1</span> Reading and Writing Data in Text Format</a>
  <ul class="collapse">
  <li><a href="#pandas_file_chunking" id="toc-pandas_file_chunking" class="nav-link" data-scroll-target="#pandas_file_chunking">Reading Text Files in Pieces</a></li>
  <li><a href="#pandas_text_writing" id="toc-pandas_text_writing" class="nav-link" data-scroll-target="#pandas_text_writing">Writing Data to Text Format</a></li>
  <li><a href="#io_file_formats_csv" id="toc-io_file_formats_csv" class="nav-link" data-scroll-target="#io_file_formats_csv">Working with Other Delimited Formats</a></li>
  <li><a href="#io_format_json" id="toc-io_format_json" class="nav-link" data-scroll-target="#io_format_json">JSON Data</a></li>
  <li><a href="#io_file_formats_html_xml" id="toc-io_file_formats_html_xml" class="nav-link" data-scroll-target="#io_file_formats_html_xml">XML and HTML: Web Scraping</a></li>
  </ul></li>
  <li><a href="#io_binary" id="toc-io_binary" class="nav-link" data-scroll-target="#io_binary"><span class="header-section-number">6.2</span> Binary Data Formats</a>
  <ul class="collapse">
  <li><a href="#pandas_excel_files" id="toc-pandas_excel_files" class="nav-link" data-scroll-target="#pandas_excel_files">Reading Microsoft Excel Files</a></li>
  <li><a href="#io_hdf5" id="toc-io_hdf5" class="nav-link" data-scroll-target="#io_hdf5">Using HDF5 Format</a></li>
  </ul></li>
  <li><a href="#io_web_apis" id="toc-io_web_apis" class="nav-link" data-scroll-target="#io_web_apis"><span class="header-section-number">6.3</span> Interacting with Web APIs</a></li>
  <li><a href="#io_databases" id="toc-io_databases" class="nav-link" data-scroll-target="#io_databases"><span class="header-section-number">6.4</span> Interacting with Databases</a></li>
  <li><a href="#io_wrapping_up" id="toc-io_wrapping_up" class="nav-link" data-scroll-target="#io_wrapping_up"><span class="header-section-number">6.5</span> Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="io" class="quarto-section-identifier"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Loading, Storage, and File Formats</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>This Open Access web version of <em>Python for Data Analysis 3rd Edition</em> is now available as a companion to the <a href="https://amzn.to/3DyLaJc">print and digital editions</a>. If you encounter any errata, <a href="https://oreilly.com/catalog/0636920519829/errata">please report them here</a>. Please note that some aspects of this site as produced by Quarto will differ from the formatting of the print and eBook versions from O’Reilly.</p>
<p>If you find the online edition of the book useful, please consider <a href="https://amzn.to/3DyLaJc">ordering a paper copy</a> or a <a href="https://www.ebooks.com/en-us/book/210644288/python-for-data-analysis/wes-mckinney/?affId=WES398681F">DRM-free eBook</a> to support the author. The content from this website may not be copied or reproduced. The code examples are MIT licensed and can be found on GitHub or Gitee.</p>
</div>
</div>
</div>
<p>Reading data and making it accessible (often called <em>data loading</em>) is a necessary first step for using most of the tools in this book. The term <em>parsing</em> is also sometimes used to describe loading text data and interpreting it as tables and different data types. I’m going to focus on data input and output using pandas, though there are numerous tools in other libraries to help with reading and writing data in various formats.</p>
<p>Input and output typically fall into a few main categories: reading text files and other more efficient on-disk formats, loading data from databases, and interacting with network sources like web APIs.</p>
<section id="io_flat_files" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="io_flat_files"><span class="header-section-number">6.1</span> Reading and Writing Data in Text Format</h2>
<p>pandas features a number of functions for reading tabular data as a DataFrame object. <a href="#tbl-table_parsing_functions">Table&nbsp;<span>6.1</span></a> summarizes some of them; <code>pandas.read_csv</code> is one of the most frequently used in this book. We will look at binary data formats later in <a href="#io_binary">Binary Data Formats</a>.</p>
<div id="tbl-table_parsing_functions" class="anchored">
<table class="table">
<caption>Table&nbsp;6.1: Text and binary data loading functions in pandas</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>read_csv</code></td>
<td style="text-align: left;">Load delimited data from a file, URL, or file-like object; use comma as default delimiter</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>read_fwf</code></td>
<td style="text-align: left;">Read data in fixed-width column format (i.e., no delimiters)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>read_clipboard</code></td>
<td style="text-align: left;">Variation of <code>read_csv</code> that reads data from the clipboard; useful for converting tables from web pages</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>read_excel</code></td>
<td style="text-align: left;">Read tabular data from an Excel XLS or XLSX file</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>read_hdf</code></td>
<td style="text-align: left;">Read HDF5 files written by pandas</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>read_html</code></td>
<td style="text-align: left;">Read all tables found in the given HTML document</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>read_json</code></td>
<td style="text-align: left;">Read data from a JSON (JavaScript Object Notation) string representation, file, URL, or file-like object</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>read_feather</code></td>
<td style="text-align: left;">Read the Feather binary file format</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>read_orc</code></td>
<td style="text-align: left;">Read the Apache ORC binary file format</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>read_parquet</code></td>
<td style="text-align: left;">Read the Apache Parquet binary file format</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>read_pickle</code></td>
<td style="text-align: left;">Read an object stored by pandas using the Python pickle format</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>read_sas</code></td>
<td style="text-align: left;">Read a SAS dataset stored in one of the SAS system's custom storage formats</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>read_spss</code></td>
<td style="text-align: left;">Read a data file created by SPSS</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>read_sql</code></td>
<td style="text-align: left;">Read the results of a SQL query (using SQLAlchemy)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>read_sql_table</code></td>
<td style="text-align: left;">Read a whole SQL table (using SQLAlchemy); equivalent to using a query that selects everything in that table using <code>read_sql</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>read_stata</code></td>
<td style="text-align: left;">Read a dataset from Stata file format</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>read_xml</code></td>
<td style="text-align: left;">Read a table of data from an XML file</td>
</tr>
</tbody>
</table>
</div>
<p>I’ll give an overview of the mechanics of these functions, which are meant to convert text data into a DataFrame. The optional arguments for these functions may fall into a few categories:</p>
<dl>
<dt>Indexing</dt>
<dd>
<p>Can treat one or more columns as the returned DataFrame, and whether to get column names from the file, arguments you provide, or not at all.</p>
</dd>
<dt>Type inference and data conversion</dt>
<dd>
<p>Includes the user-defined value conversions and custom list of missing value markers.</p>
</dd>
<dt>Date and time parsing</dt>
<dd>
<p>Includes a combining capability, including combining date and time information spread over multiple columns into a single column in the result.</p>
</dd>
<dt>Iterating</dt>
<dd>
<p>Support for iterating over chunks of very large files.</p>
</dd>
<dt>Unclean data issues</dt>
<dd>
<p>Includes skipping rows or a footer, comments, or other minor things like numeric data with thousands separated by commas.</p>
</dd>
</dl>
<p>Because of how messy data in the real world can be, some of the data loading functions (especially <code>pandas.read_csv</code>) have accumulated a long list of optional arguments over time. It's normal to feel overwhelmed by the number of different parameters (<code>pandas.read_csv</code> has around 50). The online pandas documentation has many examples about how each of these works, so if you're struggling to read a particular file, there might be a similar enough example to help you find the right parameters.</p>
<p>Some of these functions perform <em>type inference</em>, because the column data types are not part of the data format. That means you don’t necessarily have to specify which columns are numeric, integer, Boolean, or string. Other data formats, like HDF5, ORC, and Parquet, have the data type information embedded in the format.</p>
<p>Handling dates and other custom types can require extra effort.</p>
<p>Let’s start with a small comma-separated values (CSV) text file:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">10</span>]: <span class="op">!</span>cat examples<span class="op">/</span>ex1.csv</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>a,b,c,d,message</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,hello</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,world</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,foo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Here I used the Unix <code>cat</code> shell command to print the raw contents of the file to the screen. If you’re on Windows, you can use <code>type</code> instead of <code>cat</code> to achieve the same effect within a Windows terminal (or command line).</p>
</div>
</div>
<p>Since this is comma-delimited, we can then use <code>pandas.read_csv</code> to read it into a DataFrame:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">11</span>]: df <span class="op">=</span> pd.read_csv(<span class="st">"examples/ex1.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">12</span>]: df</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">12</span>]: </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>   a   b   c   d message</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="dv">1</span>   <span class="dv">2</span>   <span class="dv">3</span>   <span class="dv">4</span>   hello</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">5</span>   <span class="dv">6</span>   <span class="dv">7</span>   <span class="dv">8</span>   world</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">9</span>  <span class="dv">10</span>  <span class="dv">11</span>  <span class="dv">12</span>     foo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A file will not always have a header row. Consider this file:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">13</span>]: <span class="op">!</span>cat examples<span class="op">/</span>ex2.csv</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,hello</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,world</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,foo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To read this file, you have a couple of options. You can allow pandas to assign default column names, or you can specify names yourself:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">14</span>]: pd.read_csv(<span class="st">"examples/ex2.csv"</span>, header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">14</span>]: </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>   <span class="dv">0</span>   <span class="dv">1</span>   <span class="dv">2</span>   <span class="dv">3</span>      <span class="dv">4</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="dv">1</span>   <span class="dv">2</span>   <span class="dv">3</span>   <span class="dv">4</span>  hello</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">5</span>   <span class="dv">6</span>   <span class="dv">7</span>   <span class="dv">8</span>  world</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">9</span>  <span class="dv">10</span>  <span class="dv">11</span>  <span class="dv">12</span>    foo</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">15</span>]: pd.read_csv(<span class="st">"examples/ex2.csv"</span>, names<span class="op">=</span>[<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"message"</span>])</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">15</span>]: </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>   a   b   c   d message</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="dv">1</span>   <span class="dv">2</span>   <span class="dv">3</span>   <span class="dv">4</span>   hello</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">5</span>   <span class="dv">6</span>   <span class="dv">7</span>   <span class="dv">8</span>   world</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">9</span>  <span class="dv">10</span>  <span class="dv">11</span>  <span class="dv">12</span>     foo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Suppose you wanted the <code>message</code> column to be the index of the returned DataFrame. You can either indicate you want the column at index 4 or named <code>"message"</code> using the <code>index_col</code> argument:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">16</span>]: names <span class="op">=</span> [<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"message"</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">17</span>]: pd.read_csv(<span class="st">"examples/ex2.csv"</span>, names<span class="op">=</span>names, index_col<span class="op">=</span><span class="st">"message"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">17</span>]: </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>         a   b   c   d</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>message               </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>hello    <span class="dv">1</span>   <span class="dv">2</span>   <span class="dv">3</span>   <span class="dv">4</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>world    <span class="dv">5</span>   <span class="dv">6</span>   <span class="dv">7</span>   <span class="dv">8</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>foo      <span class="dv">9</span>  <span class="dv">10</span>  <span class="dv">11</span>  <span class="dv">12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you want to form a hierarchical index (discussed in <a href='/book/data-wrangling#pandas_hierarchical'>Ch 8.1: Hierarchical Indexing</a>) from multiple columns, pass a list of column numbers or names:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">18</span>]: <span class="op">!</span>cat examples<span class="op">/</span>csv_mindex.csv</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>key1,key2,value1,value2</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>one,a,<span class="dv">1</span>,<span class="dv">2</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>one,b,<span class="dv">3</span>,<span class="dv">4</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>one,c,<span class="dv">5</span>,<span class="dv">6</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>one,d,<span class="dv">7</span>,<span class="dv">8</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>two,a,<span class="dv">9</span>,<span class="dv">10</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>two,b,<span class="dv">11</span>,<span class="dv">12</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>two,c,<span class="dv">13</span>,<span class="dv">14</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>two,d,<span class="dv">15</span>,<span class="dv">16</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">19</span>]: parsed <span class="op">=</span> pd.read_csv(<span class="st">"examples/csv_mindex.csv"</span>,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>   ....:                      index_col<span class="op">=</span>[<span class="st">"key1"</span>, <span class="st">"key2"</span>])</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">20</span>]: parsed</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">20</span>]: </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>           value1  value2</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>key1 key2                </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>one  a          <span class="dv">1</span>       <span class="dv">2</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>     b          <span class="dv">3</span>       <span class="dv">4</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>     c          <span class="dv">5</span>       <span class="dv">6</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>     d          <span class="dv">7</span>       <span class="dv">8</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>two  a          <span class="dv">9</span>      <span class="dv">10</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>     b         <span class="dv">11</span>      <span class="dv">12</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>     c         <span class="dv">13</span>      <span class="dv">14</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>     d         <span class="dv">15</span>      <span class="dv">16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In some cases, a table might not have a fixed delimiter, using whitespace or some other pattern to separate fields. Consider a text file that looks like this:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">21</span>]: <span class="op">!</span>cat examples<span class="op">/</span>ex3.txt</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>A         B         C</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>aaa <span class="op">-</span><span class="fl">0.264438</span> <span class="op">-</span><span class="fl">1.026059</span> <span class="op">-</span><span class="fl">0.619500</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>bbb  <span class="fl">0.927272</span>  <span class="fl">0.302904</span> <span class="op">-</span><span class="fl">0.032399</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>ccc <span class="op">-</span><span class="fl">0.264273</span> <span class="op">-</span><span class="fl">0.386314</span> <span class="op">-</span><span class="fl">0.217601</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>ddd <span class="op">-</span><span class="fl">0.871858</span> <span class="op">-</span><span class="fl">0.348382</span>  <span class="fl">1.100491</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>While you could do some munging by hand, the fields here are separated by a variable amount of whitespace. In these cases, you can pass a regular expression as a delimiter for <code>pandas.read_csv</code>. This can be expressed by the regular expression <code>\s+</code>, so we have then:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">22</span>]: result <span class="op">=</span> pd.read_csv(<span class="st">"examples/ex3.txt"</span>, sep<span class="op">=</span><span class="st">"\s+"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">23</span>]: result</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">23</span>]: </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>            A         B         C</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>aaa <span class="op">-</span><span class="fl">0.264438</span> <span class="op">-</span><span class="fl">1.026059</span> <span class="op">-</span><span class="fl">0.619500</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>bbb  <span class="fl">0.927272</span>  <span class="fl">0.302904</span> <span class="op">-</span><span class="fl">0.032399</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>ccc <span class="op">-</span><span class="fl">0.264273</span> <span class="op">-</span><span class="fl">0.386314</span> <span class="op">-</span><span class="fl">0.217601</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>ddd <span class="op">-</span><span class="fl">0.871858</span> <span class="op">-</span><span class="fl">0.348382</span>  <span class="fl">1.100491</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Because there was one fewer column name than the number of data rows, <code>pandas.read_csv</code> infers that the first column should be the DataFrame’s index in this special case.</p>
<p>The file parsing functions have many additional arguments to help you handle the wide variety of exception file formats that occur (see a partial listing in <a href="#tbl-table_read_csv_function">Table&nbsp;<span>6.2</span></a>). For example, you can skip the first, third, and fourth rows of a file with <code>skiprows</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">24</span>]: <span class="op">!</span>cat examples<span class="op">/</span>ex4.csv</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># hey!</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>a,b,c,d,message</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># just wanted to make things more difficult for you</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># who reads CSV files with computers, anyway?</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,hello</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,world</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,foo</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">25</span>]: pd.read_csv(<span class="st">"examples/ex4.csv"</span>, skiprows<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">25</span>]: </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>   a   b   c   d message</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="dv">1</span>   <span class="dv">2</span>   <span class="dv">3</span>   <span class="dv">4</span>   hello</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">5</span>   <span class="dv">6</span>   <span class="dv">7</span>   <span class="dv">8</span>   world</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">9</span>  <span class="dv">10</span>  <span class="dv">11</span>  <span class="dv">12</span>     foo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Handling missing values is an important and frequently nuanced part of the file reading process. Missing data is usually either not present (empty string) or marked by some <em>sentinel</em> (placeholder) value. By default, pandas uses a set of commonly occurring sentinels, such as <code>NA</code> and <code>NULL</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">26</span>]: <span class="op">!</span>cat examples<span class="op">/</span>ex5.csv</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>something,a,b,c,d,message</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>one,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,NA</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>two,<span class="dv">5</span>,<span class="dv">6</span>,,<span class="dv">8</span>,world</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>three,<span class="dv">9</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>,foo</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">27</span>]: result <span class="op">=</span> pd.read_csv(<span class="st">"examples/ex5.csv"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">28</span>]: result</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">28</span>]: </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  something  a   b     c   d message</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>       one  <span class="dv">1</span>   <span class="dv">2</span>   <span class="fl">3.0</span>   <span class="dv">4</span>     NaN</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>       two  <span class="dv">5</span>   <span class="dv">6</span>   NaN   <span class="dv">8</span>   world</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     three  <span class="dv">9</span>  <span class="dv">10</span>  <span class="fl">11.0</span>  <span class="dv">12</span>     foo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Recall that pandas outputs missing values as <code>NaN</code>, so we have two null or missing values in <code>result</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">29</span>]: pd.isna(result)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">29</span>]: </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>   something      a      b      c      d  message</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>      <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>     <span class="va">True</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>   <span class="va">True</span>  <span class="va">False</span>    <span class="va">False</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>    <span class="va">False</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>na_values</code> option accepts a sequence of strings to add to the default list of strings recognized as missing:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">30</span>]: result <span class="op">=</span> pd.read_csv(<span class="st">"examples/ex5.csv"</span>, na_values<span class="op">=</span>[<span class="st">"NULL"</span>])</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">31</span>]: result</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">31</span>]: </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  something  a   b     c   d message</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>       one  <span class="dv">1</span>   <span class="dv">2</span>   <span class="fl">3.0</span>   <span class="dv">4</span>     NaN</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>       two  <span class="dv">5</span>   <span class="dv">6</span>   NaN   <span class="dv">8</span>   world</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     three  <span class="dv">9</span>  <span class="dv">10</span>  <span class="fl">11.0</span>  <span class="dv">12</span>     foo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>pandas.read_csv</code> has a list of many default NA value representations, but these defaults can be disabled with the <code>keep_default_na</code> option:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">32</span>]: result2 <span class="op">=</span> pd.read_csv(<span class="st">"examples/ex5.csv"</span>, keep_default_na<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">33</span>]: result2</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">33</span>]: </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  something  a   b   c   d message</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>       one  <span class="dv">1</span>   <span class="dv">2</span>   <span class="dv">3</span>   <span class="dv">4</span>      NA</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>       two  <span class="dv">5</span>   <span class="dv">6</span>       <span class="dv">8</span>   world</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     three  <span class="dv">9</span>  <span class="dv">10</span>  <span class="dv">11</span>  <span class="dv">12</span>     foo</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">34</span>]: result2.isna()</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">34</span>]: </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>   something      a      b      c      d  message</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>      <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>    <span class="va">False</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>    <span class="va">False</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>    <span class="va">False</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">35</span>]: result3 <span class="op">=</span> pd.read_csv(<span class="st">"examples/ex5.csv"</span>, keep_default_na<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>   ....:                       na_values<span class="op">=</span>[<span class="st">"NA"</span>])</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">36</span>]: result3</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">36</span>]: </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  something  a   b   c   d message</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>       one  <span class="dv">1</span>   <span class="dv">2</span>   <span class="dv">3</span>   <span class="dv">4</span>     NaN</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>       two  <span class="dv">5</span>   <span class="dv">6</span>       <span class="dv">8</span>   world</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     three  <span class="dv">9</span>  <span class="dv">10</span>  <span class="dv">11</span>  <span class="dv">12</span>     foo</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">37</span>]: result3.isna()</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">37</span>]: </span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>   something      a      b      c      d  message</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>      <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>     <span class="va">True</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>    <span class="va">False</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>  <span class="va">False</span>    <span class="va">False</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Different NA sentinels can be specified for each column in a dictionary:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">38</span>]: sentinels <span class="op">=</span> {<span class="st">"message"</span>: [<span class="st">"foo"</span>, <span class="st">"NA"</span>], <span class="st">"something"</span>: [<span class="st">"two"</span>]}</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">39</span>]: pd.read_csv(<span class="st">"examples/ex5.csv"</span>, na_values<span class="op">=</span>sentinels,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>   ....:             keep_default_na<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">39</span>]: </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  something  a   b   c   d message</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>       one  <span class="dv">1</span>   <span class="dv">2</span>   <span class="dv">3</span>   <span class="dv">4</span>     NaN</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>       NaN  <span class="dv">5</span>   <span class="dv">6</span>       <span class="dv">8</span>   world</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     three  <span class="dv">9</span>  <span class="dv">10</span>  <span class="dv">11</span>  <span class="dv">12</span>     NaN</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><a href="#tbl-table_read_csv_function">Table&nbsp;<span>6.2</span></a> lists some frequently used options in <code>pandas.read_csv</code>.</p>
<div id="tbl-table_read_csv_function" class="anchored">
<table class="table">
<caption>Table&nbsp;6.2: Some <code>pandas.read_csv</code> function arguments</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Argument</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>path</code></td>
<td style="text-align: left;">String indicating filesystem location, URL, or file-like object.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>sep</code> or <code>delimiter</code></td>
<td style="text-align: left;">Character sequence or regular expression to use to split fields in each row.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>header</code></td>
<td style="text-align: left;">Row number to use as column names; defaults to 0 (first row), but should be <code>None</code> if there is no header row.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>index_col</code></td>
<td style="text-align: left;">Column numbers or names to use as the row index in the result; can be a single name/number or a list of them for a hierarchical index.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>names</code></td>
<td style="text-align: left;">List of column names for result.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>skiprows</code></td>
<td style="text-align: left;">Number of rows at beginning of file to ignore or list of row numbers (starting from 0) to skip.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>na_values</code></td>
<td style="text-align: left;">Sequence of values to replace with NA. They are added to the default list unless <code>keep_default_na=False</code> is passed.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>keep_default_na</code></td>
<td style="text-align: left;">Whether to use the default NA value list or not (<code>True</code> by default).</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>comment</code></td>
<td style="text-align: left;">Character(s) to split comments off the end of lines.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>parse_dates</code></td>
<td style="text-align: left;">Attempt to parse data to <code>datetime</code>; <code>False</code> by default. If <code>True</code>, will attempt to parse all columns. Otherwise, can specify a list of column numbers or names to parse. If element of list is tuple or list, will combine multiple columns together and parse to date (e.g., if date/time split across two columns).</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>keep_date_col</code></td>
<td style="text-align: left;">If joining columns to parse date, keep the joined columns; <code>False</code> by default.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>converters</code></td>
<td style="text-align: left;">Dictionary containing column number or name mapping to functions (e.g., <code>{"foo": f}</code> would apply the function <code>f</code> to all values in the <code>"foo"</code> column).</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>dayfirst</code></td>
<td style="text-align: left;">When parsing potentially ambiguous dates, treat as international format (e.g., 7/6/2012 -&gt; June 7, 2012); <code>False</code> by default.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>date_parser</code></td>
<td style="text-align: left;">Function to use to parse dates.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>nrows</code></td>
<td style="text-align: left;">Number of rows to read from beginning of file (not counting the header).</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>iterator</code></td>
<td style="text-align: left;">Return a <code>TextFileReader</code> object for reading the file piecemeal. This object can also be used with the <code>with</code> statement.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>chunksize</code></td>
<td style="text-align: left;">For iteration, size of file chunks.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>skip_footer</code></td>
<td style="text-align: left;">Number of lines to ignore at end of file.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>verbose</code></td>
<td style="text-align: left;">Print various parsing information, like the time spent in each stage of the file conversion and memory use information.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>encoding</code></td>
<td style="text-align: left;">Text encoding (e.g., <code>"utf-8</code> for UTF-8 encoded text). Defaults to <code>"utf-8"</code> if <code>None</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>squeeze</code></td>
<td style="text-align: left;">If the parsed data contains only one column, return a Series.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>thousands</code></td>
<td style="text-align: left;">Separator for thousands (e.g., <code>","</code> or <code>"."</code>); default is <code>None</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>decimal</code></td>
<td style="text-align: left;">Decimal separator in numbers (e.g., <code>"."</code> or <code>","</code>); default is <code>"."</code>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>engine</code></td>
<td style="text-align: left;">CSV parsing and conversion engine to use; can be one of <code>"c"</code>, <code>"python"</code>, or <code>"pyarrow"</code>. The default is <code>"c"</code>, though the newer <code>"pyarrow"</code> engine can parse some files much faster. The <code>"python"</code> engine is slower but supports some features that the other engines do not.</td>
</tr>
</tbody>
</table>
</div>
<section id="pandas_file_chunking" class="level3">
<h3 class="anchored" data-anchor-id="pandas_file_chunking">Reading Text Files in Pieces</h3>
<p>When processing very large files or figuring out the right set of arguments to correctly process a large file, you may want to read only a small piece of a file or iterate through smaller chunks of the file.</p>
<p>Before we look at a large file, we make the pandas display settings more compact:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">40</span>]: pd.options.display.max_rows <span class="op">=</span> <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now we have:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">41</span>]: result <span class="op">=</span> pd.read_csv(<span class="st">"examples/ex6.csv"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">42</span>]: result</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">42</span>]: </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>           one       two     three      four key</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>     <span class="fl">0.467976</span> <span class="op">-</span><span class="fl">0.038649</span> <span class="op">-</span><span class="fl">0.295344</span> <span class="op">-</span><span class="fl">1.824726</span>   L</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>    <span class="op">-</span><span class="fl">0.358893</span>  <span class="fl">1.404453</span>  <span class="fl">0.704965</span> <span class="op">-</span><span class="fl">0.200638</span>   B</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>    <span class="op">-</span><span class="fl">0.501840</span>  <span class="fl">0.659254</span> <span class="op">-</span><span class="fl">0.421691</span> <span class="op">-</span><span class="fl">0.057688</span>   G</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>     <span class="fl">0.204886</span>  <span class="fl">1.074134</span>  <span class="fl">1.388361</span> <span class="op">-</span><span class="fl">0.982404</span>   R</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>     <span class="fl">0.354628</span> <span class="op">-</span><span class="fl">0.133116</span>  <span class="fl">0.283763</span> <span class="op">-</span><span class="fl">0.837063</span>   Q</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>...        ...       ...       ...       ...  ..</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="dv">9995</span>  <span class="fl">2.311896</span> <span class="op">-</span><span class="fl">0.417070</span> <span class="op">-</span><span class="fl">1.409599</span> <span class="op">-</span><span class="fl">0.515821</span>   L</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="dv">9996</span> <span class="op">-</span><span class="fl">0.479893</span> <span class="op">-</span><span class="fl">0.650419</span>  <span class="fl">0.745152</span> <span class="op">-</span><span class="fl">0.646038</span>   E</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="dv">9997</span>  <span class="fl">0.523331</span>  <span class="fl">0.787112</span>  <span class="fl">0.486066</span>  <span class="fl">1.093156</span>   K</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="dv">9998</span> <span class="op">-</span><span class="fl">0.362559</span>  <span class="fl">0.598894</span> <span class="op">-</span><span class="fl">1.843201</span>  <span class="fl">0.887292</span>   G</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="dv">9999</span> <span class="op">-</span><span class="fl">0.096376</span> <span class="op">-</span><span class="fl">1.012999</span> <span class="op">-</span><span class="fl">0.657431</span> <span class="op">-</span><span class="fl">0.573315</span>   <span class="dv">0</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>[<span class="dv">10000</span> rows x <span class="dv">5</span> columns]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The elipsis marks <code>...</code> indicate that rows in the middle of the DataFrame have been omitted.</p>
<p>If you want to read only a small number of rows (avoiding reading the entire file), specify that with <code>nrows</code>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">43</span>]: pd.read_csv(<span class="st">"examples/ex6.csv"</span>, nrows<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">43</span>]: </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>        one       two     three      four key</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="fl">0.467976</span> <span class="op">-</span><span class="fl">0.038649</span> <span class="op">-</span><span class="fl">0.295344</span> <span class="op">-</span><span class="fl">1.824726</span>   L</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-</span><span class="fl">0.358893</span>  <span class="fl">1.404453</span>  <span class="fl">0.704965</span> <span class="op">-</span><span class="fl">0.200638</span>   B</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">-</span><span class="fl">0.501840</span>  <span class="fl">0.659254</span> <span class="op">-</span><span class="fl">0.421691</span> <span class="op">-</span><span class="fl">0.057688</span>   G</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="fl">0.204886</span>  <span class="fl">1.074134</span>  <span class="fl">1.388361</span> <span class="op">-</span><span class="fl">0.982404</span>   R</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="fl">0.354628</span> <span class="op">-</span><span class="fl">0.133116</span>  <span class="fl">0.283763</span> <span class="op">-</span><span class="fl">0.837063</span>   Q</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To read a file in pieces, specify a <code>chunksize</code> as a number of rows:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">44</span>]: chunker <span class="op">=</span> pd.read_csv(<span class="st">"examples/ex6.csv"</span>, chunksize<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">45</span>]: <span class="bu">type</span>(chunker)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">45</span>]: pandas.io.parsers.readers.TextFileReader</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>TextFileReader</code> object returned by <code>pandas.read_csv</code> allows you to iterate over the parts of the file according to the <code>chunksize</code>. For example, we can iterate over <code>ex6.csv</code>, aggregating the value counts in the <code>"key"</code> column, like so:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>chunker <span class="op">=</span> pd.read_csv(<span class="st">"examples/ex6.csv"</span>, chunksize<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>tot <span class="op">=</span> pd.Series([], dtype<span class="op">=</span><span class="st">'int64'</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> piece <span class="kw">in</span> chunker:</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    tot <span class="op">=</span> tot.add(piece[<span class="st">"key"</span>].value_counts(), fill_value<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>tot <span class="op">=</span> tot.sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We have then:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">47</span>]: tot[:<span class="dv">10</span>]</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">47</span>]: </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>key</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>E    <span class="fl">368.0</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>X    <span class="fl">364.0</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>L    <span class="fl">346.0</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>O    <span class="fl">343.0</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>Q    <span class="fl">340.0</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>M    <span class="fl">338.0</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>J    <span class="fl">337.0</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>F    <span class="fl">335.0</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>K    <span class="fl">334.0</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>H    <span class="fl">330.0</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>TextFileReader</code> is also equipped with a <code>get_chunk</code> method that enables you to read pieces of an arbitrary size.</p>
</section>
<section id="pandas_text_writing" class="level3">
<h3 class="anchored" data-anchor-id="pandas_text_writing">Writing Data to Text Format</h3>
<p>Data can also be exported to a delimited format. Let’s consider one of the CSV files read before:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">48</span>]: data <span class="op">=</span> pd.read_csv(<span class="st">"examples/ex5.csv"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">49</span>]: data</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">49</span>]: </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  something  a   b     c   d message</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>       one  <span class="dv">1</span>   <span class="dv">2</span>   <span class="fl">3.0</span>   <span class="dv">4</span>     NaN</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>       two  <span class="dv">5</span>   <span class="dv">6</span>   NaN   <span class="dv">8</span>   world</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>     three  <span class="dv">9</span>  <span class="dv">10</span>  <span class="fl">11.0</span>  <span class="dv">12</span>     foo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Using DataFrame’s <code>to_csv</code> method, we can write the data out to a comma-separated file:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">50</span>]: data.to_csv(<span class="st">"examples/out.csv"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">51</span>]: <span class="op">!</span>cat examples<span class="op">/</span>out.csv</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>,something,a,b,c,d,message</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>,one,<span class="dv">1</span>,<span class="dv">2</span>,<span class="fl">3.0</span>,<span class="dv">4</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>,two,<span class="dv">5</span>,<span class="dv">6</span>,,<span class="dv">8</span>,world</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>,three,<span class="dv">9</span>,<span class="dv">10</span>,<span class="fl">11.0</span>,<span class="dv">12</span>,foo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Other delimiters can be used, of course (writing to <code>sys.stdout</code> so it prints the text result to the console rather than a file):</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">52</span>]: <span class="im">import</span> sys</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">53</span>]: data.to_csv(sys.stdout, sep<span class="op">=</span><span class="st">"|"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="op">|</span>something<span class="op">|</span>a<span class="op">|</span>b<span class="op">|</span>c<span class="op">|</span>d<span class="op">|</span>message</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">|</span>one<span class="op">|</span><span class="dv">1</span><span class="op">|</span><span class="dv">2</span><span class="op">|</span><span class="fl">3.0</span><span class="op">|</span><span class="dv">4</span><span class="op">|</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">|</span>two<span class="op">|</span><span class="dv">5</span><span class="op">|</span><span class="dv">6</span><span class="op">||</span><span class="dv">8</span><span class="op">|</span>world</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="op">|</span>three<span class="op">|</span><span class="dv">9</span><span class="op">|</span><span class="dv">10</span><span class="op">|</span><span class="fl">11.0</span><span class="op">|</span><span class="dv">12</span><span class="op">|</span>foo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Missing values appear as empty strings in the output. You might want to denote them by some other sentinel value:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">54</span>]: data.to_csv(sys.stdout, na_rep<span class="op">=</span><span class="st">"NULL"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>,something,a,b,c,d,message</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>,one,<span class="dv">1</span>,<span class="dv">2</span>,<span class="fl">3.0</span>,<span class="dv">4</span>,NULL</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>,two,<span class="dv">5</span>,<span class="dv">6</span>,NULL,<span class="dv">8</span>,world</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>,three,<span class="dv">9</span>,<span class="dv">10</span>,<span class="fl">11.0</span>,<span class="dv">12</span>,foo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>With no other options specified, both the row and column labels are written. Both of these can be disabled:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">55</span>]: data.to_csv(sys.stdout, index<span class="op">=</span><span class="va">False</span>, header<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>one,<span class="dv">1</span>,<span class="dv">2</span>,<span class="fl">3.0</span>,<span class="dv">4</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>two,<span class="dv">5</span>,<span class="dv">6</span>,,<span class="dv">8</span>,world</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>three,<span class="dv">9</span>,<span class="dv">10</span>,<span class="fl">11.0</span>,<span class="dv">12</span>,foo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can also write only a subset of the columns, and in an order of your choosing:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">56</span>]: data.to_csv(sys.stdout, index<span class="op">=</span><span class="va">False</span>, columns<span class="op">=</span>[<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>])</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>a,b,c</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>,<span class="dv">2</span>,<span class="fl">3.0</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>,<span class="dv">6</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>,<span class="dv">10</span>,<span class="fl">11.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="io_file_formats_csv" class="level3">
<h3 class="anchored" data-anchor-id="io_file_formats_csv">Working with Other Delimited Formats</h3>
<p>It's possible to load most forms of tabular data from disk using functions like <code>pandas.read_csv</code>. In some cases, however, some manual processing may be necessary. It’s not uncommon to receive a file with one or more malformed lines that trip up <code>pandas.read_csv</code>. To illustrate the basic tools, consider a small CSV file:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">57</span>]: <span class="op">!</span>cat examples<span class="op">/</span>ex7.csv</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For any file with a single-character delimiter, you can use Python’s built-in <code>csv</code> module. To use it, pass any open file or file-like object to <code>csv.reader</code>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">58</span>]: <span class="im">import</span> csv</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">59</span>]: f <span class="op">=</span> <span class="bu">open</span>(<span class="st">"examples/ex7.csv"</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">60</span>]: reader <span class="op">=</span> csv.reader(f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Iterating through the reader like a file yields lists of values with any quote characters removed:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">61</span>]: <span class="cf">for</span> line <span class="kw">in</span> reader:</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>   ....:     <span class="bu">print</span>(line)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>[<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>]</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>[<span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span>]</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>[<span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span>]</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">62</span>]: f.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>From there, it’s up to you to do the wrangling necessary to put the data in the form that you need. Let's take this step by step. First, we read the file into a list of lines:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">63</span>]: <span class="cf">with</span> <span class="bu">open</span>(<span class="st">"examples/ex7.csv"</span>) <span class="im">as</span> f:</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>   ....:     lines <span class="op">=</span> <span class="bu">list</span>(csv.reader(f))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then we split the lines into the header line and the data lines:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">64</span>]: header, values <span class="op">=</span> lines[<span class="dv">0</span>], lines[<span class="dv">1</span>:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then we can create a dictionary of data columns using a dictionary comprehension and the expression <code>zip(*values)</code> (beware that this will use a lot of memory on large files), which transposes rows to columns:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">65</span>]: data_dict <span class="op">=</span> {h: v <span class="cf">for</span> h, v <span class="kw">in</span> <span class="bu">zip</span>(header, <span class="bu">zip</span>(<span class="op">*</span>values))}</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">66</span>]: data_dict</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">66</span>]: {<span class="st">'a'</span>: (<span class="st">'1'</span>, <span class="st">'1'</span>), <span class="st">'b'</span>: (<span class="st">'2'</span>, <span class="st">'2'</span>), <span class="st">'c'</span>: (<span class="st">'3'</span>, <span class="st">'3'</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>CSV files come in many different flavors. To define a new format with a different delimiter, string quoting convention, or line terminator, we could define a simple subclass of <code>csv.Dialect</code>:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> my_dialect(csv.Dialect):</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    lineterminator <span class="op">=</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    delimiter <span class="op">=</span> <span class="st">";"</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    quotechar <span class="op">=</span> <span class="st">'"'</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    quoting <span class="op">=</span> csv.QUOTE_MINIMAL</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>reader <span class="op">=</span> csv.reader(f, dialect<span class="op">=</span>my_dialect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We could also give individual CSV dialect parameters as keywords to <code>csv.reader</code> without having to define a subclass:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>reader <span class="op">=</span> csv.reader(f, delimiter<span class="op">=</span><span class="st">"|"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The possible options (attributes of <code>csv.Dialect</code>) and what they do can be found in <a href="#tbl-table_csv_dialect">Table&nbsp;<span>6.3</span></a>.</p>
<div id="tbl-table_csv_dialect" class="anchored">
<table class="table">
<caption>Table&nbsp;6.3: CSV <code>dialect</code> options</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Argument</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>delimiter</code></td>
<td style="text-align: left;">One-character string to separate fields; defaults to <code>","</code>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>lineterminator</code></td>
<td style="text-align: left;">Line terminator for writing; defaults to <code>"\r\n"</code>. Reader ignores this and recognizes cross-platform line terminators.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>quotechar</code></td>
<td style="text-align: left;">Quote character for fields with special characters (like a delimiter); default is <code>'"'</code>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>quoting</code></td>
<td style="text-align: left;">Quoting convention. Options include <code>csv.QUOTE_ALL</code> (quote all fields), <code>csv.QUOTE_MINIMAL</code> (only fields with special characters like the delimiter), <code>csv.QUOTE_NONNUMERIC</code>, and <code>csv.QUOTE_NONE</code> (no quoting). See Python’s documentation for full details. Defaults to <code>QUOTE_MINIMAL</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>skipinitialspace</code></td>
<td style="text-align: left;">Ignore whitespace after each delimiter; default is <code>False</code>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>doublequote</code></td>
<td style="text-align: left;">How to handle quoting character inside a field; if <code>True</code>, it is doubled (see online documentation for full detail and behavior).</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>escapechar</code></td>
<td style="text-align: left;">String to escape the delimiter if <code>quoting</code> is set to <code>csv.QUOTE_NONE</code>; disabled by default.</td>
</tr>
</tbody>
</table>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For files with more complicated or fixed multicharacter delimiters, you will not be able to use the <code>csv</code> module. In those cases, you’ll have to do the line splitting and other cleanup using the string’s <code>split</code> method or the regular expression method <code>re.split</code>. Thankfully, <code>pandas.read_csv</code> is capable of doing almost anything you need if you pass the necessary options, so you only rarely will have to parse files by hand.</p>
</div>
</div>
<p>To <em>write</em> delimited files manually, you can use <code>csv.writer</code>. It accepts an open, writable file object and the same dialect and format options as <code>csv.reader</code>:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"mydata.csv"</span>, <span class="st">"w"</span>) <span class="im">as</span> f:</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    writer <span class="op">=</span> csv.writer(f, dialect<span class="op">=</span>my_dialect)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    writer.writerow((<span class="st">"one"</span>, <span class="st">"two"</span>, <span class="st">"three"</span>))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    writer.writerow((<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>))</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    writer.writerow((<span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"6"</span>))</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    writer.writerow((<span class="st">"7"</span>, <span class="st">"8"</span>, <span class="st">"9"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="io_format_json" class="level3">
<h3 class="anchored" data-anchor-id="io_format_json">JSON Data</h3>
<p>JSON (short for JavaScript Object Notation) has become one of the standard formats for sending data by HTTP request between web browsers and other applications. It is a much more free-form data format than a tabular text form like CSV. Here is an example:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>obj <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="st">{"name": "Wes",</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="st"> "cities_lived": ["Akron", "Nashville", "New York", "San Francisco"],</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="st"> "pet": null,</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="st"> "siblings": [{"name": "Scott", "age": 34, "hobbies": ["guitars", "soccer"]},</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="st">              {"name": "Katie", "age": 42, "hobbies": ["diving", "art"]}]</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>JSON is very nearly valid Python code with the exception of its null value <code>null</code> and some other nuances (such as disallowing trailing commas at the end of lists). The basic types are objects (dictionaries), arrays (lists), strings, numbers, Booleans, and nulls. All of the keys in an object must be strings. There are several Python libraries for reading and writing JSON data. I’ll use <code>json</code> here, as it is built into the Python standard library. To convert a JSON string to Python form, use <code>json.loads</code>:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">68</span>]: <span class="im">import</span> json</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">69</span>]: result <span class="op">=</span> json.loads(obj)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">70</span>]: result</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">70</span>]: </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>{<span class="st">'name'</span>: <span class="st">'Wes'</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a> <span class="st">'cities_lived'</span>: [<span class="st">'Akron'</span>, <span class="st">'Nashville'</span>, <span class="st">'New York'</span>, <span class="st">'San Francisco'</span>],</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a> <span class="st">'pet'</span>: <span class="va">None</span>,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a> <span class="st">'siblings'</span>: [{<span class="st">'name'</span>: <span class="st">'Scott'</span>,</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>   <span class="st">'age'</span>: <span class="dv">34</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>   <span class="st">'hobbies'</span>: [<span class="st">'guitars'</span>, <span class="st">'soccer'</span>]},</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  {<span class="st">'name'</span>: <span class="st">'Katie'</span>, <span class="st">'age'</span>: <span class="dv">42</span>, <span class="st">'hobbies'</span>: [<span class="st">'diving'</span>, <span class="st">'art'</span>]}]}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>json.dumps</code>, on the other hand, converts a Python object back to JSON:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">71</span>]: asjson <span class="op">=</span> json.dumps(result)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">72</span>]: asjson</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">72</span>]: <span class="st">'{"name": "Wes", "cities_lived": ["Akron", "Nashville", "New York", "San</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="er"> Francisco"], "pet": null, "siblings": [{"name": "Scott", "age": 34, "hobbies": [</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co">"guitars"</span>, <span class="st">"soccer"</span>]}, {<span class="st">"name"</span>: <span class="st">"Katie"</span>, <span class="st">"age"</span>: <span class="dv">42</span>, <span class="st">"hobbies"</span>: [<span class="st">"diving"</span>, <span class="st">"art"</span>]}</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>]}<span class="st">'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>How you convert a JSON object or list of objects to a DataFrame or some other data structure for analysis will be up to you. Conveniently, you can pass a list of dictionaries (which were previously JSON objects) to the DataFrame constructor and select a subset of the data fields:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">73</span>]: siblings <span class="op">=</span> pd.DataFrame(result[<span class="st">"siblings"</span>], columns<span class="op">=</span>[<span class="st">"name"</span>, <span class="st">"age"</span>])</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">74</span>]: siblings</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">74</span>]: </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    name  age</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  Scott   <span class="dv">34</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  Katie   <span class="dv">42</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>pandas.read_json</code> can automatically convert JSON datasets in specific arrangements into a Series or DataFrame. For example:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">75</span>]: <span class="op">!</span>cat examples<span class="op">/</span>example.json</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>[{<span class="st">"a"</span>: <span class="dv">1</span>, <span class="st">"b"</span>: <span class="dv">2</span>, <span class="st">"c"</span>: <span class="dv">3</span>},</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a> {<span class="st">"a"</span>: <span class="dv">4</span>, <span class="st">"b"</span>: <span class="dv">5</span>, <span class="st">"c"</span>: <span class="dv">6</span>},</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a> {<span class="st">"a"</span>: <span class="dv">7</span>, <span class="st">"b"</span>: <span class="dv">8</span>, <span class="st">"c"</span>: <span class="dv">9</span>}]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The default options for <code>pandas.read_json</code> assume that each object in the JSON array is a row in the table:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">76</span>]: data <span class="op">=</span> pd.read_json(<span class="st">"examples/example.json"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">77</span>]: data</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">77</span>]: </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>   a  b  c</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="dv">1</span>  <span class="dv">2</span>  <span class="dv">3</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">4</span>  <span class="dv">5</span>  <span class="dv">6</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">7</span>  <span class="dv">8</span>  <span class="dv">9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For an extended example of reading and manipulating JSON data (including nested records), see the USDA food database example in <a href="#data-analysis-examples">Ch 13: Data Analysis Examples</a>.</p>
<p>If you need to export data from pandas to JSON, one way is to use the <code>to_json</code> methods on Series and DataFrame:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">78</span>]: data.to_json(sys.stdout)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>{<span class="st">"a"</span>:{<span class="st">"0"</span>:<span class="dv">1</span>,<span class="st">"1"</span>:<span class="dv">4</span>,<span class="st">"2"</span>:<span class="dv">7</span>},<span class="st">"b"</span>:{<span class="st">"0"</span>:<span class="dv">2</span>,<span class="st">"1"</span>:<span class="dv">5</span>,<span class="st">"2"</span>:<span class="dv">8</span>},<span class="st">"c"</span>:{<span class="st">"0"</span>:<span class="dv">3</span>,<span class="st">"1"</span>:<span class="dv">6</span>,<span class="st">"2"</span>:<span class="dv">9</span>}}</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">79</span>]: data.to_json(sys.stdout, orient<span class="op">=</span><span class="st">"records"</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>[{<span class="st">"a"</span>:<span class="dv">1</span>,<span class="st">"b"</span>:<span class="dv">2</span>,<span class="st">"c"</span>:<span class="dv">3</span>},{<span class="st">"a"</span>:<span class="dv">4</span>,<span class="st">"b"</span>:<span class="dv">5</span>,<span class="st">"c"</span>:<span class="dv">6</span>},{<span class="st">"a"</span>:<span class="dv">7</span>,<span class="st">"b"</span>:<span class="dv">8</span>,<span class="st">"c"</span>:<span class="dv">9</span>}]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="io_file_formats_html_xml" class="level3">
<h3 class="anchored" data-anchor-id="io_file_formats_html_xml">XML and HTML: Web Scraping</h3>
<p>Python has many libraries for reading and writing data in the ubiquitous HTML and XML formats. Examples include lxml, Beautiful Soup, and html5lib. While lxml is comparatively much faster in general, the other libraries can better handle malformed HTML or XML files.</p>
<p>pandas has a built-in function, <code>pandas.read_html</code>, which uses all of these libraries to automatically parse tables out of HTML files as DataFrame objects. To show how this works, I downloaded an HTML file (used in the pandas documentation) from the US FDIC showing bank failures.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> First, you must install some additional libraries used by <code>read_html</code>:</p>
<pre><code>conda install lxml beautifulsoup4 html5lib</code></pre>
<p>If you are not using conda, <code>pip install lxml</code> should also work.</p>
<p>The <code>pandas.read_html</code> function has a number of options, but by default it searches for and attempts to parse all tabular data contained within <code>&lt;table&gt;</code> tags. The result is a list of DataFrame objects:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">80</span>]: tables <span class="op">=</span> pd.read_html(<span class="st">"examples/fdic_failed_bank_list.html"</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">81</span>]: <span class="bu">len</span>(tables)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">81</span>]: <span class="dv">1</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">82</span>]: failures <span class="op">=</span> tables[<span class="dv">0</span>]</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">83</span>]: failures.head()</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">83</span>]: </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>                      Bank Name             City  ST   CERT   </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>                   Allied Bank         Mulberry  AR     <span class="dv">91</span>  <span class="op">\</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  The Woodbury Banking Company         Woodbury  GA  <span class="dv">11297</span>   </span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>        First CornerStone Bank  King of Prussia  PA  <span class="dv">35312</span>   </span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>            Trust Company Bank          Memphis  TN   <span class="dv">9956</span>   </span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>    North Milwaukee State Bank        Milwaukee  WI  <span class="dv">20364</span>   </span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>                 Acquiring Institution        Closing Date       Updated Date  </span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>                         Today<span class="st">'s Bank  September 23, 2016  November 17, 2016  </span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="er">1                          United Bank     August 19, 2016  November 17, 2016  </span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  First<span class="op">-</span>Citizens Bank <span class="op">&amp;</span> Trust Company         May <span class="dv">6</span>, <span class="dv">2016</span>  September <span class="dv">6</span>, <span class="dv">2016</span>  </span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>           The Bank of Fayette County      April <span class="dv">29</span>, <span class="dv">2016</span>  September <span class="dv">6</span>, <span class="dv">2016</span>  </span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  First<span class="op">-</span>Citizens Bank <span class="op">&amp;</span> Trust Company      March <span class="dv">11</span>, <span class="dv">2016</span>      June <span class="dv">16</span>, <span class="dv">2016</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Because <code>failures</code> has many columns, pandas inserts a line break character <code>\</code>.</p>
<p>As you will learn in later chapters, from here we could proceed to do some data cleaning and analysis, like computing the number of bank failures by year:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">84</span>]: close_timestamps <span class="op">=</span> pd.to_datetime(failures[<span class="st">"Closing Date"</span>])</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">85</span>]: close_timestamps.dt.year.value_counts()</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">85</span>]: </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>Closing Date</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2010</span>    <span class="dv">157</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2009</span>    <span class="dv">140</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span>     <span class="dv">92</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span>     <span class="dv">51</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2008</span>     <span class="dv">25</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>       ... </span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2004</span>      <span class="dv">4</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span>      <span class="dv">4</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2007</span>      <span class="dv">3</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2003</span>      <span class="dv">3</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span>      <span class="dv">2</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>Name: count, Length: <span class="dv">15</span>, dtype: int64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="io_file_formats_xml" class="level4">
<h4 class="anchored" data-anchor-id="io_file_formats_xml">Parsing XML with lxml.objectify</h4>
<p>XML is another common structured data format supporting hierarchical, nested data with metadata. The book you are currently reading was actually created from a series of large XML documents.</p>
<p>Earlier, I showed the <code>pandas.read_html</code> function, which uses either lxml or Beautiful Soup under the hood to parse data from HTML. XML and HTML are structurally similar, but XML is more general. Here, I will show an example of how to use lxml to parse data from a more general XML format.</p>
<p>For many years, the New York Metropolitan Transportation Authority (MTA) published a number of data series about its bus and train services in XML format. Here we’ll look at the performance data, which is contained in a set of XML files. Each train or bus service has a different file (like <em>Performance_MNR.xml</em> for the Metro-North Railroad) containing monthly data as a series of XML records that look like this:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode xml code-with-copy"><code class="sourceCode xml"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">INDICATOR</span>&gt;</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">INDICATOR_SEQ</span>&gt;373889&lt;/<span class="kw">INDICATOR_SEQ</span>&gt;</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">PARENT_SEQ</span>&gt;&lt;/<span class="kw">PARENT_SEQ</span>&gt;</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">AGENCY_NAME</span>&gt;Metro-North Railroad&lt;/<span class="kw">AGENCY_NAME</span>&gt;</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">INDICATOR_NAME</span>&gt;Escalator Availability&lt;/<span class="kw">INDICATOR_NAME</span>&gt;</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">DESCRIPTION</span>&gt;Percent of the time that escalators are operational</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  systemwide. The availability rate is based on physical observations performed</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  the morning of regular business days only. This is a new indicator the agency</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  began reporting in 2009.&lt;/<span class="kw">DESCRIPTION</span>&gt;</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">PERIOD_YEAR</span>&gt;2011&lt;/<span class="kw">PERIOD_YEAR</span>&gt;</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">PERIOD_MONTH</span>&gt;12&lt;/<span class="kw">PERIOD_MONTH</span>&gt;</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">CATEGORY</span>&gt;Service Indicators&lt;/<span class="kw">CATEGORY</span>&gt;</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">FREQUENCY</span>&gt;M&lt;/<span class="kw">FREQUENCY</span>&gt;</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">DESIRED_CHANGE</span>&gt;U&lt;/<span class="kw">DESIRED_CHANGE</span>&gt;</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">INDICATOR_UNIT</span>&gt;%&lt;/<span class="kw">INDICATOR_UNIT</span>&gt;</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">DECIMAL_PLACES</span>&gt;1&lt;/<span class="kw">DECIMAL_PLACES</span>&gt;</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">YTD_TARGET</span>&gt;97.00&lt;/<span class="kw">YTD_TARGET</span>&gt;</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">YTD_ACTUAL</span>&gt;&lt;/<span class="kw">YTD_ACTUAL</span>&gt;</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">MONTHLY_TARGET</span>&gt;97.00&lt;/<span class="kw">MONTHLY_TARGET</span>&gt;</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  &lt;<span class="kw">MONTHLY_ACTUAL</span>&gt;&lt;/<span class="kw">MONTHLY_ACTUAL</span>&gt;</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">INDICATOR</span>&gt;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Using <code>lxml.objectify</code>, we parse the file and get a reference to the root node of the XML file with <code>getroot</code>:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">86</span>]: <span class="im">from</span> lxml <span class="im">import</span> objectify</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">87</span>]: path <span class="op">=</span> <span class="st">"datasets/mta_perf/Performance_MNR.xml"</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">88</span>]: <span class="cf">with</span> <span class="bu">open</span>(path) <span class="im">as</span> f:</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>   ....:     parsed <span class="op">=</span> objectify.parse(f)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">89</span>]: root <span class="op">=</span> parsed.getroot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>root.INDICATOR</code> returns a generator yielding each <code>&lt;INDICATOR&gt;</code> XML element. For each record, we can populate a dictionary of tag names (like <code>YTD_ACTUAL</code>) to data values (excluding a few tags) by running the following code:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>skip_fields <span class="op">=</span> [<span class="st">"PARENT_SEQ"</span>, <span class="st">"INDICATOR_SEQ"</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"DESIRED_CHANGE"</span>, <span class="st">"DECIMAL_PLACES"</span>]</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> elt <span class="kw">in</span> root.INDICATOR:</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    el_data <span class="op">=</span> {}</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> child <span class="kw">in</span> elt.getchildren():</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> child.tag <span class="kw">in</span> skip_fields:</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>        el_data[child.tag] <span class="op">=</span> child.pyval</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    data.append(el_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Lastly, convert this list of dictionaries into a DataFrame:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">91</span>]: perf <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">92</span>]: perf.head()</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">92</span>]: </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>            AGENCY_NAME                        INDICATOR_NAME   </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  Metro<span class="op">-</span>North Railroad  On<span class="op">-</span>Time Performance (West of Hudson)  <span class="op">\</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  Metro<span class="op">-</span>North Railroad  On<span class="op">-</span>Time Performance (West of Hudson)   </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  Metro<span class="op">-</span>North Railroad  On<span class="op">-</span>Time Performance (West of Hudson)   </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  Metro<span class="op">-</span>North Railroad  On<span class="op">-</span>Time Performance (West of Hudson)   </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  Metro<span class="op">-</span>North Railroad  On<span class="op">-</span>Time Performance (West of Hudson)   </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>                                                                  DESCRIPTION   </span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  Percent of commuter trains that arrive at their destinations within <span class="dv">5</span> m...  <span class="op">\</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  Percent of commuter trains that arrive at their destinations within <span class="dv">5</span> m...   </span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  Percent of commuter trains that arrive at their destinations within <span class="dv">5</span> m...   </span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  Percent of commuter trains that arrive at their destinations within <span class="dv">5</span> m...   </span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  Percent of commuter trains that arrive at their destinations within <span class="dv">5</span> m...   </span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>   PERIOD_YEAR  PERIOD_MONTH            CATEGORY FREQUENCY INDICATOR_UNIT   </span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>         <span class="dv">2008</span>             <span class="dv">1</span>  Service Indicators         M              <span class="op">%</span>  <span class="op">\</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>         <span class="dv">2008</span>             <span class="dv">2</span>  Service Indicators         M              <span class="op">%</span>   </span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>         <span class="dv">2008</span>             <span class="dv">3</span>  Service Indicators         M              <span class="op">%</span>   </span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>         <span class="dv">2008</span>             <span class="dv">4</span>  Service Indicators         M              <span class="op">%</span>   </span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>         <span class="dv">2008</span>             <span class="dv">5</span>  Service Indicators         M              <span class="op">%</span>   </span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  YTD_TARGET YTD_ACTUAL MONTHLY_TARGET MONTHLY_ACTUAL  </span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>       <span class="fl">95.0</span>       <span class="fl">96.9</span>           <span class="fl">95.0</span>           <span class="fl">96.9</span>  </span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>       <span class="fl">95.0</span>       <span class="fl">96.0</span>           <span class="fl">95.0</span>           <span class="fl">95.0</span>  </span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>       <span class="fl">95.0</span>       <span class="fl">96.3</span>           <span class="fl">95.0</span>           <span class="fl">96.9</span>  </span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>       <span class="fl">95.0</span>       <span class="fl">96.8</span>           <span class="fl">95.0</span>           <span class="fl">98.3</span>  </span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>       <span class="fl">95.0</span>       <span class="fl">96.6</span>           <span class="fl">95.0</span>           <span class="fl">95.8</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>pandas's <code>pandas.read_xml</code> function turns this process into a one-line expression:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">93</span>]: perf2 <span class="op">=</span> pd.read_xml(path)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">94</span>]: perf2.head()</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">94</span>]: </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>   INDICATOR_SEQ  PARENT_SEQ           AGENCY_NAME   </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>          <span class="dv">28445</span>         NaN  Metro<span class="op">-</span>North Railroad  <span class="op">\</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>          <span class="dv">28445</span>         NaN  Metro<span class="op">-</span>North Railroad   </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>          <span class="dv">28445</span>         NaN  Metro<span class="op">-</span>North Railroad   </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>          <span class="dv">28445</span>         NaN  Metro<span class="op">-</span>North Railroad   </span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>          <span class="dv">28445</span>         NaN  Metro<span class="op">-</span>North Railroad   </span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>                         INDICATOR_NAME   </span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  On<span class="op">-</span>Time Performance (West of Hudson)  <span class="op">\</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  On<span class="op">-</span>Time Performance (West of Hudson)   </span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  On<span class="op">-</span>Time Performance (West of Hudson)   </span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  On<span class="op">-</span>Time Performance (West of Hudson)   </span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  On<span class="op">-</span>Time Performance (West of Hudson)   </span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>                                                                  DESCRIPTION   </span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  Percent of commuter trains that arrive at their destinations within <span class="dv">5</span> m...  <span class="op">\</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  Percent of commuter trains that arrive at their destinations within <span class="dv">5</span> m...   </span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  Percent of commuter trains that arrive at their destinations within <span class="dv">5</span> m...   </span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  Percent of commuter trains that arrive at their destinations within <span class="dv">5</span> m...   </span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  Percent of commuter trains that arrive at their destinations within <span class="dv">5</span> m...   </span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>   PERIOD_YEAR  PERIOD_MONTH            CATEGORY FREQUENCY DESIRED_CHANGE   </span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>         <span class="dv">2008</span>             <span class="dv">1</span>  Service Indicators         M              U  <span class="op">\</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>         <span class="dv">2008</span>             <span class="dv">2</span>  Service Indicators         M              U   </span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>         <span class="dv">2008</span>             <span class="dv">3</span>  Service Indicators         M              U   </span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>         <span class="dv">2008</span>             <span class="dv">4</span>  Service Indicators         M              U   </span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>         <span class="dv">2008</span>             <span class="dv">5</span>  Service Indicators         M              U   </span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>  INDICATOR_UNIT  DECIMAL_PLACES YTD_TARGET YTD_ACTUAL MONTHLY_TARGET   </span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>              <span class="op">%</span>               <span class="dv">1</span>      <span class="fl">95.00</span>      <span class="fl">96.90</span>          <span class="fl">95.00</span>  <span class="op">\</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>              <span class="op">%</span>               <span class="dv">1</span>      <span class="fl">95.00</span>      <span class="fl">96.00</span>          <span class="fl">95.00</span>   </span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>              <span class="op">%</span>               <span class="dv">1</span>      <span class="fl">95.00</span>      <span class="fl">96.30</span>          <span class="fl">95.00</span>   </span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>              <span class="op">%</span>               <span class="dv">1</span>      <span class="fl">95.00</span>      <span class="fl">96.80</span>          <span class="fl">95.00</span>   </span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>              <span class="op">%</span>               <span class="dv">1</span>      <span class="fl">95.00</span>      <span class="fl">96.60</span>          <span class="fl">95.00</span>   </span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>  MONTHLY_ACTUAL  </span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>          <span class="fl">96.90</span>  </span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>          <span class="fl">95.00</span>  </span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>          <span class="fl">96.90</span>  </span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>          <span class="fl">98.30</span>  </span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>          <span class="fl">95.80</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For more complex XML documents, refer to the docstring for <code>pandas.read_xml</code> which describes how to do selections and filters to extract a particular table of interest.</p>
</section>
</section>
</section>
<section id="io_binary" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="io_binary"><span class="header-section-number">6.2</span> Binary Data Formats</h2>
<p>One simple way to store (or <em>serialize</em>) data in binary format is using Python’s built-in <code>pickle</code> module. pandas objects all have a <code>to_pickle</code> method that writes the data to disk in pickle format:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">95</span>]: frame <span class="op">=</span> pd.read_csv(<span class="st">"examples/ex1.csv"</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">96</span>]: frame</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">96</span>]: </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>   a   b   c   d message</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="dv">1</span>   <span class="dv">2</span>   <span class="dv">3</span>   <span class="dv">4</span>   hello</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">5</span>   <span class="dv">6</span>   <span class="dv">7</span>   <span class="dv">8</span>   world</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">9</span>  <span class="dv">10</span>  <span class="dv">11</span>  <span class="dv">12</span>     foo</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">97</span>]: frame.to_pickle(<span class="st">"examples/frame_pickle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Pickle files are in general readable only in Python. You can read any "pickled" object stored in a file by using the built-in <code>pickle</code> directly, or even more conveniently using <code>pandas.read_pickle</code>:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">98</span>]: pd.read_pickle(<span class="st">"examples/frame_pickle"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">98</span>]: </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>   a   b   c   d message</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="dv">1</span>   <span class="dv">2</span>   <span class="dv">3</span>   <span class="dv">4</span>   hello</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">5</span>   <span class="dv">6</span>   <span class="dv">7</span>   <span class="dv">8</span>   world</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">9</span>  <span class="dv">10</span>  <span class="dv">11</span>  <span class="dv">12</span>     foo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>pickle</code> is recommended only as a short-term storage format. The problem is that it is hard to guarantee that the format will be stable over time; an object pickled today may not unpickle with a later version of a library. pandas has tried to maintain backward compatibility when possible, but at some point in the future it may be necessary to “break” the pickle format.</p>
</div>
</div>
<p>pandas has built-in support for several other open source binary data formats, such as HDF5, ORC, and Apache Parquet. For example, if you install the <code>pyarrow</code> package (<code>conda install pyarrow</code>), then you can read Parquet files with <code>pandas.read_parquet</code>:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">100</span>]: fec <span class="op">=</span> pd.read_parquet(<span class="st">'datasets/fec/fec.parquet'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>I will give some HDF5 examples in <a href="#io_hdf5">Using HDF5 Format</a>. I encourage you to explore different file formats to see how fast they are and how well they work for your analysis.</p>
<section id="pandas_excel_files" class="level3">
<h3 class="anchored" data-anchor-id="pandas_excel_files">Reading Microsoft Excel Files</h3>
<p>pandas also supports reading tabular data stored in Excel 2003 (and higher) files using either the <code>pandas.ExcelFile</code> class or <code>pandas.read_excel</code> function. Internally, these tools use the add-on packages <code>xlrd</code> and <code>openpyxl</code> to read old-style XLS and newer XLSX files, respectively. These must be installed separately from pandas using pip or conda:</p>
<pre><code>conda install openpyxl xlrd</code></pre>
<p>To use <code>pandas.ExcelFile</code>, create an instance by passing a path to an <code>xls</code> or <code>xlsx</code> file:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">101</span>]: xlsx <span class="op">=</span> pd.ExcelFile(<span class="st">"examples/ex1.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This object can show you the list of available sheet names in the file:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">102</span>]: xlsx.sheet_names</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">102</span>]: [<span class="st">'Sheet1'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Data stored in a sheet can then be read into DataFrame with <code>parse</code>:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">103</span>]: xlsx.parse(sheet_name<span class="op">=</span><span class="st">"Sheet1"</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">103</span>]: </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>   Unnamed: <span class="dv">0</span>  a   b   c   d message</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>           <span class="dv">0</span>  <span class="dv">1</span>   <span class="dv">2</span>   <span class="dv">3</span>   <span class="dv">4</span>   hello</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>           <span class="dv">1</span>  <span class="dv">5</span>   <span class="dv">6</span>   <span class="dv">7</span>   <span class="dv">8</span>   world</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>           <span class="dv">2</span>  <span class="dv">9</span>  <span class="dv">10</span>  <span class="dv">11</span>  <span class="dv">12</span>     foo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This Excel table has an index column, so we can indicate that with the <code>index_col</code> argument:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">104</span>]: xlsx.parse(sheet_name<span class="op">=</span><span class="st">"Sheet1"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">104</span>]: </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>   a   b   c   d message</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="dv">1</span>   <span class="dv">2</span>   <span class="dv">3</span>   <span class="dv">4</span>   hello</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">5</span>   <span class="dv">6</span>   <span class="dv">7</span>   <span class="dv">8</span>   world</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">9</span>  <span class="dv">10</span>  <span class="dv">11</span>  <span class="dv">12</span>     foo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you are reading multiple sheets in a file, then it is faster to create the <code>pandas.ExcelFile</code>, but you can also simply pass the filename to <code>pandas.read_excel</code>:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">105</span>]: frame <span class="op">=</span> pd.read_excel(<span class="st">"examples/ex1.xlsx"</span>, sheet_name<span class="op">=</span><span class="st">"Sheet1"</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">106</span>]: frame</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">106</span>]: </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>   Unnamed: <span class="dv">0</span>  a   b   c   d message</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>           <span class="dv">0</span>  <span class="dv">1</span>   <span class="dv">2</span>   <span class="dv">3</span>   <span class="dv">4</span>   hello</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>           <span class="dv">1</span>  <span class="dv">5</span>   <span class="dv">6</span>   <span class="dv">7</span>   <span class="dv">8</span>   world</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>           <span class="dv">2</span>  <span class="dv">9</span>  <span class="dv">10</span>  <span class="dv">11</span>  <span class="dv">12</span>     foo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To write pandas data to Excel format, you must first create an <code>ExcelWriter</code>, then write data to it using the pandas object's <code>to_excel</code> method:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">107</span>]: writer <span class="op">=</span> pd.ExcelWriter(<span class="st">"examples/ex2.xlsx"</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">108</span>]: frame.to_excel(writer, <span class="st">"Sheet1"</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">109</span>]: writer.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can also pass a file path to <code>to_excel</code> and avoid the <code>ExcelWriter</code>:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">110</span>]: frame.to_excel(<span class="st">"examples/ex2.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="io_hdf5" class="level3">
<h3 class="anchored" data-anchor-id="io_hdf5">Using HDF5 Format</h3>
<p>HDF5 is a respected file format intended for storing large quantities of scientific array data. It is available as a C library, and it has interfaces available in many other languages, including Java, Julia, MATLAB, and Python. The “HDF” in HDF5 stands for <em>hierarchical data format</em>. Each HDF5 file can store multiple datasets and supporting metadata. Compared with simpler formats, HDF5 supports on-the-fly compression with a variety of compression modes, enabling data with repeated patterns to be stored more efficiently. HDF5 can be a good choice for working with datasets that don't fit into memory, as you can efficiently read and write small sections of much larger arrays.</p>
<p>To get started with HDF5 and pandas, you must first install PyTables by installing the <code>tables</code> package with conda:</p>
<pre><code>conda install pytables</code></pre>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that the PyTables package is called "tables" in PyPI, so if you install with pip you will have to run <code>pip install tables</code>.</p>
</div>
</div>
<p>While it's possible to directly access HDF5 files using either the PyTables or h5py libraries, pandas provides a high-level interface that simplifies storing Series and DataFrame objects. The <code>HDFStore</code> class works like a dictionary and handles the low-level details:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">113</span>]: frame <span class="op">=</span> pd.DataFrame({<span class="st">"a"</span>: np.random.standard_normal(<span class="dv">100</span>)})</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">114</span>]: store <span class="op">=</span> pd.HDFStore(<span class="st">"examples/mydata.h5"</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">115</span>]: store[<span class="st">"obj1"</span>] <span class="op">=</span> frame</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">116</span>]: store[<span class="st">"obj1_col"</span>] <span class="op">=</span> frame[<span class="st">"a"</span>]</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">117</span>]: store</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">117</span>]: </span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span><span class="kw">class</span> <span class="st">'pandas.io.pytables.HDFStore'</span><span class="op">&gt;</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>File path: examples<span class="op">/</span>mydata.h5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Objects contained in the HDF5 file can then be retrieved with the same dictionary-like API:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">118</span>]: store[<span class="st">"obj1"</span>]</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">118</span>]: </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>           a</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="op">-</span><span class="fl">0.204708</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   <span class="fl">0.478943</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="op">-</span><span class="fl">0.519439</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="op">-</span><span class="fl">0.555730</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>   <span class="fl">1.965781</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>..       ...</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="dv">95</span>  <span class="fl">0.795253</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="dv">96</span>  <span class="fl">0.118110</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="dv">97</span> <span class="op">-</span><span class="fl">0.748532</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a><span class="dv">98</span>  <span class="fl">0.584970</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a><span class="dv">99</span>  <span class="fl">0.152677</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>[<span class="dv">100</span> rows x <span class="dv">1</span> columns]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>HDFStore</code> supports two storage schemas, <code>"fixed"</code> and <code>"table"</code> (the default is <code>"fixed"</code>). The latter is generally slower, but it supports query operations using a special syntax:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">119</span>]: store.put(<span class="st">"obj2"</span>, frame, <span class="bu">format</span><span class="op">=</span><span class="st">"table"</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">120</span>]: store.select(<span class="st">"obj2"</span>, where<span class="op">=</span>[<span class="st">"index &gt;= 10 and index &lt;= 15"</span>])</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">120</span>]: </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>           a</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>  <span class="fl">1.007189</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> <span class="op">-</span><span class="fl">1.296221</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>  <span class="fl">0.274992</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>  <span class="fl">0.228913</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span>  <span class="fl">1.352917</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span>  <span class="fl">0.886429</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">121</span>]: store.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>put</code> is an explicit version of the <code>store["obj2"] = frame</code> method but allows us to set other options like the storage format.</p>
<p>The <code>pandas.read_hdf</code> function gives you a shortcut to these tools:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">122</span>]: frame.to_hdf(<span class="st">"examples/mydata.h5"</span>, <span class="st">"obj3"</span>, <span class="bu">format</span><span class="op">=</span><span class="st">"table"</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">123</span>]: pd.read_hdf(<span class="st">"examples/mydata.h5"</span>, <span class="st">"obj3"</span>, where<span class="op">=</span>[<span class="st">"index &lt; 5"</span>])</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">123</span>]: </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>          a</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="op">-</span><span class="fl">0.204708</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="fl">0.478943</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">-</span><span class="fl">0.519439</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-</span><span class="fl">0.555730</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="fl">1.965781</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you'd like, you can delete the HDF5 file you created, like so:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">124</span>]: <span class="im">import</span> os</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">125</span>]: os.remove(<span class="st">"examples/mydata.h5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you are processing data that is stored on remote servers, like Amazon S3 or HDFS, using a different binary format designed for distributed storage like <a href="http://parquet.apache.org">Apache Parquet</a> may be more suitable.</p>
</div>
</div>
<p>If you work with large quantities of data locally, I would encourage you to explore PyTables and h5py to see how they can suit your needs. Since many data analysis problems are I/O-bound (rather than CPU-bound), using a tool like HDF5 can massively accelerate your applications.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>HDF5 is <em>not</em> a database. It is best suited for write-once, read-many datasets. While data can be added to a file at any time, if multiple writers do so simultaneously, the file can become corrupted.</p>
</div>
</div>
</section>
</section>
<section id="io_web_apis" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="io_web_apis"><span class="header-section-number">6.3</span> Interacting with Web APIs</h2>
<p>Many websites have public APIs providing data feeds via JSON or some other format. There are a number of ways to access these APIs from Python; one method that I recommend is the <a href="http://docs.python-requests.org"><code>requests</code> package</a>, which can be installed with pip or conda:</p>
<pre><code>conda install requests</code></pre>
<p>To find the last 30 GitHub issues for pandas on GitHub, we can make a <code>GET</code> HTTP request using the add-on <code>requests</code> library:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">126</span>]: <span class="im">import</span> requests</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">127</span>]: url <span class="op">=</span> <span class="st">"https://api.github.com/repos/pandas-dev/pandas/issues"</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">128</span>]: resp <span class="op">=</span> requests.get(url)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">129</span>]: resp.raise_for_status()</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">130</span>]: resp</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">130</span>]: <span class="op">&lt;</span>Response [<span class="dv">200</span>]<span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>It's a good practice to always call <code>raise_for_status</code> after using <code>requests.get</code> to check for HTTP errors.</p>
<p>The response object’s <code>json</code> method will return a Python object containing the parsed JSON data as a dictionary or list (depending on what JSON is returned):</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">131</span>]: data <span class="op">=</span> resp.json()</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">132</span>]: data[<span class="dv">0</span>][<span class="st">"title"</span>]</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">132</span>]: <span class="st">'BUG: DataFrame.pivot mutates empty index.name attribute with typing._L</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="er">iteralGenericAlias'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Since the results retrieved are based on real-time data, what you see when you run this code will almost definitely be different.</p>
<p>Each element in <code>data</code> is a dictionary containing all of the data found on a GitHub issue page (except for the comments). We can pass <code>data</code> directly to <code>pandas.DataFrame</code> and extract fields of interest:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">133</span>]: issues <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">"number"</span>, <span class="st">"title"</span>,</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>   .....:                                      <span class="st">"labels"</span>, <span class="st">"state"</span>])</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">134</span>]: issues</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">134</span>]: </span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    number   </span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>    <span class="dv">52629</span>  <span class="op">\</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>    <span class="dv">52628</span>   </span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>    <span class="dv">52626</span>   </span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>    <span class="dv">52625</span>   </span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>    <span class="dv">52624</span>   </span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>..     ...   </span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="dv">25</span>   <span class="dv">52579</span>   </span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="dv">26</span>   <span class="dv">52577</span>   </span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="dv">27</span>   <span class="dv">52576</span>   </span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="dv">28</span>   <span class="dv">52571</span>   </span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a><span class="dv">29</span>   <span class="dv">52570</span>   </span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>                                                                         title   </span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>   BUG: DataFrame.pivot mutates empty index.name attribute <span class="cf">with</span> typing._Li...  <span class="op">\</span></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>                                 DEPR: unused keywords <span class="kw">in</span> DTI<span class="op">/</span>TDI construtors   </span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>                         ENH: Infer best datetime <span class="bu">format</span> <span class="im">from</span> a random sample   </span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>            BUG: ArrowExtensionArray logical_op <span class="kw">not</span> working <span class="kw">in</span> <span class="bu">all</span> directions   </span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>              ENH: pandas.core.groupby.SeriesGroupBy.<span class="bu">apply</span> allow raw argument   </span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>..                                                                         ...   </span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a><span class="dv">25</span>                                     BUG: Axial inconsistency of pandas.diff   </span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a><span class="dv">26</span>                  BUG: describe <span class="kw">not</span> respecting ArrowDtype <span class="kw">in</span> include<span class="op">/</span>exclude   </span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a><span class="dv">27</span>                  BUG: describe does <span class="kw">not</span> distinguish between Int64 <span class="kw">and</span> int64   </span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a><span class="dv">28</span>  BUG: `pandas.DataFrame.replace` silently fails to replace category <span class="bu">type</span>...   </span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a><span class="dv">29</span>     BUG: DataFrame.describe include<span class="op">/</span>exclude do <span class="kw">not</span> work <span class="cf">for</span> arrow datatypes   </span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>                                                                        labels   </span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>   [{<span class="st">'id'</span>: <span class="dv">76811</span>, <span class="st">'node_id'</span>: <span class="st">'MDU6TGFiZWw3NjgxMQ=='</span>, <span class="st">'url'</span>: <span class="st">'https://api.g...  </span><span class="ch">\</span></span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a><span class="st">1                                                                           []   </span></span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a><span class="er">2                                                                           </span>[]   </span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   [{<span class="st">'id'</span>: <span class="dv">76811</span>, <span class="st">'node_id'</span>: <span class="st">'MDU6TGFiZWw3NjgxMQ=='</span>, <span class="st">'url'</span>: <span class="st">'https://api.g...   </span></span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a><span class="er">4   </span>[{<span class="st">'id'</span>: <span class="dv">76812</span>, <span class="st">'node_id'</span>: <span class="st">'MDU6TGFiZWw3NjgxMg=='</span>, <span class="st">'url'</span>: <span class="st">'https://api.g...   </span></span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a><span class="er">..                                                                         ...   </span></span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a><span class="dv">25</span>  [{<span class="st">'id'</span>: <span class="dv">76811</span>, <span class="st">'node_id'</span>: <span class="st">'MDU6TGFiZWw3NjgxMQ=='</span>, <span class="st">'url'</span>: <span class="st">'https://api.g...   </span></span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a><span class="er">26  </span>[{<span class="st">'id'</span>: <span class="dv">3303158446</span>, <span class="st">'node_id'</span>: <span class="st">'MDU6TGFiZWwzMzAzMTU4NDQ2'</span>, <span class="st">'url'</span>: <span class="st">'http...   </span></span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a><span class="er">27  </span>[{<span class="st">'id'</span>: <span class="dv">76811</span>, <span class="st">'node_id'</span>: <span class="st">'MDU6TGFiZWw3NjgxMQ=='</span>, <span class="st">'url'</span>: <span class="st">'https://api.g...   </span></span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a><span class="er">28  </span>[{<span class="st">'id'</span>: <span class="dv">76811</span>, <span class="st">'node_id'</span>: <span class="st">'MDU6TGFiZWw3NjgxMQ=='</span>, <span class="st">'url'</span>: <span class="st">'https://api.g...   </span></span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a><span class="er">29  </span>[{<span class="st">'id'</span>: <span class="dv">76811</span>, <span class="st">'node_id'</span>: <span class="st">'MDU6TGFiZWw3NjgxMQ=='</span>, <span class="st">'url'</span>: <span class="st">'https://api.g...   </span></span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a><span class="er">   state  </span></span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>   <span class="bu">open</span>  </span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   <span class="bu">open</span>  </span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   <span class="bu">open</span>  </span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   <span class="bu">open</span>  </span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>   <span class="bu">open</span>  </span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a>..   ...  </span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a><span class="dv">25</span>  <span class="bu">open</span>  </span>
<span id="cb72-50"><a href="#cb72-50" aria-hidden="true" tabindex="-1"></a><span class="dv">26</span>  <span class="bu">open</span>  </span>
<span id="cb72-51"><a href="#cb72-51" aria-hidden="true" tabindex="-1"></a><span class="dv">27</span>  <span class="bu">open</span>  </span>
<span id="cb72-52"><a href="#cb72-52" aria-hidden="true" tabindex="-1"></a><span class="dv">28</span>  <span class="bu">open</span>  </span>
<span id="cb72-53"><a href="#cb72-53" aria-hidden="true" tabindex="-1"></a><span class="dv">29</span>  <span class="bu">open</span>  </span>
<span id="cb72-54"><a href="#cb72-54" aria-hidden="true" tabindex="-1"></a>[<span class="dv">30</span> rows x <span class="dv">4</span> columns]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>With a bit of elbow grease, you can create some higher-level interfaces to common web APIs that return DataFrame objects for more convenient analysis.</p>
</section>
<section id="io_databases" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="io_databases"><span class="header-section-number">6.4</span> Interacting with Databases</h2>
<p>In a business setting, a lot of data may not be stored in text or Excel files. SQL-based relational databases (such as SQL Server, PostgreSQL, and MySQL) are in wide use, and many alternative databases have become quite popular. The choice of database is usually dependent on the performance, data integrity, and scalability needs of an application.</p>
<p>pandas has some functions to simplify loading the results of a SQL query into a DataFrame. As an example, I’ll create a SQLite3 database using Python’s built-in <code>sqlite3</code> driver:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">135</span>]: <span class="im">import</span> sqlite3</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">136</span>]: query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="st">   .....: CREATE TABLE test</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="st">   .....: (a VARCHAR(20), b VARCHAR(20),</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="st">   .....:  c REAL,        d INTEGER</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="st">   .....: );"""</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">137</span>]: con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"mydata.sqlite"</span>)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">138</span>]: con.execute(query)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">138</span>]: <span class="op">&lt;</span>sqlite3.Cursor at <span class="bn">0x188e40ac0</span><span class="op">&gt;</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">139</span>]: con.commit()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then, insert a few rows of data:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">140</span>]: data <span class="op">=</span> [(<span class="st">"Atlanta"</span>, <span class="st">"Georgia"</span>, <span class="fl">1.25</span>, <span class="dv">6</span>),</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>   .....:         (<span class="st">"Tallahassee"</span>, <span class="st">"Florida"</span>, <span class="fl">2.6</span>, <span class="dv">3</span>),</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>   .....:         (<span class="st">"Sacramento"</span>, <span class="st">"California"</span>, <span class="fl">1.7</span>, <span class="dv">5</span>)]</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">141</span>]: stmt <span class="op">=</span> <span class="st">"INSERT INTO test VALUES(?, ?, ?, ?)"</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">142</span>]: con.executemany(stmt, data)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">142</span>]: <span class="op">&lt;</span>sqlite3.Cursor at <span class="bn">0x188ed02c0</span><span class="op">&gt;</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">143</span>]: con.commit()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Most Python SQL drivers return a list of tuples when selecting data from a table:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">144</span>]: cursor <span class="op">=</span> con.execute(<span class="st">"SELECT * FROM test"</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">145</span>]: rows <span class="op">=</span> cursor.fetchall()</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">146</span>]: rows</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">146</span>]: </span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>[(<span class="st">'Atlanta'</span>, <span class="st">'Georgia'</span>, <span class="fl">1.25</span>, <span class="dv">6</span>),</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a> (<span class="st">'Tallahassee'</span>, <span class="st">'Florida'</span>, <span class="fl">2.6</span>, <span class="dv">3</span>),</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a> (<span class="st">'Sacramento'</span>, <span class="st">'California'</span>, <span class="fl">1.7</span>, <span class="dv">5</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can pass the list of tuples to the DataFrame constructor, but you also need the column names, contained in the cursor’s <code>description</code> attribute. Note that for SQLite3, the cursor <code>description</code> only provides column names (the other fields, which are part of Python's Database API specification, are <code>None</code>), but for some other database drivers, more column information is provided:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">147</span>]: cursor.description</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">147</span>]: </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>((<span class="st">'a'</span>, <span class="va">None</span>, <span class="va">None</span>, <span class="va">None</span>, <span class="va">None</span>, <span class="va">None</span>, <span class="va">None</span>),</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a> (<span class="st">'b'</span>, <span class="va">None</span>, <span class="va">None</span>, <span class="va">None</span>, <span class="va">None</span>, <span class="va">None</span>, <span class="va">None</span>),</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a> (<span class="st">'c'</span>, <span class="va">None</span>, <span class="va">None</span>, <span class="va">None</span>, <span class="va">None</span>, <span class="va">None</span>, <span class="va">None</span>),</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a> (<span class="st">'d'</span>, <span class="va">None</span>, <span class="va">None</span>, <span class="va">None</span>, <span class="va">None</span>, <span class="va">None</span>, <span class="va">None</span>))</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">148</span>]: pd.DataFrame(rows, columns<span class="op">=</span>[x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> cursor.description])</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">148</span>]: </span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>             a           b     c  d</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>      Atlanta     Georgia  <span class="fl">1.25</span>  <span class="dv">6</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  Tallahassee     Florida  <span class="fl">2.60</span>  <span class="dv">3</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   Sacramento  California  <span class="fl">1.70</span>  <span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This is quite a bit of munging that you’d rather not repeat each time you query the database. The <a href="http://www.sqlalchemy.org/">SQLAlchemy project</a> is a popular Python SQL toolkit that abstracts away many of the common differences between SQL databases. pandas has a <code>read_sql</code> function that enables you to read data easily from a general SQLAlchemy connection. You can install SQLAlchemy with conda like so:</p>
<pre><code>conda install sqlalchemy</code></pre>
<p>Now, we'll connect to the same SQLite database with SQLAlchemy and read data from the table created before:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">149</span>]: <span class="im">import</span> sqlalchemy <span class="im">as</span> sqla</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">150</span>]: db <span class="op">=</span> sqla.create_engine(<span class="st">"sqlite:///mydata.sqlite"</span>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">151</span>]: pd.read_sql(<span class="st">"SELECT * FROM test"</span>, db)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">151</span>]: </span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>             a           b     c  d</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>      Atlanta     Georgia  <span class="fl">1.25</span>  <span class="dv">6</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  Tallahassee     Florida  <span class="fl">2.60</span>  <span class="dv">3</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   Sacramento  California  <span class="fl">1.70</span>  <span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="io_wrapping_up" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="io_wrapping_up"><span class="header-section-number">6.5</span> Conclusion</h2>
<p>Getting access to data is frequently the first step in the data analysis process. We have looked at a number of useful tools in this chapter that should help you get started. In the upcoming chapters we will dig deeper into data wrangling, data visualization, time series analysis, and other topics.</p>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>For the full list, see <a href="https://www.fdic.gov/bank/individual/failed/banklist.html" class="uri">https://www.fdic.gov/bank/individual/failed/banklist.html</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

<script async="" defer="" src="https://scripts.simpleanalyticscdn.com/latest.js"></script></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a class='pagination-link' href='/book/pandas-basics'>
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Getting Started with pandas</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a class='pagination-link' href='/book/data-cleaning'>
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Cleaning and Preparation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2023, Wes McKinney. All Rights Reserved.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/wesmckinn">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script async="" src="https://media.ethicalads.io/media/client/ethicalads.min.js"></script>



</body></html>