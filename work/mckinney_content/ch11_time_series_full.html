<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Python for Data Analysis, 3E - 11&nbsp; Time Series</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./modeling.html" rel="next">
<link href="./data-aggregation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Python for Data Analysis, 3E - 11&nbsp; Time Series">
<meta property="og:description" content="">
<meta property="og:image" content="images/cover.png">
<meta property="og:site-name" content="Python for Data Analysis, 3E">
<meta name="twitter:title" content="Python for Data Analysis, 3E - 11&nbsp; Time Series">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="images/cover.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class='navbar-brand' href='/book/'>
    <span class="navbar-title">Python for Data Analysis, 3E</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class='nav-link' href='https://wesmckinney.com/archives' rel target>
 <span class="menu-text">Wes’s Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/wesmckinn" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">    
        <li>
    <a class="dropdown-item" href="https://github.com/wesm/pydata-book" rel="" target="">
 <span class="dropdown-text">Data and Notebooks (GitHub)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://gitee.com/wesmckinn/pydata-book" rel="" target="">
 <span class="dropdown-text">Data and Notebooks (Gitee)</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href='/book/preface'>Chapters</a></li><li class="breadcrumb-item"><a href='/book/time-series'><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Time Series</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/'>
 <span class="menu-text">About the Open Edition</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Chapters</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/preface'>
 <span class="menu-text">Preface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/preliminaries'>
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preliminaries</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/python-basics'>
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Python Language Basics, IPython, and Jupyter Notebooks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/python-builtin'>
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Built-In Data Structures, Functions, and Files</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/numpy-basics'>
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">NumPy Basics: Arrays and Vectorized Computation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/pandas-basics'>
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Getting Started with pandas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/accessing-data'>
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Loading, Storage, and File Formats</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/data-cleaning'>
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data Cleaning and Preparation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/data-wrangling'>
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data Wrangling: Join, Combine, and Reshape</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/plotting-and-visualization'>
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Plotting and Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/data-aggregation'>
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Aggregation and Group Operations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link active' href='/book/time-series'>
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Time Series</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/modeling'>
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Modeling Libraries in Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/data-analysis-examples'>
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Analysis Examples</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/advanced-numpy'>
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Advanced NumPy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a class='sidebar-item-text sidebar-link' href='/book/ipython'>
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">More on the IPython System</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<a href="https://amzn.to/3DyLaJc"><img src="images/cover.png" class="img-fluid"></a>
<div data-ea-publisher="wesmckinneycom" data-ea-type="image">

</div>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#tseries_python_builtin" id="toc-tseries_python_builtin" class="nav-link active" data-scroll-target="#tseries_python_builtin"><span class="header-section-number">11.1</span> Date and Time Data Types and Tools</a>
  <ul class="collapse">
  <li><a href="#tseries_dateutil" id="toc-tseries_dateutil" class="nav-link" data-scroll-target="#tseries_dateutil">Converting Between String and Datetime</a></li>
  </ul></li>
  <li><a href="#tseries_basics" id="toc-tseries_basics" class="nav-link" data-scroll-target="#tseries_basics"><span class="header-section-number">11.2</span> Time Series Basics</a>
  <ul class="collapse">
  <li><a href="#tseries_indexing_selection" id="toc-tseries_indexing_selection" class="nav-link" data-scroll-target="#tseries_indexing_selection">Indexing, Selection, Subsetting</a></li>
  <li><a href="#tseries_nonunique" id="toc-tseries_nonunique" class="nav-link" data-scroll-target="#tseries_nonunique">Time Series with Duplicate Indices</a></li>
  </ul></li>
  <li><a href="#tseries_frequency" id="toc-tseries_frequency" class="nav-link" data-scroll-target="#tseries_frequency"><span class="header-section-number">11.3</span> Date Ranges, Frequencies, and Shifting</a>
  <ul class="collapse">
  <li><a href="#tseries_fixed_date_range" id="toc-tseries_fixed_date_range" class="nav-link" data-scroll-target="#tseries_fixed_date_range">Generating Date Ranges</a></li>
  <li><a href="#tseries_frequencies" id="toc-tseries_frequencies" class="nav-link" data-scroll-target="#tseries_frequencies">Frequencies and Date Offsets</a></li>
  <li><a href="#tseries_shifting" id="toc-tseries_shifting" class="nav-link" data-scroll-target="#tseries_shifting">Shifting (Leading and Lagging) Data</a></li>
  </ul></li>
  <li><a href="#tseries_time_zones" id="toc-tseries_time_zones" class="nav-link" data-scroll-target="#tseries_time_zones"><span class="header-section-number">11.4</span> Time Zone Handling</a>
  <ul class="collapse">
  <li><a href="#tseries_tz_convert" id="toc-tseries_tz_convert" class="nav-link" data-scroll-target="#tseries_tz_convert">Time Zone Localization and Conversion</a></li>
  <li><a href="#tseries_tz_timestamp" id="toc-tseries_tz_timestamp" class="nav-link" data-scroll-target="#tseries_tz_timestamp">Operations with Time Zone-Aware Timestamp Objects</a></li>
  <li><a href="#tseries_tz_align" id="toc-tseries_tz_align" class="nav-link" data-scroll-target="#tseries_tz_align">Operations Between Different Time Zones</a></li>
  </ul></li>
  <li><a href="#tseries_periods" id="toc-tseries_periods" class="nav-link" data-scroll-target="#tseries_periods"><span class="header-section-number">11.5</span> Periods and Period Arithmetic</a>
  <ul class="collapse">
  <li><a href="#tseries_period_asfreq" id="toc-tseries_period_asfreq" class="nav-link" data-scroll-target="#tseries_period_asfreq">Period Frequency Conversion</a></li>
  <li><a href="#tseries_period_quarterly" id="toc-tseries_period_quarterly" class="nav-link" data-scroll-target="#tseries_period_quarterly">Quarterly Period Frequencies</a></li>
  <li><a href="#tseries_period_stamp_conversion" id="toc-tseries_period_stamp_conversion" class="nav-link" data-scroll-target="#tseries_period_stamp_conversion">Converting Timestamps to Periods (and Back)</a></li>
  <li><a href="#tseries_period_arrays" id="toc-tseries_period_arrays" class="nav-link" data-scroll-target="#tseries_period_arrays">Creating a PeriodIndex from Arrays</a></li>
  </ul></li>
  <li><a href="#tseries_resampling" id="toc-tseries_resampling" class="nav-link" data-scroll-target="#tseries_resampling"><span class="header-section-number">11.6</span> Resampling and Frequency Conversion</a>
  <ul class="collapse">
  <li><a href="#tseries_resample_hi_to_low" id="toc-tseries_resample_hi_to_low" class="nav-link" data-scroll-target="#tseries_resample_hi_to_low">Downsampling</a></li>
  <li><a href="#tseries_resample_lo_to_high" id="toc-tseries_resample_lo_to_high" class="nav-link" data-scroll-target="#tseries_resample_lo_to_high">Upsampling and Interpolation</a></li>
  <li><a href="#tseries_period_resampling" id="toc-tseries_period_resampling" class="nav-link" data-scroll-target="#tseries_period_resampling">Resampling with Periods</a></li>
  <li><a href="#pandas-groupby-timegrouper" id="toc-pandas-groupby-timegrouper" class="nav-link" data-scroll-target="#pandas-groupby-timegrouper">Grouped Time Resampling</a></li>
  </ul></li>
  <li><a href="#tseries_moving_funcs" id="toc-tseries_moving_funcs" class="nav-link" data-scroll-target="#tseries_moving_funcs"><span class="header-section-number">11.7</span> Moving Window Functions</a>
  <ul class="collapse">
  <li><a href="#tseries_moving_expw" id="toc-tseries_moving_expw" class="nav-link" data-scroll-target="#tseries_moving_expw">Exponentially Weighted Functions</a></li>
  <li><a href="#tseries_moving_binary" id="toc-tseries_moving_binary" class="nav-link" data-scroll-target="#tseries_moving_binary">Binary Moving Window Functions</a></li>
  <li><a href="#tseries_moving_custom" id="toc-tseries_moving_custom" class="nav-link" data-scroll-target="#tseries_moving_custom">User-Defined Moving Window Functions</a></li>
  </ul></li>
  <li><a href="#timeseries-conclusion" id="toc-timeseries-conclusion" class="nav-link" data-scroll-target="#timeseries-conclusion"><span class="header-section-number">11.8</span> Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="timeseries" class="quarto-section-identifier"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Time Series</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>This Open Access web version of <em>Python for Data Analysis 3rd Edition</em> is now available as a companion to the <a href="https://amzn.to/3DyLaJc">print and digital editions</a>. If you encounter any errata, <a href="https://oreilly.com/catalog/0636920519829/errata">please report them here</a>. Please note that some aspects of this site as produced by Quarto will differ from the formatting of the print and eBook versions from O’Reilly.</p>
<p>If you find the online edition of the book useful, please consider <a href="https://amzn.to/3DyLaJc">ordering a paper copy</a> or a <a href="https://www.ebooks.com/en-us/book/210644288/python-for-data-analysis/wes-mckinney/?affId=WES398681F">DRM-free eBook</a> to support the author. The content from this website may not be copied or reproduced. The code examples are MIT licensed and can be found on GitHub or Gitee.</p>
</div>
</div>
</div>
<p>Time series data is an important form of structured data in many different fields, such as finance, economics, ecology, neuroscience, and physics. Anything that is recorded repeatedly at many points in time forms a time series. Many time series are <em>fixed frequency</em>, which is to say that data points occur at regular intervals according to some rule, such as every 15 seconds, every 5 minutes, or once per month. Time series can also be <em>irregular</em> without a fixed unit of time or offset between units. How you mark and refer to time series data depends on the application, and you may have one of the following:</p>
<dl>
<dt>Timestamps</dt>
<dd>
<p>Specific instants in time.</p>
</dd>
<dt>Fixed periods</dt>
<dd>
<p>Such as the whole month of January 2017, or the whole year 2020.</p>
</dd>
<dt>Intervals of time</dt>
<dd>
<p>Indicated by a start and end timestamp. Periods can be thought of as special cases of intervals.</p>
</dd>
<dt>Experiment or elapsed time</dt>
<dd>
<p>Each timestamp is a measure of time relative to a particular start time (e.g., the diameter of a cookie baking each second since being placed in the oven), starting from 0.</p>
</dd>
</dl>
<p>In this chapter, I am mainly concerned with time series in the first three categories, though many of the techniques can be applied to experimental time series where the index may be an integer or floating-point number indicating elapsed time from the start of the experiment. The simplest kind of time series is indexed by timestamp.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>pandas also supports indexes based on timedeltas, which can be a useful way of representing experiment or elapsed time. We do not explore timedelta indexes in this book, but you can learn more in the <a href="https://pandas.pydata.org">pandas documentation</a>.</p>
</div>
</div>
<p>pandas provides many built-in time series tools and algorithms. You can efficiently work with large time series, and slice and dice, aggregate, and resample irregular- and fixed-frequency time series. Some of these tools are useful for financial and economics applications, but you could certainly use them to analyze server log data, too.</p>
<p>As with the rest of the chapters, we start by importing NumPy and pandas:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">12</span>]: <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">13</span>]: <span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="tseries_python_builtin" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="tseries_python_builtin"><span class="header-section-number">11.1</span> Date and Time Data Types and Tools</h2>
<p>The Python standard library includes data types for date and time data, as well as calendar-related functionality. The <code>datetime</code>, <code>time</code>, and <code>calendar</code> modules are the main places to start. The <code>datetime.datetime</code> type, or simply <code>datetime</code>, is widely used:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">14</span>]: <span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">15</span>]: now <span class="op">=</span> datetime.now()</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">16</span>]: now</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">16</span>]: datetime.datetime(<span class="dv">2023</span>, <span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">9</span>, <span class="dv">16</span>, <span class="dv">484533</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">17</span>]: now.year, now.month, now.day</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">17</span>]: (<span class="dv">2023</span>, <span class="dv">4</span>, <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>datetime</code> stores both the date and time down to the microsecond. <code>datetime.timedelta</code>, or simply <code>timedelta</code>, represents the temporal difference between two <code>datetime</code> objects:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">18</span>]: delta <span class="op">=</span> datetime(<span class="dv">2011</span>, <span class="dv">1</span>, <span class="dv">7</span>) <span class="op">-</span> datetime(<span class="dv">2008</span>, <span class="dv">6</span>, <span class="dv">24</span>, <span class="dv">8</span>, <span class="dv">15</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">19</span>]: delta</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">19</span>]: datetime.timedelta(days<span class="op">=</span><span class="dv">926</span>, seconds<span class="op">=</span><span class="dv">56700</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">20</span>]: delta.days</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">20</span>]: <span class="dv">926</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">21</span>]: delta.seconds</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">21</span>]: <span class="dv">56700</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can add (or subtract) a <code>timedelta</code> or multiple thereof to a <code>datetime</code> object to yield a new shifted object:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">22</span>]: <span class="im">from</span> datetime <span class="im">import</span> timedelta</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">23</span>]: start <span class="op">=</span> datetime(<span class="dv">2011</span>, <span class="dv">1</span>, <span class="dv">7</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">24</span>]: start <span class="op">+</span> timedelta(<span class="dv">12</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">24</span>]: datetime.datetime(<span class="dv">2011</span>, <span class="dv">1</span>, <span class="dv">19</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">25</span>]: start <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> timedelta(<span class="dv">12</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">25</span>]: datetime.datetime(<span class="dv">2010</span>, <span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><a href="#tbl-table_datetime_module">Table&nbsp;<span>11.1</span></a> summarizes the data types in the <code>datetime</code> module. While this chapter is mainly concerned with the data types in pandas and higher-level time series manipulation, you may encounter the <code>datetime</code>-based types in many other places in Python in the wild.</p>
<div id="tbl-table_datetime_module" class="anchored">
<table class="table">
<caption>Table&nbsp;11.1: Types in the <code>datetime</code> module</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>date</code></td>
<td style="text-align: left;">Store calendar date (year, month, day) using the Gregorian calendar</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>time</code></td>
<td style="text-align: left;">Store time of day as hours, minutes, seconds, and microseconds</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>datetime</code></td>
<td style="text-align: left;">Store both date and time</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>timedelta</code></td>
<td style="text-align: left;">The difference between two <code>datetime</code> values (as days, seconds, and microseconds)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>tzinfo</code></td>
<td style="text-align: left;">Base type for storing time zone information</td>
</tr>
</tbody>
</table>
</div>
<section id="tseries_dateutil" class="level3">
<h3 class="anchored" data-anchor-id="tseries_dateutil">Converting Between String and Datetime</h3>
<p>You can format <code>datetime</code> objects and pandas <code>Timestamp</code> objects, which I’ll introduce later, as strings using <code>str</code> or the <code>strftime</code> method, passing a format specification:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">26</span>]: stamp <span class="op">=</span> datetime(<span class="dv">2011</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">27</span>]: <span class="bu">str</span>(stamp)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">27</span>]: <span class="st">'2011-01-03 00:00:00'</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">28</span>]: stamp.strftime(<span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">28</span>]: <span class="st">'2011-01-03'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>See <a href="#tbl-table_datetime_formatting">Table&nbsp;<span>11.2</span></a> for a complete list of the format codes.</p>
<div id="tbl-table_datetime_formatting" class="anchored">
<table class="table">
<caption>Table&nbsp;11.2: <code>datetime</code> format specification (ISO C89 compatible)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>%Y</code></td>
<td style="text-align: left;">Four-digit year</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%y</code></td>
<td style="text-align: left;">Two-digit year</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%m</code></td>
<td style="text-align: left;">Two-digit month [01, 12]</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%d</code></td>
<td style="text-align: left;">Two-digit day [01, 31]</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%H</code></td>
<td style="text-align: left;">Hour (24-hour clock) [00, 23]</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%I</code></td>
<td style="text-align: left;">Hour (12-hour clock) [01, 12]</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%M</code></td>
<td style="text-align: left;">Two-digit minute [00, 59]</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%S</code></td>
<td style="text-align: left;">Second [00, 61] (seconds 60, 61 account for leap seconds)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%f</code></td>
<td style="text-align: left;">Microsecond as an integer, zero-padded (from 000000 to 999999)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%j</code></td>
<td style="text-align: left;">Day of the year as a zero-padded integer (from 001 to 336)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%w</code></td>
<td style="text-align: left;">Weekday as an integer [0 (Sunday), 6]</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%u</code></td>
<td style="text-align: left;">Weekday as an integer starting from 1, where 1 is Monday.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%U</code></td>
<td style="text-align: left;">Week number of the year [00, 53]; Sunday is considered the first day of the week, and days before the first Sunday of the year are “week 0”</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%W</code></td>
<td style="text-align: left;">Week number of the year [00, 53]; Monday is considered the first day of the week, and days before the first Monday of the year are “week 0”</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%z</code></td>
<td style="text-align: left;">UTC time zone offset as <code>+HHMM</code> or <code>-HHMM</code>; empty if time zone naive</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%Z</code></td>
<td style="text-align: left;">Time zone name as a string, or empty string if no time zone</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%F</code></td>
<td style="text-align: left;">Shortcut for <code>%Y-%m-%d</code> (e.g., <code>2012-4-18</code>)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%D</code></td>
<td style="text-align: left;">Shortcut for <code>%m/%d/%y</code> (e.g., <code>04/18/12</code>)</td>
</tr>
</tbody>
</table>
</div>
<p>You can use many of the same format codes to convert strings to dates using <code>datetime.strptime</code> (but some codes, like <code>%F</code>, cannot be used):</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">29</span>]: value <span class="op">=</span> <span class="st">"2011-01-03"</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">30</span>]: datetime.strptime(value, <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">30</span>]: datetime.datetime(<span class="dv">2011</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">31</span>]: datestrs <span class="op">=</span> [<span class="st">"7/6/2011"</span>, <span class="st">"8/6/2011"</span>]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">32</span>]: [datetime.strptime(x, <span class="st">"%m/</span><span class="sc">%d</span><span class="st">/%Y"</span>) <span class="cf">for</span> x <span class="kw">in</span> datestrs]</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">32</span>]: </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>[datetime.datetime(<span class="dv">2011</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a> datetime.datetime(<span class="dv">2011</span>, <span class="dv">8</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">0</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>datetime.strptime</code> is one way to parse a date with a known format.</p>
<p>pandas is generally oriented toward working with arrays of dates, whether used as an axis index or a column in a DataFrame. The <code>pandas.to_datetime</code> method parses many different kinds of date representations. Standard date formats like ISO 8601 can be parsed quickly:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">33</span>]: datestrs <span class="op">=</span> [<span class="st">"2011-07-06 12:00:00"</span>, <span class="st">"2011-08-06 00:00:00"</span>]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">34</span>]: pd.to_datetime(datestrs)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">34</span>]: DatetimeIndex([<span class="st">'2011-07-06 12:00:00'</span>, <span class="st">'2011-08-06 00:00:00'</span>], dtype<span class="op">=</span><span class="st">'dat</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="er">etime64</span>[ns]<span class="st">', freq=None)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>It also handles values that should be considered missing (<code>None</code>, empty string, etc.):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">35</span>]: idx <span class="op">=</span> pd.to_datetime(datestrs <span class="op">+</span> [<span class="va">None</span>])</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">36</span>]: idx</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">36</span>]: DatetimeIndex([<span class="st">'2011-07-06 12:00:00'</span>, <span class="st">'2011-08-06 00:00:00'</span>, <span class="st">'NaT'</span>], dty</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>pe<span class="op">=</span><span class="st">'datetime64[ns]'</span>, freq<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">37</span>]: idx[<span class="dv">2</span>]</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">37</span>]: NaT</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">38</span>]: pd.isna(idx)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">38</span>]: array([<span class="va">False</span>, <span class="va">False</span>,  <span class="va">True</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>NaT</code> (Not a Time) is pandas’s null value for timestamp data.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>dateutil.parser</code> is a useful but imperfect tool. Notably, it will recognize some strings as dates that you might prefer that it didn’t; for example, <code>"42"</code> will be parsed as the year <code>2042</code> with today’s calendar date.</p>
</div>
</div>
<p><code>datetime</code> objects also have a number of locale-specific formatting options for systems in other countries or languages. For example, the abbreviated month names will be different on German or French systems compared with English systems. See <a href="#tbl-table_datetime_formatting_locale">Table&nbsp;<span>11.3</span></a> for a listing.</p>
<div id="tbl-table_datetime_formatting_locale" class="anchored">
<table class="table">
<caption>Table&nbsp;11.3: Locale-specific date formatting</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>%a</code></td>
<td style="text-align: left;">Abbreviated weekday name</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%A</code></td>
<td style="text-align: left;">Full weekday name</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%b</code></td>
<td style="text-align: left;">Abbreviated month name</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%B</code></td>
<td style="text-align: left;">Full month name</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%c</code></td>
<td style="text-align: left;">Full date and time (e.g., ‘Tue 01 May 2012 04:20:57 PM’)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%p</code></td>
<td style="text-align: left;">Locale equivalent of AM or PM</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%x</code></td>
<td style="text-align: left;">Locale-appropriate formatted date (e.g., in the United States, May 1, 2012 yields ‘05/01/2012’)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%X</code></td>
<td style="text-align: left;">Locale-appropriate time (e.g., ‘04:24:12 PM’)</td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="tseries_basics" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="tseries_basics"><span class="header-section-number">11.2</span> Time Series Basics</h2>
<p>A basic kind of time series object in pandas is a Series indexed by timestamps, which is often represented outside of pandas as Python strings or <code>datetime</code> objects:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">39</span>]: dates <span class="op">=</span> [datetime(<span class="dv">2011</span>, <span class="dv">1</span>, <span class="dv">2</span>), datetime(<span class="dv">2011</span>, <span class="dv">1</span>, <span class="dv">5</span>),</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>   ....:          datetime(<span class="dv">2011</span>, <span class="dv">1</span>, <span class="dv">7</span>), datetime(<span class="dv">2011</span>, <span class="dv">1</span>, <span class="dv">8</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>   ....:          datetime(<span class="dv">2011</span>, <span class="dv">1</span>, <span class="dv">10</span>), datetime(<span class="dv">2011</span>, <span class="dv">1</span>, <span class="dv">12</span>)]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">40</span>]: ts <span class="op">=</span> pd.Series(np.random.standard_normal(<span class="dv">6</span>), index<span class="op">=</span>dates)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">41</span>]: ts</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">41</span>]: </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>   <span class="op">-</span><span class="fl">0.204708</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span>    <span class="fl">0.478943</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">7</span>   <span class="op">-</span><span class="fl">0.519439</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">8</span>   <span class="op">-</span><span class="fl">0.555730</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">10</span>    <span class="fl">1.965781</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">12</span>    <span class="fl">1.393406</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Under the hood, these <code>datetime</code> objects have been put in a <code>DatetimeIndex</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">42</span>]: ts.index</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">42</span>]: </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>DatetimeIndex([<span class="st">'2011-01-02'</span>, <span class="st">'2011-01-05'</span>, <span class="st">'2011-01-07'</span>, <span class="st">'2011-01-08'</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2011-01-10'</span>, <span class="st">'2011-01-12'</span>],</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>              dtype<span class="op">=</span><span class="st">'datetime64[ns]'</span>, freq<span class="op">=</span><span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Like other Series, arithmetic operations between differently indexed time series automatically align on the dates:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">43</span>]: ts <span class="op">+</span> ts[::<span class="dv">2</span>]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">43</span>]: </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>   <span class="op">-</span><span class="fl">0.409415</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span>         NaN</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">7</span>   <span class="op">-</span><span class="fl">1.038877</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">8</span>         NaN</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">10</span>    <span class="fl">3.931561</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">12</span>         NaN</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Recall that <code>ts[::2]</code> selects every second element in <code>ts</code>.</p>
<p>pandas stores timestamps using NumPy’s <code>datetime64</code> data type at the nanosecond resolution:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">44</span>]: ts.index.dtype</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">44</span>]: dtype(<span class="st">'&lt;M8[ns]'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Scalar values from a <code>DatetimeIndex</code> are pandas <code>Timestamp</code> objects:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">45</span>]: stamp <span class="op">=</span> ts.index[<span class="dv">0</span>]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">46</span>]: stamp</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">46</span>]: Timestamp(<span class="st">'2011-01-02 00:00:00'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A <code>pandas.Timestamp</code> can be substituted most places where you would use a <code>datetime</code> object. The reverse is not true, however, because <code>pandas.Timestamp</code> can store nanosecond precision data, while <code>datetime</code> stores only up to microseconds. Additionally, <code>pandas.Timestamp</code> can store frequency information (if any) and understands how to do time zone conversions and other kinds of manipulations. More on both of these things later in <a href="#tseries_time_zones">Time Zone Handling</a>.</p>
<section id="tseries_indexing_selection" class="level3">
<h3 class="anchored" data-anchor-id="tseries_indexing_selection">Indexing, Selection, Subsetting</h3>
<p>Time series behaves like any other Series when you are indexing and selecting data based on the label:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">47</span>]: stamp <span class="op">=</span> ts.index[<span class="dv">2</span>]</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">48</span>]: ts[stamp]</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">48</span>]: <span class="op">-</span><span class="fl">0.5194387150567381</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>As a convenience, you can also pass a string that is interpretable as a date:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">49</span>]: ts[<span class="st">"2011-01-10"</span>]</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">49</span>]: <span class="fl">1.9657805725027142</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For longer time series, a year or only a year and month can be passed to easily select slices of data (<code>pandas.date_range</code> is discussed in more detail in <a href="#tseries_fixed_date_range">Generating Date Ranges</a>):</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">50</span>]: longer_ts <span class="op">=</span> pd.Series(np.random.standard_normal(<span class="dv">1000</span>),</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>   ....:                       index<span class="op">=</span>pd.date_range(<span class="st">"2000-01-01"</span>, periods<span class="op">=</span><span class="dv">1000</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">51</span>]: longer_ts</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">51</span>]: </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>    <span class="fl">0.092908</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>    <span class="fl">0.281746</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>    <span class="fl">0.769023</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span>    <span class="fl">1.246435</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span>    <span class="fl">1.007189</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>                ...   </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2002</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span><span class="op">-</span><span class="dv">22</span>    <span class="fl">0.930944</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2002</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span><span class="op">-</span><span class="dv">23</span>   <span class="op">-</span><span class="fl">0.811676</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2002</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span><span class="op">-</span><span class="dv">24</span>   <span class="op">-</span><span class="fl">1.830156</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2002</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span><span class="op">-</span><span class="dv">25</span>   <span class="op">-</span><span class="fl">0.138730</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="dv">2002</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span><span class="op">-</span><span class="dv">26</span>    <span class="fl">0.334088</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>Freq: D, Length: <span class="dv">1000</span>, dtype: float64</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">52</span>]: longer_ts[<span class="st">"2001"</span>]</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">52</span>]: </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>    <span class="fl">1.599534</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>    <span class="fl">0.474071</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>    <span class="fl">0.151326</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span>   <span class="op">-</span><span class="fl">0.542173</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span>   <span class="op">-</span><span class="fl">0.475496</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>                ...   </span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">12</span><span class="op">-</span><span class="dv">27</span>    <span class="fl">0.057874</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">12</span><span class="op">-</span><span class="dv">28</span>   <span class="op">-</span><span class="fl">0.433739</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">12</span><span class="op">-</span><span class="dv">29</span>    <span class="fl">0.092698</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">12</span><span class="op">-</span><span class="dv">30</span>   <span class="op">-</span><span class="fl">1.397820</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">12</span><span class="op">-</span><span class="dv">31</span>    <span class="fl">1.457823</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>Freq: D, Length: <span class="dv">365</span>, dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Here, the string <code>"2001"</code> is interpreted as a year and selects that time period. This also works if you specify the month:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">53</span>]: longer_ts[<span class="st">"2001-05"</span>]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">53</span>]: </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>   <span class="op">-</span><span class="fl">0.622547</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>    <span class="fl">0.936289</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>    <span class="fl">0.750018</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span>   <span class="op">-</span><span class="fl">0.056715</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span>    <span class="fl">2.300675</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                ...   </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">27</span>    <span class="fl">0.235477</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">28</span>    <span class="fl">0.111835</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">29</span>   <span class="op">-</span><span class="fl">1.251504</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">30</span>   <span class="op">-</span><span class="fl">2.949343</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">31</span>    <span class="fl">0.634634</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>Freq: D, Length: <span class="dv">31</span>, dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Slicing with <code>datetime</code> objects works as well:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">54</span>]: ts[datetime(<span class="dv">2011</span>, <span class="dv">1</span>, <span class="dv">7</span>):]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">54</span>]: </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">7</span>   <span class="op">-</span><span class="fl">0.519439</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">8</span>   <span class="op">-</span><span class="fl">0.555730</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">10</span>    <span class="fl">1.965781</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">12</span>    <span class="fl">1.393406</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>dtype: float64</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">55</span>]: ts[datetime(<span class="dv">2011</span>, <span class="dv">1</span>, <span class="dv">7</span>):datetime(<span class="dv">2011</span>, <span class="dv">1</span>, <span class="dv">10</span>)]</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">55</span>]: </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">7</span>   <span class="op">-</span><span class="fl">0.519439</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">8</span>   <span class="op">-</span><span class="fl">0.555730</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">10</span>    <span class="fl">1.965781</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Because most time series data is ordered chronologically, you can slice with timestamps not contained in a time series to perform a range query:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">56</span>]: ts</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">56</span>]: </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>   <span class="op">-</span><span class="fl">0.204708</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span>    <span class="fl">0.478943</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">7</span>   <span class="op">-</span><span class="fl">0.519439</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">8</span>   <span class="op">-</span><span class="fl">0.555730</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">10</span>    <span class="fl">1.965781</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">12</span>    <span class="fl">1.393406</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>dtype: float64</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">57</span>]: ts[<span class="st">"2011-01-06"</span>:<span class="st">"2011-01-11"</span>]</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">57</span>]: </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">7</span>   <span class="op">-</span><span class="fl">0.519439</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">8</span>   <span class="op">-</span><span class="fl">0.555730</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">10</span>    <span class="fl">1.965781</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>As before, you can pass a string date, <code>datetime</code>, or timestamp. Remember that slicing in this manner produces views on the source time series, like slicing NumPy arrays. This means that no data is copied, and modifications on the slice will be reflected in the original data.</p>
<p>There is an equivalent instance method, <code>truncate</code>, that slices a Series between two dates:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">58</span>]: ts.truncate(after<span class="op">=</span><span class="st">"2011-01-09"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">58</span>]: </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>   <span class="op">-</span><span class="fl">0.204708</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span>    <span class="fl">0.478943</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">7</span>   <span class="op">-</span><span class="fl">0.519439</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">8</span>   <span class="op">-</span><span class="fl">0.555730</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>All of this holds true for DataFrame as well, indexing on its rows:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">59</span>]: dates <span class="op">=</span> pd.date_range(<span class="st">"2000-01-01"</span>, periods<span class="op">=</span><span class="dv">100</span>, freq<span class="op">=</span><span class="st">"W-WED"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">60</span>]: long_df <span class="op">=</span> pd.DataFrame(np.random.standard_normal((<span class="dv">100</span>, <span class="dv">4</span>)),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>   ....:                        index<span class="op">=</span>dates,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>   ....:                        columns<span class="op">=</span>[<span class="st">"Colorado"</span>, <span class="st">"Texas"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>   ....:                                 <span class="st">"New York"</span>, <span class="st">"Ohio"</span>])</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">61</span>]: long_df.loc[<span class="st">"2001-05"</span>]</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">61</span>]: </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>            Colorado     Texas  New York      Ohio</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span> <span class="op">-</span><span class="fl">0.006045</span>  <span class="fl">0.490094</span> <span class="op">-</span><span class="fl">0.277186</span> <span class="op">-</span><span class="fl">0.707213</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span> <span class="op">-</span><span class="fl">0.560107</span>  <span class="fl">2.735527</span>  <span class="fl">0.927335</span>  <span class="fl">1.513906</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">16</span>  <span class="fl">0.538600</span>  <span class="fl">1.273768</span>  <span class="fl">0.667876</span> <span class="op">-</span><span class="fl">0.969206</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">23</span>  <span class="fl">1.676091</span> <span class="op">-</span><span class="fl">0.817649</span>  <span class="fl">0.050188</span>  <span class="fl">1.951312</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">30</span>  <span class="fl">3.260383</span>  <span class="fl">0.963301</span>  <span class="fl">1.201206</span> <span class="op">-</span><span class="fl">1.852001</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="tseries_nonunique" class="level3">
<h3 class="anchored" data-anchor-id="tseries_nonunique">Time Series with Duplicate Indices</h3>
<p>In some applications, there may be multiple data observations falling on a particular timestamp. Here is an example:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">62</span>]: dates <span class="op">=</span> pd.DatetimeIndex([<span class="st">"2000-01-01"</span>, <span class="st">"2000-01-02"</span>, <span class="st">"2000-01-02"</span>,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>   ....:                           <span class="st">"2000-01-02"</span>, <span class="st">"2000-01-03"</span>])</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">63</span>]: dup_ts <span class="op">=</span> pd.Series(np.arange(<span class="dv">5</span>), index<span class="op">=</span>dates)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">64</span>]: dup_ts</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">64</span>]: </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>    <span class="dv">0</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>    <span class="dv">1</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>    <span class="dv">2</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>    <span class="dv">3</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>    <span class="dv">4</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>dtype: int64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We can tell that the index is not unique by checking its <code>is_unique</code> property:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">65</span>]: dup_ts.index.is_unique</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">65</span>]: <span class="va">False</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Indexing into this time series will now either produce scalar values or slices, depending on whether a timestamp is duplicated:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">66</span>]: dup_ts[<span class="st">"2000-01-03"</span>]  <span class="co"># not duplicated</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">66</span>]: <span class="dv">4</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">67</span>]: dup_ts[<span class="st">"2000-01-02"</span>]  <span class="co"># duplicated</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">67</span>]: </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>    <span class="dv">1</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>    <span class="dv">2</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>    <span class="dv">3</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>dtype: int64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Suppose you wanted to aggregate the data having nonunique timestamps. One way to do this is to use <code>groupby</code> and pass <code>level=0</code> (the one and only level):</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">68</span>]: grouped <span class="op">=</span> dup_ts.groupby(level<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">69</span>]: grouped.mean()</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">69</span>]: </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>    <span class="fl">0.0</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>    <span class="fl">2.0</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>    <span class="fl">4.0</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>dtype: float64</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">70</span>]: grouped.count()</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">70</span>]: </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>    <span class="dv">1</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>    <span class="dv">3</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>    <span class="dv">1</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>dtype: int64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="tseries_frequency" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="tseries_frequency"><span class="header-section-number">11.3</span> Date Ranges, Frequencies, and Shifting</h2>
<p>Generic time series in pandas are assumed to be irregular; that is, they have no fixed frequency. For many applications this is sufficient. However, it’s often desirable to work relative to a fixed frequency, such as daily, monthly, or every 15 minutes, even if that means introducing missing values into a time series. Fortunately, pandas has a full suite of standard time series frequencies and tools for resampling (discussed in more detail later in <a href="#tseries_resampling">Resampling and Frequency Conversion</a>), inferring frequencies, and generating fixed-frequency date ranges. For example, you can convert the sample time series to fixed daily frequency by calling <code>resample</code>:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">71</span>]: ts</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">71</span>]: </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>   <span class="op">-</span><span class="fl">0.204708</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span>    <span class="fl">0.478943</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">7</span>   <span class="op">-</span><span class="fl">0.519439</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">8</span>   <span class="op">-</span><span class="fl">0.555730</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">10</span>    <span class="fl">1.965781</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">12</span>    <span class="fl">1.393406</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>dtype: float64</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">72</span>]: resampler <span class="op">=</span> ts.resample(<span class="st">"D"</span>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">73</span>]: resampler</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">73</span>]: <span class="op">&lt;</span>pandas.core.resample.DatetimeIndexResampler <span class="bu">object</span> at <span class="bn">0x17b0e7bb0</span><span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The string <code>"D"</code> is interpreted as daily frequency.</p>
<p>Conversion between frequencies or <em>resampling</em> is a big enough topic to have its own section later (<a href="#tseries_resampling">Resampling and Frequency Conversion</a>). Here, I’ll show you how to use the base frequencies and multiples thereof.</p>
<section id="tseries_fixed_date_range" class="level3">
<h3 class="anchored" data-anchor-id="tseries_fixed_date_range">Generating Date Ranges</h3>
<p>While I used it previously without explanation, <code>pandas.date_range</code> is responsible for generating a <code>DatetimeIndex</code> with an indicated length according to a particular frequency:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">74</span>]: index <span class="op">=</span> pd.date_range(<span class="st">"2012-04-01"</span>, <span class="st">"2012-06-01"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">75</span>]: index</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">75</span>]: </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>DatetimeIndex([<span class="st">'2012-04-01'</span>, <span class="st">'2012-04-02'</span>, <span class="st">'2012-04-03'</span>, <span class="st">'2012-04-04'</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-04-05'</span>, <span class="st">'2012-04-06'</span>, <span class="st">'2012-04-07'</span>, <span class="st">'2012-04-08'</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-04-09'</span>, <span class="st">'2012-04-10'</span>, <span class="st">'2012-04-11'</span>, <span class="st">'2012-04-12'</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-04-13'</span>, <span class="st">'2012-04-14'</span>, <span class="st">'2012-04-15'</span>, <span class="st">'2012-04-16'</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-04-17'</span>, <span class="st">'2012-04-18'</span>, <span class="st">'2012-04-19'</span>, <span class="st">'2012-04-20'</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-04-21'</span>, <span class="st">'2012-04-22'</span>, <span class="st">'2012-04-23'</span>, <span class="st">'2012-04-24'</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-04-25'</span>, <span class="st">'2012-04-26'</span>, <span class="st">'2012-04-27'</span>, <span class="st">'2012-04-28'</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-04-29'</span>, <span class="st">'2012-04-30'</span>, <span class="st">'2012-05-01'</span>, <span class="st">'2012-05-02'</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-05-03'</span>, <span class="st">'2012-05-04'</span>, <span class="st">'2012-05-05'</span>, <span class="st">'2012-05-06'</span>,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-05-07'</span>, <span class="st">'2012-05-08'</span>, <span class="st">'2012-05-09'</span>, <span class="st">'2012-05-10'</span>,</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-05-11'</span>, <span class="st">'2012-05-12'</span>, <span class="st">'2012-05-13'</span>, <span class="st">'2012-05-14'</span>,</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-05-15'</span>, <span class="st">'2012-05-16'</span>, <span class="st">'2012-05-17'</span>, <span class="st">'2012-05-18'</span>,</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-05-19'</span>, <span class="st">'2012-05-20'</span>, <span class="st">'2012-05-21'</span>, <span class="st">'2012-05-22'</span>,</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-05-23'</span>, <span class="st">'2012-05-24'</span>, <span class="st">'2012-05-25'</span>, <span class="st">'2012-05-26'</span>,</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-05-27'</span>, <span class="st">'2012-05-28'</span>, <span class="st">'2012-05-29'</span>, <span class="st">'2012-05-30'</span>,</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-05-31'</span>, <span class="st">'2012-06-01'</span>],</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>              dtype<span class="op">=</span><span class="st">'datetime64[ns]'</span>, freq<span class="op">=</span><span class="st">'D'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>By default, <code>pandas.date_range</code> generates daily timestamps. If you pass only a start or end date, you must pass a number of periods to generate:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">76</span>]: pd.date_range(start<span class="op">=</span><span class="st">"2012-04-01"</span>, periods<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">76</span>]: </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>DatetimeIndex([<span class="st">'2012-04-01'</span>, <span class="st">'2012-04-02'</span>, <span class="st">'2012-04-03'</span>, <span class="st">'2012-04-04'</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-04-05'</span>, <span class="st">'2012-04-06'</span>, <span class="st">'2012-04-07'</span>, <span class="st">'2012-04-08'</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-04-09'</span>, <span class="st">'2012-04-10'</span>, <span class="st">'2012-04-11'</span>, <span class="st">'2012-04-12'</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-04-13'</span>, <span class="st">'2012-04-14'</span>, <span class="st">'2012-04-15'</span>, <span class="st">'2012-04-16'</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-04-17'</span>, <span class="st">'2012-04-18'</span>, <span class="st">'2012-04-19'</span>, <span class="st">'2012-04-20'</span>],</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>              dtype<span class="op">=</span><span class="st">'datetime64[ns]'</span>, freq<span class="op">=</span><span class="st">'D'</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">77</span>]: pd.date_range(end<span class="op">=</span><span class="st">"2012-06-01"</span>, periods<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">77</span>]: </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>DatetimeIndex([<span class="st">'2012-05-13'</span>, <span class="st">'2012-05-14'</span>, <span class="st">'2012-05-15'</span>, <span class="st">'2012-05-16'</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-05-17'</span>, <span class="st">'2012-05-18'</span>, <span class="st">'2012-05-19'</span>, <span class="st">'2012-05-20'</span>,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-05-21'</span>, <span class="st">'2012-05-22'</span>, <span class="st">'2012-05-23'</span>, <span class="st">'2012-05-24'</span>,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-05-25'</span>, <span class="st">'2012-05-26'</span>, <span class="st">'2012-05-27'</span>, <span class="st">'2012-05-28'</span>,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-05-29'</span>, <span class="st">'2012-05-30'</span>, <span class="st">'2012-05-31'</span>, <span class="st">'2012-06-01'</span>],</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>              dtype<span class="op">=</span><span class="st">'datetime64[ns]'</span>, freq<span class="op">=</span><span class="st">'D'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The start and end dates define strict boundaries for the generated date index. For example, if you wanted a date index containing the last business day of each month, you would pass the <code>"BM"</code> frequency (business end of month; see a more complete listing of frequencies in <a href="#tbl-table_base_frequencies">Table&nbsp;<span>11.4</span></a>), and only dates falling on or inside the date interval will be included:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">78</span>]: pd.date_range(<span class="st">"2000-01-01"</span>, <span class="st">"2000-12-01"</span>, freq<span class="op">=</span><span class="st">"BM"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">78</span>]: </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>DatetimeIndex([<span class="st">'2000-01-31'</span>, <span class="st">'2000-02-29'</span>, <span class="st">'2000-03-31'</span>, <span class="st">'2000-04-28'</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2000-05-31'</span>, <span class="st">'2000-06-30'</span>, <span class="st">'2000-07-31'</span>, <span class="st">'2000-08-31'</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2000-09-29'</span>, <span class="st">'2000-10-31'</span>, <span class="st">'2000-11-30'</span>],</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>              dtype<span class="op">=</span><span class="st">'datetime64[ns]'</span>, freq<span class="op">=</span><span class="st">'BM'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-table_base_frequencies" class="anchored">
<table class="table">
<caption>Table&nbsp;11.4: Base time series frequencies (not comprehensive)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Alias</th>
<th style="text-align: left;">Offset type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>D</code></td>
<td style="text-align: left;"><code>Day</code></td>
<td style="text-align: left;">Calendar daily</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>B</code></td>
<td style="text-align: left;"><code>BusinessDay</code></td>
<td style="text-align: left;">Business daily</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>H</code></td>
<td style="text-align: left;"><code>Hour</code></td>
<td style="text-align: left;">Hourly</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>T</code> or <code>min</code></td>
<td style="text-align: left;"><code>Minute</code></td>
<td style="text-align: left;">Once a minute</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>S</code></td>
<td style="text-align: left;"><code>Second</code></td>
<td style="text-align: left;">Once a second</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>L</code> or <code>ms</code></td>
<td style="text-align: left;"><code>Milli</code></td>
<td style="text-align: left;">Millisecond (1/1,000 of 1 second)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>U</code></td>
<td style="text-align: left;"><code>Micro</code></td>
<td style="text-align: left;">Microsecond (1/1,000,000 of 1 second)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>M</code></td>
<td style="text-align: left;"><code>MonthEnd</code></td>
<td style="text-align: left;">Last calendar day of month</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>BM</code></td>
<td style="text-align: left;"><code>BusinessMonthEnd</code></td>
<td style="text-align: left;">Last business day (weekday) of month</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>MS</code></td>
<td style="text-align: left;"><code>MonthBegin</code></td>
<td style="text-align: left;">First calendar day of month</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>BMS</code></td>
<td style="text-align: left;"><code>BusinessMonthBegin</code></td>
<td style="text-align: left;">First weekday of month</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>W-MON, W-TUE, ...</code></td>
<td style="text-align: left;"><code>Week</code></td>
<td style="text-align: left;">Weekly on given day of week (MON, TUE, WED, THU, FRI, SAT, or SUN)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>WOM-1MON, WOM-2MON, ...</code></td>
<td style="text-align: left;"><code>WeekOfMonth</code></td>
<td style="text-align: left;">Generate weekly dates in the first, second, third, or fourth week of the month (e.g., <code>WOM-3FRI</code> for the third Friday of each month)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Q-JAN, Q-FEB, ...</code></td>
<td style="text-align: left;"><code>QuarterEnd</code></td>
<td style="text-align: left;">Quarterly dates anchored on last calendar day of each month, for year ending in indicated month (JAN, FEB, MAR, APR, MAY, JUN, JUL, AUG, SEP, OCT, NOV, or DEC)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>BQ-JAN, BQ-FEB, ...</code></td>
<td style="text-align: left;"><code>BusinessQuarterEnd</code></td>
<td style="text-align: left;">Quarterly dates anchored on last weekday day of each month, for year ending in indicated month</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>QS-JAN, QS-FEB, ...</code></td>
<td style="text-align: left;"><code>QuarterBegin</code></td>
<td style="text-align: left;">Quarterly dates anchored on first calendar day of each month, for year ending in indicated month</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>BQS-JAN, BQS-FEB, ...</code></td>
<td style="text-align: left;"><code>BusinessQuarterBegin</code></td>
<td style="text-align: left;">Quarterly dates anchored on first weekday day of each month, for year ending in indicated month</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>A-JAN, A-FEB, ...</code></td>
<td style="text-align: left;"><code>YearEnd</code></td>
<td style="text-align: left;">Annual dates anchored on last calendar day of given month (JAN, FEB, MAR, APR, MAY, JUN, JUL, AUG, SEP, OCT, NOV, or DEC)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>BA-JAN, BA-FEB, ...</code></td>
<td style="text-align: left;"><code>BusinessYearEnd</code></td>
<td style="text-align: left;">Annual dates anchored on last weekday of given month</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>AS-JAN, AS-FEB, ...</code></td>
<td style="text-align: left;"><code>YearBegin</code></td>
<td style="text-align: left;">Annual dates anchored on first day of given month</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>BAS-JAN, BAS-FEB, ...</code></td>
<td style="text-align: left;"><code>BusinessYearBegin</code></td>
<td style="text-align: left;">Annual dates anchored on first weekday of given month</td>
</tr>
</tbody>
</table>
</div>
<p><code>pandas.date_range</code> by default preserves the time (if any) of the start or end timestamp:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">79</span>]: pd.date_range(<span class="st">"2012-05-02 12:56:31"</span>, periods<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">79</span>]: </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>DatetimeIndex([<span class="st">'2012-05-02 12:56:31'</span>, <span class="st">'2012-05-03 12:56:31'</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-05-04 12:56:31'</span>, <span class="st">'2012-05-05 12:56:31'</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-05-06 12:56:31'</span>],</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>              dtype<span class="op">=</span><span class="st">'datetime64[ns]'</span>, freq<span class="op">=</span><span class="st">'D'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Sometimes you will have start or end dates with time information but want to generate a set of timestamps <em>normalized</em> to midnight as a convention. To do this, there is a <code>normalize</code> option:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">80</span>]: pd.date_range(<span class="st">"2012-05-02 12:56:31"</span>, periods<span class="op">=</span><span class="dv">5</span>, normalize<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">80</span>]: </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>DatetimeIndex([<span class="st">'2012-05-02'</span>, <span class="st">'2012-05-03'</span>, <span class="st">'2012-05-04'</span>, <span class="st">'2012-05-05'</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-05-06'</span>],</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>              dtype<span class="op">=</span><span class="st">'datetime64[ns]'</span>, freq<span class="op">=</span><span class="st">'D'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="tseries_frequencies" class="level3">
<h3 class="anchored" data-anchor-id="tseries_frequencies">Frequencies and Date Offsets</h3>
<p>Frequencies in pandas are composed of a <em>base frequency</em> and a multiplier. Base frequencies are typically referred to by a string alias, like <code>"M"</code> for monthly or <code>"H"</code> for hourly. For each base frequency, there is an object referred to as a <em>date offset</em>. For example, hourly frequency can be represented with the <code>Hour</code> class:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">81</span>]: <span class="im">from</span> pandas.tseries.offsets <span class="im">import</span> Hour, Minute</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">82</span>]: hour <span class="op">=</span> Hour()</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">83</span>]: hour</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">83</span>]: <span class="op">&lt;</span>Hour<span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can define a multiple of an offset by passing an integer:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">84</span>]: four_hours <span class="op">=</span> Hour(<span class="dv">4</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">85</span>]: four_hours</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">85</span>]: <span class="op">&lt;</span><span class="dv">4</span> <span class="op">*</span> Hours<span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In most applications, you would never need to explicitly create one of these objects; instead you'd use a string alias like <code>"H"</code> or <code>"4H"</code>. Putting an integer before the base frequency creates a multiple:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">86</span>]: pd.date_range(<span class="st">"2000-01-01"</span>, <span class="st">"2000-01-03 23:59"</span>, freq<span class="op">=</span><span class="st">"4H"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">86</span>]: </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>DatetimeIndex([<span class="st">'2000-01-01 00:00:00'</span>, <span class="st">'2000-01-01 04:00:00'</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2000-01-01 08:00:00'</span>, <span class="st">'2000-01-01 12:00:00'</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2000-01-01 16:00:00'</span>, <span class="st">'2000-01-01 20:00:00'</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2000-01-02 00:00:00'</span>, <span class="st">'2000-01-02 04:00:00'</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2000-01-02 08:00:00'</span>, <span class="st">'2000-01-02 12:00:00'</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2000-01-02 16:00:00'</span>, <span class="st">'2000-01-02 20:00:00'</span>,</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2000-01-03 00:00:00'</span>, <span class="st">'2000-01-03 04:00:00'</span>,</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2000-01-03 08:00:00'</span>, <span class="st">'2000-01-03 12:00:00'</span>,</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2000-01-03 16:00:00'</span>, <span class="st">'2000-01-03 20:00:00'</span>],</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>              dtype<span class="op">=</span><span class="st">'datetime64[ns]'</span>, freq<span class="op">=</span><span class="st">'4H'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Many offsets can be combined by addition:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">87</span>]: Hour(<span class="dv">2</span>) <span class="op">+</span> Minute(<span class="dv">30</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">87</span>]: <span class="op">&lt;</span><span class="dv">150</span> <span class="op">*</span> Minutes<span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Similarly, you can pass frequency strings, like <code>"1h30min"</code>, that will effectively be parsed to the same expression:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">88</span>]: pd.date_range(<span class="st">"2000-01-01"</span>, periods<span class="op">=</span><span class="dv">10</span>, freq<span class="op">=</span><span class="st">"1h30min"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">88</span>]: </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>DatetimeIndex([<span class="st">'2000-01-01 00:00:00'</span>, <span class="st">'2000-01-01 01:30:00'</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2000-01-01 03:00:00'</span>, <span class="st">'2000-01-01 04:30:00'</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2000-01-01 06:00:00'</span>, <span class="st">'2000-01-01 07:30:00'</span>,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2000-01-01 09:00:00'</span>, <span class="st">'2000-01-01 10:30:00'</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2000-01-01 12:00:00'</span>, <span class="st">'2000-01-01 13:30:00'</span>],</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>              dtype<span class="op">=</span><span class="st">'datetime64[ns]'</span>, freq<span class="op">=</span><span class="st">'90T'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Some frequencies describe points in time that are not evenly spaced. For example, <code>"M"</code> (calendar month end) and <code>"BM"</code> (last business/weekday of month) depend on the number of days in a month and, in the latter case, whether the month ends on a weekend or not. We refer to these as <em>anchored</em> offsets.</p>
<p>Refer to <a href="#tbl-table_base_frequencies">Table&nbsp;<span>11.4</span></a> for a listing of frequency codes and date offset classes available in pandas.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Users can define their own custom frequency classes to provide date logic not available in pandas, though the full details of that are outside the scope of this book.</p>
</div>
</div>
<section id="tseries_week_of_month" class="level4">
<h4 class="anchored" data-anchor-id="tseries_week_of_month">Week of month dates</h4>
<p>One useful frequency class is “week of month,” starting with <code>WOM</code>. This enables you to get dates like the third Friday of each month:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">89</span>]: monthly_dates <span class="op">=</span> pd.date_range(<span class="st">"2012-01-01"</span>, <span class="st">"2012-09-01"</span>, freq<span class="op">=</span><span class="st">"WOM-3FRI</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="er">")</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="er">In [90]: list(monthly_dates)</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="er">Out[90]: </span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="er">[Timestamp('2012-01-20 00:00:00'),</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="er"> Timestamp</span>(<span class="st">'2012-02-17 00:00:00'</span>),</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a> Timestamp(<span class="st">'2012-03-16 00:00:00'</span>),</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a> Timestamp(<span class="st">'2012-04-20 00:00:00'</span>),</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a> Timestamp(<span class="st">'2012-05-18 00:00:00'</span>),</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a> Timestamp(<span class="st">'2012-06-15 00:00:00'</span>),</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a> Timestamp(<span class="st">'2012-07-20 00:00:00'</span>),</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a> Timestamp(<span class="st">'2012-08-17 00:00:00'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="tseries_shifting" class="level3">
<h3 class="anchored" data-anchor-id="tseries_shifting">Shifting (Leading and Lagging) Data</h3>
<p><em>Shifting</em> refers to moving data backward and forward through time. Both Series and DataFrame have a <code>shift</code> method for doing naive shifts forward or backward, leaving the index unmodified:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">91</span>]: ts <span class="op">=</span> pd.Series(np.random.standard_normal(<span class="dv">4</span>),</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>   ....:                index<span class="op">=</span>pd.date_range(<span class="st">"2000-01-01"</span>, periods<span class="op">=</span><span class="dv">4</span>, freq<span class="op">=</span><span class="st">"M"</span>))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">92</span>]: ts</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">92</span>]: </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">31</span>   <span class="op">-</span><span class="fl">0.066748</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">29</span>    <span class="fl">0.838639</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">31</span>   <span class="op">-</span><span class="fl">0.117388</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span><span class="op">-</span><span class="dv">30</span>   <span class="op">-</span><span class="fl">0.517795</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>Freq: M, dtype: float64</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">93</span>]: ts.shift(<span class="dv">2</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">93</span>]: </span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">31</span>         NaN</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">29</span>         NaN</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">31</span>   <span class="op">-</span><span class="fl">0.066748</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span><span class="op">-</span><span class="dv">30</span>    <span class="fl">0.838639</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>Freq: M, dtype: float64</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">94</span>]: ts.shift(<span class="op">-</span><span class="dv">2</span>)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">94</span>]: </span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">31</span>   <span class="op">-</span><span class="fl">0.117388</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">29</span>   <span class="op">-</span><span class="fl">0.517795</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">31</span>         NaN</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span><span class="op">-</span><span class="dv">30</span>         NaN</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>Freq: M, dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>When we shift like this, missing data is introduced either at the start or the end of the time series.</p>
<p>A common use of <code>shift</code> is computing consecutive percent changes in a time series or multiple time series as DataFrame columns. This is expressed as:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ts <span class="op">/</span> ts.shift(<span class="dv">1</span>) <span class="op">-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Because naive shifts leave the index unmodified, some data is discarded. Thus if the frequency is known, it can be passed to <code>shift</code> to advance the timestamps instead of simply the data:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">95</span>]: ts.shift(<span class="dv">2</span>, freq<span class="op">=</span><span class="st">"M"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">95</span>]: </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">31</span>   <span class="op">-</span><span class="fl">0.066748</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span><span class="op">-</span><span class="dv">30</span>    <span class="fl">0.838639</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">31</span>   <span class="op">-</span><span class="fl">0.117388</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">6</span><span class="op">-</span><span class="dv">30</span>   <span class="op">-</span><span class="fl">0.517795</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>Freq: M, dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Other frequencies can be passed, too, giving you some flexibility in how to lead and lag the data:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">96</span>]: ts.shift(<span class="dv">3</span>, freq<span class="op">=</span><span class="st">"D"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">96</span>]: </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>   <span class="op">-</span><span class="fl">0.066748</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>    <span class="fl">0.838639</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>   <span class="op">-</span><span class="fl">0.117388</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>   <span class="op">-</span><span class="fl">0.517795</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>dtype: float64</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">97</span>]: ts.shift(<span class="dv">1</span>, freq<span class="op">=</span><span class="st">"90T"</span>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">97</span>]: </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">31</span> <span class="dv">0</span><span class="er">1</span>:<span class="dv">30</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.066748</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">29</span> <span class="dv">0</span><span class="er">1</span>:<span class="dv">30</span>:<span class="dv">00</span>    <span class="fl">0.838639</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">31</span> <span class="dv">0</span><span class="er">1</span>:<span class="dv">30</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.117388</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span><span class="op">-</span><span class="dv">30</span> <span class="dv">0</span><span class="er">1</span>:<span class="dv">30</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.517795</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>T</code> here stands for minutes. Note that the <code>freq</code> parameter here indicates the offset to apply to the timestamps, but it does not change the underlying frequency of the data, if any.</p>
<section id="tseries_shifting_offsets" class="level4">
<h4 class="anchored" data-anchor-id="tseries_shifting_offsets">Shifting dates with offsets</h4>
<p>The pandas date offsets can also be used with <code>datetime</code> or <code>Timestamp</code> objects:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">98</span>]: <span class="im">from</span> pandas.tseries.offsets <span class="im">import</span> Day, MonthEnd</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">99</span>]: now <span class="op">=</span> datetime(<span class="dv">2011</span>, <span class="dv">11</span>, <span class="dv">17</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">100</span>]: now <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> Day()</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">100</span>]: Timestamp(<span class="st">'2011-11-20 00:00:00'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you add an anchored offset like <code>MonthEnd</code>, the first increment will "roll forward" a date to the next date according to the frequency rule:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">101</span>]: now <span class="op">+</span> MonthEnd()</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">101</span>]: Timestamp(<span class="st">'2011-11-30 00:00:00'</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">102</span>]: now <span class="op">+</span> MonthEnd(<span class="dv">2</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">102</span>]: Timestamp(<span class="st">'2011-12-31 00:00:00'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Anchored offsets can explicitly “roll” dates forward or backward by simply using their <code>rollforward</code> and <code>rollback</code> methods, respectively:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">103</span>]: offset <span class="op">=</span> MonthEnd()</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">104</span>]: offset.rollforward(now)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">104</span>]: Timestamp(<span class="st">'2011-11-30 00:00:00'</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">105</span>]: offset.rollback(now)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">105</span>]: Timestamp(<span class="st">'2011-10-31 00:00:00'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A creative use of date offsets is to use these methods with <code>groupby</code>:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">106</span>]: ts <span class="op">=</span> pd.Series(np.random.standard_normal(<span class="dv">20</span>),</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>   .....:                index<span class="op">=</span>pd.date_range(<span class="st">"2000-01-15"</span>, periods<span class="op">=</span><span class="dv">20</span>, freq<span class="op">=</span><span class="st">"4D"</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">107</span>]: ts</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">107</span>]: </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">15</span>   <span class="op">-</span><span class="fl">0.116696</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">19</span>    <span class="fl">2.389645</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">23</span>   <span class="op">-</span><span class="fl">0.932454</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">27</span>   <span class="op">-</span><span class="fl">0.229331</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">31</span>   <span class="op">-</span><span class="fl">1.140330</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span>    <span class="fl">0.439920</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">0</span><span class="er">8</span>   <span class="op">-</span><span class="fl">0.823758</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">12</span>   <span class="op">-</span><span class="fl">0.520930</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">16</span>    <span class="fl">0.350282</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">20</span>    <span class="fl">0.204395</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">24</span>    <span class="fl">0.133445</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">28</span>    <span class="fl">0.327905</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>    <span class="fl">0.072153</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">0</span><span class="er">7</span>    <span class="fl">0.131678</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">11</span>   <span class="op">-</span><span class="fl">1.297459</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">15</span>    <span class="fl">0.997747</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">19</span>    <span class="fl">0.870955</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">23</span>   <span class="op">-</span><span class="fl">0.991253</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">27</span>    <span class="fl">0.151699</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">31</span>    <span class="fl">1.266151</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>Freq: <span class="dv">4</span><span class="er">D</span>, dtype: float64</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">108</span>]: ts.groupby(MonthEnd().rollforward).mean()</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">108</span>]: </span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">31</span>   <span class="op">-</span><span class="fl">0.005833</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">29</span>    <span class="fl">0.015894</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">31</span>    <span class="fl">0.150209</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Of course, an easier and faster way to do this is with <code>resample</code> (we'll discuss this in much more depth in <a href="#tseries_resampling">Resampling and Frequency Conversion</a>):</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">109</span>]: ts.resample(<span class="st">"M"</span>).mean()</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">109</span>]: </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">31</span>   <span class="op">-</span><span class="fl">0.005833</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">29</span>    <span class="fl">0.015894</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">31</span>    <span class="fl">0.150209</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>Freq: M, dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="tseries_time_zones" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="tseries_time_zones"><span class="header-section-number">11.4</span> Time Zone Handling</h2>
<p>Working with time zones can be one of the most unpleasant parts of time series manipulation. As a result, many time series users choose to work with time series in <em>coordinated universal time</em> or <em>UTC</em>, which is the geography-independent international standard. Time zones are expressed as offsets from UTC; for example, New York is four hours behind UTC during daylight saving time (DST) and five hours behind the rest of the year.</p>
<p>In Python, time zone information comes from the third-party <code>pytz</code> library (installable with pip or conda), which exposes the <em>Olson database</em>, a compilation of world time zone information. This is especially important for historical data because the DST transition dates (and even UTC offsets) have been changed numerous times depending on the regional laws. In the United States, the DST transition times have been changed many times since 1900!</p>
<p>For detailed information about the <code>pytz</code> library, you’ll need to look at that library’s documentation. As far as this book is concerned, pandas wraps <code>pytz</code>’s functionality so you can ignore its API outside of the time zone names. Since pandas has a hard dependency on <code>pytz</code>, it isn't necessary to install it separately. Time zone names can be found interactively and in the docs:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">110</span>]: <span class="im">import</span> pytz</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">111</span>]: pytz.common_timezones[<span class="op">-</span><span class="dv">5</span>:]</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">111</span>]: [<span class="st">'US/Eastern'</span>, <span class="st">'US/Hawaii'</span>, <span class="st">'US/Mountain'</span>, <span class="st">'US/Pacific'</span>, <span class="st">'UTC'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To get a time zone object from <code>pytz</code>, use <code>pytz.timezone</code>:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">112</span>]: tz <span class="op">=</span> pytz.timezone(<span class="st">"America/New_York"</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">113</span>]: tz</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">113</span>]: <span class="op">&lt;</span>DstTzInfo <span class="st">'America/New_York'</span> LMT<span class="op">-</span><span class="dv">1</span> day, <span class="dv">19</span>:<span class="dv">0</span><span class="er">4</span>:<span class="dv">00</span> STD<span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Methods in pandas will accept either time zone names or these objects.</p>
<section id="tseries_tz_convert" class="level3">
<h3 class="anchored" data-anchor-id="tseries_tz_convert">Time Zone Localization and Conversion</h3>
<p>By default, time series in pandas are <em>time zone naive</em>. For example, consider the following time series:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">114</span>]: dates <span class="op">=</span> pd.date_range(<span class="st">"2012-03-09 09:30"</span>, periods<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">115</span>]: ts <span class="op">=</span> pd.Series(np.random.standard_normal(<span class="bu">len</span>(dates)), index<span class="op">=</span>dates)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">116</span>]: ts</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">116</span>]: </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.202469</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">10</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>    <span class="fl">0.050718</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">11</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>    <span class="fl">0.639869</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">12</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>    <span class="fl">0.597594</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">13</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.797246</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">14</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>    <span class="fl">0.472879</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>Freq: D, dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The index’s <code>tz</code> field is <code>None</code>:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">117</span>]: <span class="bu">print</span>(ts.index.tz)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="va">None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Date ranges can be generated with a time zone set:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">118</span>]: pd.date_range(<span class="st">"2012-03-09 09:30"</span>, periods<span class="op">=</span><span class="dv">10</span>, tz<span class="op">=</span><span class="st">"UTC"</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">118</span>]: </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>DatetimeIndex([<span class="st">'2012-03-09 09:30:00+00:00'</span>, <span class="st">'2012-03-10 09:30:00+00:00'</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-03-11 09:30:00+00:00'</span>, <span class="st">'2012-03-12 09:30:00+00:00'</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-03-13 09:30:00+00:00'</span>, <span class="st">'2012-03-14 09:30:00+00:00'</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-03-15 09:30:00+00:00'</span>, <span class="st">'2012-03-16 09:30:00+00:00'</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-03-17 09:30:00+00:00'</span>, <span class="st">'2012-03-18 09:30:00+00:00'</span>],</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>              dtype<span class="op">=</span><span class="st">'datetime64[ns, UTC]'</span>, freq<span class="op">=</span><span class="st">'D'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Conversion from naive to <em>localized</em> (reinterpreted as having been observed in a particular time zone) is handled by the <code>tz_localize</code> method:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">119</span>]: ts</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">119</span>]: </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.202469</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">10</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>    <span class="fl">0.050718</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">11</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>    <span class="fl">0.639869</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">12</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>    <span class="fl">0.597594</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">13</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.797246</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">14</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>    <span class="fl">0.472879</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>Freq: D, dtype: float64</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">120</span>]: ts_utc <span class="op">=</span> ts.tz_localize(<span class="st">"UTC"</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">121</span>]: ts_utc</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">121</span>]: </span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">+</span><span class="dv">00</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.202469</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">10</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">+</span><span class="dv">00</span>:<span class="dv">00</span>    <span class="fl">0.050718</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">11</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">+</span><span class="dv">00</span>:<span class="dv">00</span>    <span class="fl">0.639869</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">12</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">+</span><span class="dv">00</span>:<span class="dv">00</span>    <span class="fl">0.597594</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">13</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">+</span><span class="dv">00</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.797246</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">14</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">+</span><span class="dv">00</span>:<span class="dv">00</span>    <span class="fl">0.472879</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>Freq: D, dtype: float64</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">122</span>]: ts_utc.index</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">122</span>]: </span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>DatetimeIndex([<span class="st">'2012-03-09 09:30:00+00:00'</span>, <span class="st">'2012-03-10 09:30:00+00:00'</span>,</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-03-11 09:30:00+00:00'</span>, <span class="st">'2012-03-12 09:30:00+00:00'</span>,</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-03-13 09:30:00+00:00'</span>, <span class="st">'2012-03-14 09:30:00+00:00'</span>],</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>              dtype<span class="op">=</span><span class="st">'datetime64[ns, UTC]'</span>, freq<span class="op">=</span><span class="st">'D'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Once a time series has been localized to a particular time zone, it can be converted to another time zone with <code>tz_convert</code>:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">123</span>]: ts_utc.tz_convert(<span class="st">"America/New_York"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">123</span>]: </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span> <span class="dv">0</span><span class="er">4</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.202469</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">10</span> <span class="dv">0</span><span class="er">4</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span>:<span class="dv">00</span>    <span class="fl">0.050718</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">11</span> <span class="dv">0</span><span class="er">5</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span>:<span class="dv">00</span>    <span class="fl">0.639869</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">12</span> <span class="dv">0</span><span class="er">5</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span>:<span class="dv">00</span>    <span class="fl">0.597594</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">13</span> <span class="dv">0</span><span class="er">5</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.797246</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">14</span> <span class="dv">0</span><span class="er">5</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span>:<span class="dv">00</span>    <span class="fl">0.472879</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>Freq: D, dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In the case of the preceding time series, which straddles a DST transition in the <code>America/New_York</code> time zone, we could localize to US Eastern time and convert to, say, UTC or Berlin time:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">124</span>]: ts_eastern <span class="op">=</span> ts.tz_localize(<span class="st">"America/New_York"</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">125</span>]: ts_eastern.tz_convert(<span class="st">"UTC"</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">125</span>]: </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span> <span class="dv">14</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">+</span><span class="dv">00</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.202469</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">10</span> <span class="dv">14</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">+</span><span class="dv">00</span>:<span class="dv">00</span>    <span class="fl">0.050718</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">11</span> <span class="dv">13</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">+</span><span class="dv">00</span>:<span class="dv">00</span>    <span class="fl">0.639869</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">12</span> <span class="dv">13</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">+</span><span class="dv">00</span>:<span class="dv">00</span>    <span class="fl">0.597594</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">13</span> <span class="dv">13</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">+</span><span class="dv">00</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.797246</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">14</span> <span class="dv">13</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">+</span><span class="dv">00</span>:<span class="dv">00</span>    <span class="fl">0.472879</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>dtype: float64</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">126</span>]: ts_eastern.tz_convert(<span class="st">"Europe/Berlin"</span>)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">126</span>]: </span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span> <span class="dv">15</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">+</span><span class="dv">0</span><span class="er">1</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.202469</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">10</span> <span class="dv">15</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">+</span><span class="dv">0</span><span class="er">1</span>:<span class="dv">00</span>    <span class="fl">0.050718</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">11</span> <span class="dv">14</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">+</span><span class="dv">0</span><span class="er">1</span>:<span class="dv">00</span>    <span class="fl">0.639869</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">12</span> <span class="dv">14</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">+</span><span class="dv">0</span><span class="er">1</span>:<span class="dv">00</span>    <span class="fl">0.597594</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">13</span> <span class="dv">14</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">+</span><span class="dv">0</span><span class="er">1</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.797246</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">14</span> <span class="dv">14</span>:<span class="dv">30</span>:<span class="dv">00</span><span class="op">+</span><span class="dv">0</span><span class="er">1</span>:<span class="dv">00</span>    <span class="fl">0.472879</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>tz_localize</code> and <code>tz_convert</code> are also instance methods on <code>DatetimeIndex</code>:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">127</span>]: ts.index.tz_localize(<span class="st">"Asia/Shanghai"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">127</span>]: </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>DatetimeIndex([<span class="st">'2012-03-09 09:30:00+08:00'</span>, <span class="st">'2012-03-10 09:30:00+08:00'</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-03-11 09:30:00+08:00'</span>, <span class="st">'2012-03-12 09:30:00+08:00'</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-03-13 09:30:00+08:00'</span>, <span class="st">'2012-03-14 09:30:00+08:00'</span>],</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>              dtype<span class="op">=</span><span class="st">'datetime64[ns, Asia/Shanghai]'</span>, freq<span class="op">=</span><span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>Localizing naive timestamps also checks for ambiguous or non-existent times around daylight saving time transitions.</p>
</div>
</div>
</section>
<section id="tseries_tz_timestamp" class="level3">
<h3 class="anchored" data-anchor-id="tseries_tz_timestamp">Operations with Time Zone-Aware Timestamp Objects</h3>
<p>Similar to time series and date ranges, individual <code>Timestamp</code> objects similarly can be localized from naive to time zone-aware and converted from one time zone to another:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">128</span>]: stamp <span class="op">=</span> pd.Timestamp(<span class="st">"2011-03-12 04:00"</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">129</span>]: stamp_utc <span class="op">=</span> stamp.tz_localize(<span class="st">"utc"</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">130</span>]: stamp_utc.tz_convert(<span class="st">"America/New_York"</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">130</span>]: Timestamp(<span class="st">'2011-03-11 23:00:00-0500'</span>, tz<span class="op">=</span><span class="st">'America/New_York'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can also pass a time zone when creating the <code>Timestamp</code>:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">131</span>]: stamp_moscow <span class="op">=</span> pd.Timestamp(<span class="st">"2011-03-12 04:00"</span>, tz<span class="op">=</span><span class="st">"Europe/Moscow"</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">132</span>]: stamp_moscow</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">132</span>]: Timestamp(<span class="st">'2011-03-12 04:00:00+0300'</span>, tz<span class="op">=</span><span class="st">'Europe/Moscow'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Time zone-aware <code>Timestamp</code> objects internally store a UTC timestamp value as nanoseconds since the Unix epoch (January 1, 1970), so changing the time zone does not alter the internal UTC value:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">133</span>]: stamp_utc.value</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">133</span>]: <span class="dv">1299902400000000000</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">134</span>]: stamp_utc.tz_convert(<span class="st">"America/New_York"</span>).value</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">134</span>]: <span class="dv">1299902400000000000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>When performing time arithmetic using pandas’s <code>DateOffset</code> objects, pandas respects daylight saving time transitions where possible. Here we construct timestamps that occur right before DST transitions (forward and backward). First, 30 minutes before transitioning to DST:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">135</span>]: stamp <span class="op">=</span> pd.Timestamp(<span class="st">"2012-03-11 01:30"</span>, tz<span class="op">=</span><span class="st">"US/Eastern"</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">136</span>]: stamp</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">136</span>]: Timestamp(<span class="st">'2012-03-11 01:30:00-0500'</span>, tz<span class="op">=</span><span class="st">'US/Eastern'</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">137</span>]: stamp <span class="op">+</span> Hour()</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">137</span>]: Timestamp(<span class="st">'2012-03-11 03:30:00-0400'</span>, tz<span class="op">=</span><span class="st">'US/Eastern'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Then, 90 minutes before transitioning out of DST:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">138</span>]: stamp <span class="op">=</span> pd.Timestamp(<span class="st">"2012-11-04 00:30"</span>, tz<span class="op">=</span><span class="st">"US/Eastern"</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">139</span>]: stamp</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">139</span>]: Timestamp(<span class="st">'2012-11-04 00:30:00-0400'</span>, tz<span class="op">=</span><span class="st">'US/Eastern'</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">140</span>]: stamp <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> Hour()</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">140</span>]: Timestamp(<span class="st">'2012-11-04 01:30:00-0500'</span>, tz<span class="op">=</span><span class="st">'US/Eastern'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="tseries_tz_align" class="level3">
<h3 class="anchored" data-anchor-id="tseries_tz_align">Operations Between Different Time Zones</h3>
<p>If two time series with different time zones are combined, the result will be UTC. Since the timestamps are stored under the hood in UTC, this is a straightforward operation and requires no conversion:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">141</span>]: dates <span class="op">=</span> pd.date_range(<span class="st">"2012-03-07 09:30"</span>, periods<span class="op">=</span><span class="dv">10</span>, freq<span class="op">=</span><span class="st">"B"</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">142</span>]: ts <span class="op">=</span> pd.Series(np.random.standard_normal(<span class="bu">len</span>(dates)), index<span class="op">=</span>dates)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">143</span>]: ts</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">143</span>]: </span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">0</span><span class="er">7</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>    <span class="fl">0.522356</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">0</span><span class="er">8</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.546348</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.733537</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">12</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>    <span class="fl">1.302736</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">13</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>    <span class="fl">0.022199</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">14</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>    <span class="fl">0.364287</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">15</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.922839</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">16</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>    <span class="fl">0.312656</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">19</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">1.128497</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">20</span> <span class="dv">0</span><span class="er">9</span>:<span class="dv">30</span>:<span class="dv">00</span>   <span class="op">-</span><span class="fl">0.333488</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>Freq: B, dtype: float64</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">144</span>]: ts1 <span class="op">=</span> ts[:<span class="dv">7</span>].tz_localize(<span class="st">"Europe/London"</span>)</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">145</span>]: ts2 <span class="op">=</span> ts1[<span class="dv">2</span>:].tz_convert(<span class="st">"Europe/Moscow"</span>)</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">146</span>]: result <span class="op">=</span> ts1 <span class="op">+</span> ts2</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">147</span>]: result.index</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">147</span>]: </span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>DatetimeIndex([<span class="st">'2012-03-07 09:30:00+00:00'</span>, <span class="st">'2012-03-08 09:30:00+00:00'</span>,</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-03-09 09:30:00+00:00'</span>, <span class="st">'2012-03-12 09:30:00+00:00'</span>,</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-03-13 09:30:00+00:00'</span>, <span class="st">'2012-03-14 09:30:00+00:00'</span>,</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>               <span class="st">'2012-03-15 09:30:00+00:00'</span>],</span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>              dtype<span class="op">=</span><span class="st">'datetime64[ns, UTC]'</span>, freq<span class="op">=</span><span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Operations between time zone-naive and time zone-aware data are not supported and will raise an exception.</p>
</section>
</section>
<section id="tseries_periods" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="tseries_periods"><span class="header-section-number">11.5</span> Periods and Period Arithmetic</h2>
<p><em>Periods</em> represent time spans, like days, months, quarters, or years. The <code>pandas.Period</code> class represents this data type, requiring a string or integer and a supported frequency from <a href="#tbl-table_base_frequencies">Table&nbsp;<span>11.4</span></a>:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">148</span>]: p <span class="op">=</span> pd.Period(<span class="st">"2011"</span>, freq<span class="op">=</span><span class="st">"A-DEC"</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">149</span>]: p</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">149</span>]: Period(<span class="st">'2011'</span>, <span class="st">'A-DEC'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In this case, the <code>Period</code> object represents the full time span from January 1, 2011, to December 31, 2011, inclusive. Conveniently, adding and subtracting integers from periods has the effect of shifting their frequency:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">150</span>]: p <span class="op">+</span> <span class="dv">5</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">150</span>]: Period(<span class="st">'2016'</span>, <span class="st">'A-DEC'</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">151</span>]: p <span class="op">-</span> <span class="dv">2</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">151</span>]: Period(<span class="st">'2009'</span>, <span class="st">'A-DEC'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If two periods have the same frequency, their difference is the number of units between them as a date offset:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">152</span>]: pd.Period(<span class="st">"2014"</span>, freq<span class="op">=</span><span class="st">"A-DEC"</span>) <span class="op">-</span> p</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">152</span>]: <span class="op">&lt;</span><span class="dv">3</span> <span class="op">*</span> YearEnds: month<span class="op">=</span><span class="dv">12</span><span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Regular ranges of periods can be constructed with the <code>period_range</code> function:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">153</span>]: periods <span class="op">=</span> pd.period_range(<span class="st">"2000-01-01"</span>, <span class="st">"2000-06-30"</span>, freq<span class="op">=</span><span class="st">"M"</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">154</span>]: periods</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">154</span>]: PeriodIndex([<span class="st">'2000-01'</span>, <span class="st">'2000-02'</span>, <span class="st">'2000-03'</span>, <span class="st">'2000-04'</span>, <span class="st">'2000-05'</span>, <span class="st">'20</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="er">00-06'], dtype='period[M]')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>PeriodIndex</code> class stores a sequence of periods and can serve as an axis index in any pandas data structure:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">155</span>]: pd.Series(np.random.standard_normal(<span class="dv">6</span>), index<span class="op">=</span>periods)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">155</span>]: </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>   <span class="op">-</span><span class="fl">0.514551</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>   <span class="op">-</span><span class="fl">0.559782</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>   <span class="op">-</span><span class="fl">0.783408</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span>   <span class="op">-</span><span class="fl">1.797685</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span>   <span class="op">-</span><span class="fl">0.172670</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">6</span>    <span class="fl">0.680215</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>Freq: M, dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you have an array of strings, you can also use the <code>PeriodIndex</code> class, where all of its values are periods:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">156</span>]: values <span class="op">=</span> [<span class="st">"2001Q3"</span>, <span class="st">"2002Q2"</span>, <span class="st">"2003Q1"</span>]</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">157</span>]: index <span class="op">=</span> pd.PeriodIndex(values, freq<span class="op">=</span><span class="st">"Q-DEC"</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">158</span>]: index</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">158</span>]: PeriodIndex([<span class="st">'2001Q3'</span>, <span class="st">'2002Q2'</span>, <span class="st">'2003Q1'</span>], dtype<span class="op">=</span><span class="st">'period[Q-DEC]'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="tseries_period_asfreq" class="level3">
<h3 class="anchored" data-anchor-id="tseries_period_asfreq">Period Frequency Conversion</h3>
<p>Periods and <code>PeriodIndex</code> objects can be converted to another frequency with their <code>asfreq</code> method. As an example, suppose we had an annual period and wanted to convert it into a monthly period either at the start or end of the year. This can be done like so:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">159</span>]: p <span class="op">=</span> pd.Period(<span class="st">"2011"</span>, freq<span class="op">=</span><span class="st">"A-DEC"</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">160</span>]: p</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">160</span>]: Period(<span class="st">'2011'</span>, <span class="st">'A-DEC'</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">161</span>]: p.asfreq(<span class="st">"M"</span>, how<span class="op">=</span><span class="st">"start"</span>)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">161</span>]: Period(<span class="st">'2011-01'</span>, <span class="st">'M'</span>)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">162</span>]: p.asfreq(<span class="st">"M"</span>, how<span class="op">=</span><span class="st">"end"</span>)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">162</span>]: Period(<span class="st">'2011-12'</span>, <span class="st">'M'</span>)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">163</span>]: p.asfreq(<span class="st">"M"</span>)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">163</span>]: Period(<span class="st">'2011-12'</span>, <span class="st">'M'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can think of <code>Period("2011", "A-DEC")</code> as being a sort of cursor pointing to a span of time, subdivided by monthly periods. See <a href="#fig-figure_period_asfreq">Figure&nbsp;<span>11.1</span></a> for an illustration of this. For a <em>fiscal year</em> ending on a month other than December, the corresponding monthly subperiods are different:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">164</span>]: p <span class="op">=</span> pd.Period(<span class="st">"2011"</span>, freq<span class="op">=</span><span class="st">"A-JUN"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">165</span>]: p</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">165</span>]: Period(<span class="st">'2011'</span>, <span class="st">'A-JUN'</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">166</span>]: p.asfreq(<span class="st">"M"</span>, how<span class="op">=</span><span class="st">"start"</span>)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">166</span>]: Period(<span class="st">'2010-07'</span>, <span class="st">'M'</span>)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">167</span>]: p.asfreq(<span class="st">"M"</span>, how<span class="op">=</span><span class="st">"end"</span>)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">167</span>]: Period(<span class="st">'2011-06'</span>, <span class="st">'M'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-figure_period_asfreq" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/pda3_1101.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;11.1: Period frequency conversion illustration</figcaption>
</figure>
</div>
<p>When you are converting from high to low frequency, pandas determines the subperiod, depending on where the superperiod “belongs.” For example, in <code>A-JUN</code> frequency, the month <code>Aug-2011</code> is actually part of the <code>2012</code> period:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">168</span>]: p <span class="op">=</span> pd.Period(<span class="st">"Aug-2011"</span>, <span class="st">"M"</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">169</span>]: p.asfreq(<span class="st">"A-JUN"</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">169</span>]: Period(<span class="st">'2012'</span>, <span class="st">'A-JUN'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Whole <code>PeriodIndex</code> objects or time series can be similarly converted with the same semantics:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">170</span>]: periods <span class="op">=</span> pd.period_range(<span class="st">"2006"</span>, <span class="st">"2009"</span>, freq<span class="op">=</span><span class="st">"A-DEC"</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">171</span>]: ts <span class="op">=</span> pd.Series(np.random.standard_normal(<span class="bu">len</span>(periods)), index<span class="op">=</span>periods)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">172</span>]: ts</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">172</span>]: </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2006</span>    <span class="fl">1.607578</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2007</span>    <span class="fl">0.200381</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2008</span>   <span class="op">-</span><span class="fl">0.834068</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2009</span>   <span class="op">-</span><span class="fl">0.302988</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>Freq: A<span class="op">-</span>DEC, dtype: float64</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">173</span>]: ts.asfreq(<span class="st">"M"</span>, how<span class="op">=</span><span class="st">"start"</span>)</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">173</span>]: </span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2006</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>    <span class="fl">1.607578</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a><span class="dv">2007</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>    <span class="fl">0.200381</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a><span class="dv">2008</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>   <span class="op">-</span><span class="fl">0.834068</span></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a><span class="dv">2009</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>   <span class="op">-</span><span class="fl">0.302988</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>Freq: M, dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Here, the annual periods are replaced with monthly periods corresponding to the first month falling within each annual period. If we instead wanted the last business day of each year, we can use the <code>"B"</code> frequency and indicate that we want the end of the period:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">174</span>]: ts.asfreq(<span class="st">"B"</span>, how<span class="op">=</span><span class="st">"end"</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">174</span>]: </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2006</span><span class="op">-</span><span class="dv">12</span><span class="op">-</span><span class="dv">29</span>    <span class="fl">1.607578</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2007</span><span class="op">-</span><span class="dv">12</span><span class="op">-</span><span class="dv">31</span>    <span class="fl">0.200381</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2008</span><span class="op">-</span><span class="dv">12</span><span class="op">-</span><span class="dv">31</span>   <span class="op">-</span><span class="fl">0.834068</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2009</span><span class="op">-</span><span class="dv">12</span><span class="op">-</span><span class="dv">31</span>   <span class="op">-</span><span class="fl">0.302988</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>Freq: B, dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="tseries_period_quarterly" class="level3">
<h3 class="anchored" data-anchor-id="tseries_period_quarterly">Quarterly Period Frequencies</h3>
<p>Quarterly data is standard in accounting, finance, and other fields. Much quarterly data is reported relative to a <em>fiscal year end</em>, typically the last calendar or business day of one of the 12 months of the year. Thus, the period <code>2012Q4</code> has a different meaning depending on fiscal year end. pandas supports all 12 possible quarterly frequencies as <code>Q-JAN</code> through <code>Q-DEC</code>:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">175</span>]: p <span class="op">=</span> pd.Period(<span class="st">"2012Q4"</span>, freq<span class="op">=</span><span class="st">"Q-JAN"</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">176</span>]: p</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">176</span>]: Period(<span class="st">'2012Q4'</span>, <span class="st">'Q-JAN'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In the case of a fiscal year ending in January, <code>2012Q4</code> runs from November 2011 through January 2012, which you can check by converting to daily frequency:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">177</span>]: p.asfreq(<span class="st">"D"</span>, how<span class="op">=</span><span class="st">"start"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">177</span>]: Period(<span class="st">'2011-11-01'</span>, <span class="st">'D'</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">178</span>]: p.asfreq(<span class="st">"D"</span>, how<span class="op">=</span><span class="st">"end"</span>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">178</span>]: Period(<span class="st">'2012-01-31'</span>, <span class="st">'D'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>See <a href="#fig-figure_quarterly_periods">Figure&nbsp;<span>11.2</span></a> for an illustration.</p>
<div id="fig-figure_quarterly_periods" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/pda3_1102.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;11.2: Different quarterly frequency conventions</figcaption>
</figure>
</div>
<p>Thus, it’s possible to do convenient period arithmetic; for example, to get the timestamp at 4 P.M. on the second-to-last business day of the quarter, you could do:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">179</span>]: p4pm <span class="op">=</span> (p.asfreq(<span class="st">"B"</span>, how<span class="op">=</span><span class="st">"end"</span>) <span class="op">-</span> <span class="dv">1</span>).asfreq(<span class="st">"T"</span>, how<span class="op">=</span><span class="st">"start"</span>) <span class="op">+</span> <span class="dv">16</span> <span class="op">*</span> <span class="dv">6</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">180</span>]: p4pm</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">180</span>]: Period(<span class="st">'2012-01-30 16:00'</span>, <span class="st">'T'</span>)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">181</span>]: p4pm.to_timestamp()</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">181</span>]: Timestamp(<span class="st">'2012-01-30 16:00:00'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>to_timestamp</code> method returns the <code>Timestamp</code> at the start of the period by default.</p>
<p>You can generate quarterly ranges using <code>pandas.period_range</code>. The arithmetic is identical, too:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">182</span>]: periods <span class="op">=</span> pd.period_range(<span class="st">"2011Q3"</span>, <span class="st">"2012Q4"</span>, freq<span class="op">=</span><span class="st">"Q-JAN"</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">183</span>]: ts <span class="op">=</span> pd.Series(np.arange(<span class="bu">len</span>(periods)), index<span class="op">=</span>periods)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">184</span>]: ts</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">184</span>]: </span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="er">Q3</span>    <span class="dv">0</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="er">Q4</span>    <span class="dv">1</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="er">Q1</span>    <span class="dv">2</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="er">Q2</span>    <span class="dv">3</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="er">Q3</span>    <span class="dv">4</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="er">Q4</span>    <span class="dv">5</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>Freq: Q<span class="op">-</span>JAN, dtype: int64</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">185</span>]: new_periods <span class="op">=</span> (periods.asfreq(<span class="st">"B"</span>, <span class="st">"end"</span>) <span class="op">-</span> <span class="dv">1</span>).asfreq(<span class="st">"H"</span>, <span class="st">"start"</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">186</span>]: ts.index <span class="op">=</span> new_periods.to_timestamp()</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">187</span>]: ts</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">187</span>]: </span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a><span class="dv">2010</span><span class="op">-</span><span class="dv">10</span><span class="op">-</span><span class="dv">28</span> <span class="dv">16</span>:<span class="dv">00</span>:<span class="dv">00</span>    <span class="dv">0</span></span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">28</span> <span class="dv">16</span>:<span class="dv">00</span>:<span class="dv">00</span>    <span class="dv">1</span></span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span><span class="op">-</span><span class="dv">28</span> <span class="dv">16</span>:<span class="dv">00</span>:<span class="dv">00</span>    <span class="dv">2</span></span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">0</span><span class="er">7</span><span class="op">-</span><span class="dv">28</span> <span class="dv">16</span>:<span class="dv">00</span>:<span class="dv">00</span>    <span class="dv">3</span></span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">10</span><span class="op">-</span><span class="dv">28</span> <span class="dv">16</span>:<span class="dv">00</span>:<span class="dv">00</span>    <span class="dv">4</span></span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a><span class="dv">2012</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">30</span> <span class="dv">16</span>:<span class="dv">00</span>:<span class="dv">00</span>    <span class="dv">5</span></span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a>dtype: int64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="tseries_period_stamp_conversion" class="level3">
<h3 class="anchored" data-anchor-id="tseries_period_stamp_conversion">Converting Timestamps to Periods (and Back)</h3>
<p>Series and DataFrame objects indexed by timestamps can be converted to periods with the <code>to_period</code> method:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">188</span>]: dates <span class="op">=</span> pd.date_range(<span class="st">"2000-01-01"</span>, periods<span class="op">=</span><span class="dv">3</span>, freq<span class="op">=</span><span class="st">"M"</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">189</span>]: ts <span class="op">=</span> pd.Series(np.random.standard_normal(<span class="dv">3</span>), index<span class="op">=</span>dates)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">190</span>]: ts</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">190</span>]: </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">31</span>    <span class="fl">1.663261</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">29</span>   <span class="op">-</span><span class="fl">0.996206</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">31</span>    <span class="fl">1.521760</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>Freq: M, dtype: float64</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">191</span>]: pts <span class="op">=</span> ts.to_period()</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">192</span>]: pts</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">192</span>]: </span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>    <span class="fl">1.663261</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>   <span class="op">-</span><span class="fl">0.996206</span></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>    <span class="fl">1.521760</span></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>Freq: M, dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Since periods refer to nonoverlapping time spans, a timestamp can only belong to a single period for a given frequency. While the frequency of the new <code>PeriodIndex</code> is inferred from the timestamps by default, you can specify any supported frequency (most of those listed in <a href="#tbl-table_base_frequencies">Table&nbsp;<span>11.4</span></a> are supported). There is also no problem with having duplicate periods in the result:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">193</span>]: dates <span class="op">=</span> pd.date_range(<span class="st">"2000-01-29"</span>, periods<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">194</span>]: ts2 <span class="op">=</span> pd.Series(np.random.standard_normal(<span class="dv">6</span>), index<span class="op">=</span>dates)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">195</span>]: ts2</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">195</span>]: </span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">29</span>    <span class="fl">0.244175</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">30</span>    <span class="fl">0.423331</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">31</span>   <span class="op">-</span><span class="fl">0.654040</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>    <span class="fl">2.089154</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>   <span class="op">-</span><span class="fl">0.060220</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>   <span class="op">-</span><span class="fl">0.167933</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>Freq: D, dtype: float64</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">196</span>]: ts2.to_period(<span class="st">"M"</span>)</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">196</span>]: </span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>    <span class="fl">0.244175</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>    <span class="fl">0.423331</span></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>   <span class="op">-</span><span class="fl">0.654040</span></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>    <span class="fl">2.089154</span></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>   <span class="op">-</span><span class="fl">0.060220</span></span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>   <span class="op">-</span><span class="fl">0.167933</span></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>Freq: M, dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To convert back to timestamps, use the <code>to_timestamp</code> method, which returns a <code>DatetimeIndex</code>:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">197</span>]: pts <span class="op">=</span> ts2.to_period()</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">198</span>]: pts</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">198</span>]: </span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">29</span>    <span class="fl">0.244175</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">30</span>    <span class="fl">0.423331</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">31</span>   <span class="op">-</span><span class="fl">0.654040</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>    <span class="fl">2.089154</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>   <span class="op">-</span><span class="fl">0.060220</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>   <span class="op">-</span><span class="fl">0.167933</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>Freq: D, dtype: float64</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">199</span>]: pts.to_timestamp(how<span class="op">=</span><span class="st">"end"</span>)</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">199</span>]: </span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">29</span> <span class="dv">23</span>:<span class="dv">59</span>:<span class="fl">59.999999999</span>    <span class="fl">0.244175</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">30</span> <span class="dv">23</span>:<span class="dv">59</span>:<span class="fl">59.999999999</span>    <span class="fl">0.423331</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">31</span> <span class="dv">23</span>:<span class="dv">59</span>:<span class="fl">59.999999999</span>   <span class="op">-</span><span class="fl">0.654040</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">23</span>:<span class="dv">59</span>:<span class="fl">59.999999999</span>    <span class="fl">2.089154</span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span> <span class="dv">23</span>:<span class="dv">59</span>:<span class="fl">59.999999999</span>   <span class="op">-</span><span class="fl">0.060220</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span> <span class="dv">23</span>:<span class="dv">59</span>:<span class="fl">59.999999999</span>   <span class="op">-</span><span class="fl">0.167933</span></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>Freq: D, dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="tseries_period_arrays" class="level3">
<h3 class="anchored" data-anchor-id="tseries_period_arrays">Creating a PeriodIndex from Arrays</h3>
<p>Fixed frequency datasets are sometimes stored with time span information spread across multiple columns. For example, in this macroeconomic dataset, the year and quarter are in different columns:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">200</span>]: data <span class="op">=</span> pd.read_csv(<span class="st">"examples/macrodata.csv"</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">201</span>]: data.head(<span class="dv">5</span>)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">201</span>]: </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>   year  quarter   realgdp  realcons  realinv  realgovt  realdpi    cpi   </span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="dv">1959</span>        <span class="dv">1</span>  <span class="fl">2710.349</span>    <span class="fl">1707.4</span>  <span class="fl">286.898</span>   <span class="fl">470.045</span>   <span class="fl">1886.9</span>  <span class="fl">28.98</span>  <span class="op">\</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">1959</span>        <span class="dv">2</span>  <span class="fl">2778.801</span>    <span class="fl">1733.7</span>  <span class="fl">310.859</span>   <span class="fl">481.301</span>   <span class="fl">1919.7</span>  <span class="fl">29.15</span>   </span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">1959</span>        <span class="dv">3</span>  <span class="fl">2775.488</span>    <span class="fl">1751.8</span>  <span class="fl">289.226</span>   <span class="fl">491.260</span>   <span class="fl">1916.4</span>  <span class="fl">29.35</span>   </span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">1959</span>        <span class="dv">4</span>  <span class="fl">2785.204</span>    <span class="fl">1753.7</span>  <span class="fl">299.356</span>   <span class="fl">484.052</span>   <span class="fl">1931.3</span>  <span class="fl">29.37</span>   </span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="dv">1960</span>        <span class="dv">1</span>  <span class="fl">2847.699</span>    <span class="fl">1770.5</span>  <span class="fl">331.722</span>   <span class="fl">462.199</span>   <span class="fl">1955.5</span>  <span class="fl">29.54</span>   </span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>      m1  tbilrate  unemp      pop  infl  realint  </span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="fl">139.7</span>      <span class="fl">2.82</span>    <span class="fl">5.8</span>  <span class="fl">177.146</span>  <span class="fl">0.00</span>     <span class="fl">0.00</span>  </span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="fl">141.7</span>      <span class="fl">3.08</span>    <span class="fl">5.1</span>  <span class="fl">177.830</span>  <span class="fl">2.34</span>     <span class="fl">0.74</span>  </span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="fl">140.5</span>      <span class="fl">3.82</span>    <span class="fl">5.3</span>  <span class="fl">178.657</span>  <span class="fl">2.74</span>     <span class="fl">1.09</span>  </span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="fl">140.0</span>      <span class="fl">4.33</span>    <span class="fl">5.6</span>  <span class="fl">179.386</span>  <span class="fl">0.27</span>     <span class="fl">4.06</span>  </span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="fl">139.6</span>      <span class="fl">3.50</span>    <span class="fl">5.2</span>  <span class="fl">180.007</span>  <span class="fl">2.31</span>     <span class="fl">1.19</span>  </span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">202</span>]: data[<span class="st">"year"</span>]</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">202</span>]: </span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>      <span class="dv">1959</span></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      <span class="dv">1959</span></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      <span class="dv">1959</span></span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      <span class="dv">1959</span></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      <span class="dv">1960</span></span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>       ... </span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a><span class="dv">198</span>    <span class="dv">2008</span></span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a><span class="dv">199</span>    <span class="dv">2008</span></span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a><span class="dv">200</span>    <span class="dv">2009</span></span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a><span class="dv">201</span>    <span class="dv">2009</span></span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a><span class="dv">202</span>    <span class="dv">2009</span></span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a>Name: year, Length: <span class="dv">203</span>, dtype: int64</span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-33"><a href="#cb80-33" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">203</span>]: data[<span class="st">"quarter"</span>]</span>
<span id="cb80-34"><a href="#cb80-34" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">203</span>]: </span>
<span id="cb80-35"><a href="#cb80-35" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>      <span class="dv">1</span></span>
<span id="cb80-36"><a href="#cb80-36" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      <span class="dv">2</span></span>
<span id="cb80-37"><a href="#cb80-37" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>      <span class="dv">3</span></span>
<span id="cb80-38"><a href="#cb80-38" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>      <span class="dv">4</span></span>
<span id="cb80-39"><a href="#cb80-39" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>      <span class="dv">1</span></span>
<span id="cb80-40"><a href="#cb80-40" aria-hidden="true" tabindex="-1"></a>      ..</span>
<span id="cb80-41"><a href="#cb80-41" aria-hidden="true" tabindex="-1"></a><span class="dv">198</span>    <span class="dv">3</span></span>
<span id="cb80-42"><a href="#cb80-42" aria-hidden="true" tabindex="-1"></a><span class="dv">199</span>    <span class="dv">4</span></span>
<span id="cb80-43"><a href="#cb80-43" aria-hidden="true" tabindex="-1"></a><span class="dv">200</span>    <span class="dv">1</span></span>
<span id="cb80-44"><a href="#cb80-44" aria-hidden="true" tabindex="-1"></a><span class="dv">201</span>    <span class="dv">2</span></span>
<span id="cb80-45"><a href="#cb80-45" aria-hidden="true" tabindex="-1"></a><span class="dv">202</span>    <span class="dv">3</span></span>
<span id="cb80-46"><a href="#cb80-46" aria-hidden="true" tabindex="-1"></a>Name: quarter, Length: <span class="dv">203</span>, dtype: int64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>By passing these arrays to <code>PeriodIndex</code> with a frequency, you can combine them to form an index for the DataFrame:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">204</span>]: index <span class="op">=</span> pd.PeriodIndex(year<span class="op">=</span>data[<span class="st">"year"</span>], quarter<span class="op">=</span>data[<span class="st">"quarter"</span>],</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>   .....:                        freq<span class="op">=</span><span class="st">"Q-DEC"</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">205</span>]: index</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">205</span>]: </span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>PeriodIndex([<span class="st">'1959Q1'</span>, <span class="st">'1959Q2'</span>, <span class="st">'1959Q3'</span>, <span class="st">'1959Q4'</span>, <span class="st">'1960Q1'</span>, <span class="st">'1960Q2'</span>,</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">'1960Q3'</span>, <span class="st">'1960Q4'</span>, <span class="st">'1961Q1'</span>, <span class="st">'1961Q2'</span>,</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>             ...</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>             <span class="st">'2007Q2'</span>, <span class="st">'2007Q3'</span>, <span class="st">'2007Q4'</span>, <span class="st">'2008Q1'</span>, <span class="st">'2008Q2'</span>, <span class="st">'2008Q3'</span>,</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>             <span class="st">'2008Q4'</span>, <span class="st">'2009Q1'</span>, <span class="st">'2009Q2'</span>, <span class="st">'2009Q3'</span>],</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>            dtype<span class="op">=</span><span class="st">'period[Q-DEC]'</span>, length<span class="op">=</span><span class="dv">203</span>)</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">206</span>]: data.index <span class="op">=</span> index</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">207</span>]: data[<span class="st">"infl"</span>]</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">207</span>]: </span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a><span class="dv">1959</span><span class="er">Q1</span>    <span class="fl">0.00</span></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a><span class="dv">1959</span><span class="er">Q2</span>    <span class="fl">2.34</span></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a><span class="dv">1959</span><span class="er">Q3</span>    <span class="fl">2.74</span></span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a><span class="dv">1959</span><span class="er">Q4</span>    <span class="fl">0.27</span></span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a><span class="dv">1960</span><span class="er">Q1</span>    <span class="fl">2.31</span></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>          ... </span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a><span class="dv">2008</span><span class="er">Q3</span>   <span class="op">-</span><span class="fl">3.16</span></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a><span class="dv">2008</span><span class="er">Q4</span>   <span class="op">-</span><span class="fl">8.79</span></span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a><span class="dv">2009</span><span class="er">Q1</span>    <span class="fl">0.94</span></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a><span class="dv">2009</span><span class="er">Q2</span>    <span class="fl">3.37</span></span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a><span class="dv">2009</span><span class="er">Q3</span>    <span class="fl">3.56</span></span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>Freq: Q<span class="op">-</span>DEC, Name: infl, Length: <span class="dv">203</span>, dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="tseries_resampling" class="level2" data-number="11.6">
<h2 data-number="11.6" class="anchored" data-anchor-id="tseries_resampling"><span class="header-section-number">11.6</span> Resampling and Frequency Conversion</h2>
<p><em>Resampling</em> refers to the process of converting a time series from one frequency to another. Aggregating higher frequency data to lower frequency is called <em>downsampling</em>, while converting lower frequency to higher frequency is called <em>upsampling</em>. Not all resampling falls into either of these categories; for example, converting <code>W-WED</code> (weekly on Wednesday) to <code>W-FRI</code> is neither upsampling nor downsampling.</p>
<p>pandas objects are equipped with a <code>resample</code> method, which is the workhorse function for all frequency conversion. <code>resample</code> has a similar API to <code>groupby</code>; you call <code>resample</code> to group the data, then call an aggregation function:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">208</span>]: dates <span class="op">=</span> pd.date_range(<span class="st">"2000-01-01"</span>, periods<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">209</span>]: ts <span class="op">=</span> pd.Series(np.random.standard_normal(<span class="bu">len</span>(dates)), index<span class="op">=</span>dates)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">210</span>]: ts</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">210</span>]: </span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>    <span class="fl">0.631634</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>   <span class="op">-</span><span class="fl">1.594313</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>   <span class="op">-</span><span class="fl">1.519937</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span>    <span class="fl">1.108752</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span>    <span class="fl">1.255853</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>                ...   </span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span>   <span class="op">-</span><span class="fl">0.423776</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span><span class="op">-</span><span class="dv">0</span><span class="er">6</span>    <span class="fl">0.789740</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span><span class="op">-</span><span class="dv">0</span><span class="er">7</span>    <span class="fl">0.937568</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span><span class="op">-</span><span class="dv">0</span><span class="er">8</span>   <span class="op">-</span><span class="fl">2.253294</span></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span>   <span class="op">-</span><span class="fl">1.772919</span></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>Freq: D, Length: <span class="dv">100</span>, dtype: float64</span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">211</span>]: ts.resample(<span class="st">"M"</span>).mean()</span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">211</span>]: </span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">31</span>   <span class="op">-</span><span class="fl">0.165893</span></span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span><span class="op">-</span><span class="dv">29</span>    <span class="fl">0.078606</span></span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span><span class="op">-</span><span class="dv">31</span>    <span class="fl">0.223811</span></span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span><span class="op">-</span><span class="dv">30</span>   <span class="op">-</span><span class="fl">0.063643</span></span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a>Freq: M, dtype: float64</span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">212</span>]: ts.resample(<span class="st">"M"</span>, kind<span class="op">=</span><span class="st">"period"</span>).mean()</span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">212</span>]: </span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span>   <span class="op">-</span><span class="fl">0.165893</span></span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>    <span class="fl">0.078606</span></span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>    <span class="fl">0.223811</span></span>
<span id="cb82-33"><a href="#cb82-33" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span>   <span class="op">-</span><span class="fl">0.063643</span></span>
<span id="cb82-34"><a href="#cb82-34" aria-hidden="true" tabindex="-1"></a>Freq: M, dtype: float64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>resample</code> is a flexible method that can be used to process large time series. The examples in the following sections illustrate its semantics and use. <a href="#tbl-table_resample_method">Table&nbsp;<span>11.5</span></a> summarizes some of its options.</p>
<div id="tbl-table_resample_method" class="anchored">
<table class="table">
<caption>Table&nbsp;11.5: <code>resample</code> method arguments</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Argument</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>rule</code></td>
<td style="text-align: left;">String, DateOffset, or timedelta indicating desired resampled frequency (for example, ’M', ’5min', or <code>Second(15)</code>)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>axis</code></td>
<td style="text-align: left;">Axis to resample on; default <code>axis=0</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>fill_method</code></td>
<td style="text-align: left;">How to interpolate when upsampling, as in <code>"ffill"</code> or <code>"bfill"</code>; by default does no interpolation</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>closed</code></td>
<td style="text-align: left;">In downsampling, which end of each interval is closed (inclusive), <code>"right"</code> or <code>"left"</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>label</code></td>
<td style="text-align: left;">In downsampling, how to label the aggregated result, with the <code>"right"</code> or <code>"left"</code> bin edge (e.g., the 9:30 to 9:35 five-minute interval could be labeled <code>9:30</code> or <code>9:35</code>)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>limit</code></td>
<td style="text-align: left;">When forward or backward filling, the maximum number of periods to fill</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>kind</code></td>
<td style="text-align: left;">Aggregate to periods (<code>"period"</code>) or timestamps (<code>"timestamp"</code>); defaults to the type of index the time series has</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>convention</code></td>
<td style="text-align: left;">When resampling periods, the convention (<code>"start"</code> or <code>"end"</code>) for converting the low-frequency period to high frequency; defaults to <code>"start"</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>origin</code></td>
<td style="text-align: left;">The "base" timestamp from which to determine the resampling bin edges; can also be one of <code>"epoch"</code>, <code>"start"</code>, <code>"start_day"</code>, <code>"end"</code>, or <code>"end_day"</code>; see the <code>resample</code> docstring for full details</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>offset</code></td>
<td style="text-align: left;">An offset timedelta added to the origin; defaults to <code>None</code></td>
</tr>
</tbody>
</table>
</div>
<section id="tseries_resample_hi_to_low" class="level3">
<h3 class="anchored" data-anchor-id="tseries_resample_hi_to_low">Downsampling</h3>
<p><em>Downsampling</em> is aggregating data to a regular, lower frequency. The data you’re aggregating doesn’t need to be fixed frequently; the desired frequency defines <em>bin edges</em> that are used to slice the time series into pieces to aggregate. For example, to convert to monthly, <code>"M"</code> or <code>"BM"</code>, you need to chop up the data into one-month intervals. Each interval is said to be <em>half-open</em>; a data point can belong only to one interval, and the union of the intervals must make up the whole time frame. There are a couple things to think about when using <code>resample</code> to downsample data:</p>
<ul>
<li><p>Which side of each interval is <em>closed</em></p></li>
<li><p>How to label each aggregated bin, either with the start of the interval or the end</p></li>
</ul>
<p>To illustrate, let’s look at some one-minute frequency data:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">213</span>]: dates <span class="op">=</span> pd.date_range(<span class="st">"2000-01-01"</span>, periods<span class="op">=</span><span class="dv">12</span>, freq<span class="op">=</span><span class="st">"T"</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">214</span>]: ts <span class="op">=</span> pd.Series(np.arange(<span class="bu">len</span>(dates)), index<span class="op">=</span>dates)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">215</span>]: ts</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">215</span>]: </span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">00</span>:<span class="dv">00</span>     <span class="dv">0</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">1</span>:<span class="dv">00</span>     <span class="dv">1</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">2</span>:<span class="dv">00</span>     <span class="dv">2</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">3</span>:<span class="dv">00</span>     <span class="dv">3</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">4</span>:<span class="dv">00</span>     <span class="dv">4</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">5</span>:<span class="dv">00</span>     <span class="dv">5</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">6</span>:<span class="dv">00</span>     <span class="dv">6</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">7</span>:<span class="dv">00</span>     <span class="dv">7</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">8</span>:<span class="dv">00</span>     <span class="dv">8</span></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">9</span>:<span class="dv">00</span>     <span class="dv">9</span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">10</span>:<span class="dv">00</span>    <span class="dv">10</span></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">11</span>:<span class="dv">00</span>    <span class="dv">11</span></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>Freq: T, dtype: int64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Suppose you wanted to aggregate this data into five-minute chunks or <em>bars</em> by taking the sum of each group:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">216</span>]: ts.resample(<span class="st">"5min"</span>).<span class="bu">sum</span>()</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">216</span>]: </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">00</span>:<span class="dv">00</span>    <span class="dv">10</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">5</span>:<span class="dv">00</span>    <span class="dv">35</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">10</span>:<span class="dv">00</span>    <span class="dv">21</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>Freq: <span class="dv">5</span><span class="er">T</span>, dtype: int64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The frequency you pass defines bin edges in five-minute increments. For this frequency, by default the <em>left</em> bin edge is inclusive, so the <code>00:00</code> value is included in the <code>00:00</code> to <code>00:05</code> interval, and the <code>00:05</code> value is excluded from that interval.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">217</span>]: ts.resample(<span class="st">"5min"</span>, closed<span class="op">=</span><span class="st">"right"</span>).<span class="bu">sum</span>()</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">217</span>]: </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1999</span><span class="op">-</span><span class="dv">12</span><span class="op">-</span><span class="dv">31</span> <span class="dv">23</span>:<span class="dv">55</span>:<span class="dv">00</span>     <span class="dv">0</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">00</span>:<span class="dv">00</span>    <span class="dv">15</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">5</span>:<span class="dv">00</span>    <span class="dv">40</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">10</span>:<span class="dv">00</span>    <span class="dv">11</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>Freq: <span class="dv">5</span><span class="er">T</span>, dtype: int64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The resulting time series is labeled by the timestamps from the left side of each bin. By passing <code>label="right"</code> you can label them with the right bin edge:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">218</span>]: ts.resample(<span class="st">"5min"</span>, closed<span class="op">=</span><span class="st">"right"</span>, label<span class="op">=</span><span class="st">"right"</span>).<span class="bu">sum</span>()</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">218</span>]: </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">00</span>:<span class="dv">00</span>     <span class="dv">0</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">5</span>:<span class="dv">00</span>    <span class="dv">15</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">10</span>:<span class="dv">00</span>    <span class="dv">40</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">15</span>:<span class="dv">00</span>    <span class="dv">11</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>Freq: <span class="dv">5</span><span class="er">T</span>, dtype: int64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>See <a href="#fig-figure_resample_conventions">Figure&nbsp;<span>11.3</span></a> for an illustration of minute frequency data being resampled to five-minute frequency.</p>
<div id="fig-figure_resample_conventions" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/pda3_1103.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;11.3: Five-minute resampling illustration of closed, label conventions</figcaption>
</figure>
</div>
<p>Lastly, you might want to shift the result index by some amount, say subtracting one second from the right edge to make it more clear which interval the timestamp refers to. To do this, add an offset to the resulting index:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">219</span>]: <span class="im">from</span> pandas.tseries.frequencies <span class="im">import</span> to_offset</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">220</span>]: result <span class="op">=</span> ts.resample(<span class="st">"5min"</span>, closed<span class="op">=</span><span class="st">"right"</span>, label<span class="op">=</span><span class="st">"right"</span>).<span class="bu">sum</span>()</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">221</span>]: result.index <span class="op">=</span> result.index <span class="op">+</span> to_offset(<span class="st">"-1s"</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">222</span>]: result</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">222</span>]: </span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1999</span><span class="op">-</span><span class="dv">12</span><span class="op">-</span><span class="dv">31</span> <span class="dv">23</span>:<span class="dv">59</span>:<span class="dv">59</span>     <span class="dv">0</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">4</span>:<span class="dv">59</span>    <span class="dv">15</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">9</span>:<span class="dv">59</span>    <span class="dv">40</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">14</span>:<span class="dv">59</span>    <span class="dv">11</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>Freq: <span class="dv">5</span><span class="er">T</span>, dtype: int64</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="tseries_resample_ohlc" class="level4">
<h4 class="anchored" data-anchor-id="tseries_resample_ohlc">Open-high-low-close (OHLC) resampling</h4>
<p>In finance, a popular way to aggregate a time series is to compute four values for each bucket: the first (open), last (close), maximum (high), and minimal (low) values. By using the <code>ohlc</code> aggregate function, you will obtain a DataFrame having columns containing these four aggregates, which are efficiently computed in a single function call:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">223</span>]: ts <span class="op">=</span> pd.Series(np.random.permutation(np.arange(<span class="bu">len</span>(dates))), index<span class="op">=</span>date</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>s)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">224</span>]: ts.resample(<span class="st">"5min"</span>).ohlc()</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">224</span>]: </span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>                     <span class="bu">open</span>  high  low  close</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">00</span>:<span class="dv">00</span>     <span class="dv">8</span>     <span class="dv">8</span>    <span class="dv">1</span>      <span class="dv">5</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">5</span>:<span class="dv">00</span>     <span class="dv">6</span>    <span class="dv">11</span>    <span class="dv">2</span>      <span class="dv">2</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="dv">00</span>:<span class="dv">10</span>:<span class="dv">00</span>     <span class="dv">0</span>     <span class="dv">7</span>    <span class="dv">0</span>      <span class="dv">7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="tseries_resample_lo_to_high" class="level3">
<h3 class="anchored" data-anchor-id="tseries_resample_lo_to_high">Upsampling and Interpolation</h3>
<p>Upsampling is converting from a lower frequency to a higher frequency, where no aggregation is needed. Let’s consider a DataFrame with some weekly data:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">225</span>]: frame <span class="op">=</span> pd.DataFrame(np.random.standard_normal((<span class="dv">2</span>, <span class="dv">4</span>)),</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>   .....:                      index<span class="op">=</span>pd.date_range(<span class="st">"2000-01-01"</span>, periods<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>   .....:                                          freq<span class="op">=</span><span class="st">"W-WED"</span>),</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>   .....:                      columns<span class="op">=</span>[<span class="st">"Colorado"</span>, <span class="st">"Texas"</span>, <span class="st">"New York"</span>, <span class="st">"Ohio"</span>])</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">226</span>]: frame</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">226</span>]: </span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>            Colorado     Texas  New York      Ohio</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span> <span class="op">-</span><span class="fl">0.896431</span>  <span class="fl">0.927238</span>  <span class="fl">0.482284</span> <span class="op">-</span><span class="fl">0.867130</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">12</span>  <span class="fl">0.493841</span> <span class="op">-</span><span class="fl">0.155434</span>  <span class="fl">1.397286</span>  <span class="fl">1.507055</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>When you are using an aggregation function with this data, there is only one value per group, and missing values result in the gaps. We use the <code>asfreq</code> method to convert to the higher frequency without any aggregation:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">227</span>]: df_daily <span class="op">=</span> frame.resample(<span class="st">"D"</span>).asfreq()</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">228</span>]: df_daily</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">228</span>]: </span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>            Colorado     Texas  New York      Ohio</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span> <span class="op">-</span><span class="fl">0.896431</span>  <span class="fl">0.927238</span>  <span class="fl">0.482284</span> <span class="op">-</span><span class="fl">0.867130</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">6</span>       NaN       NaN       NaN       NaN</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">7</span>       NaN       NaN       NaN       NaN</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">8</span>       NaN       NaN       NaN       NaN</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span>       NaN       NaN       NaN       NaN</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">10</span>       NaN       NaN       NaN       NaN</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">11</span>       NaN       NaN       NaN       NaN</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">12</span>  <span class="fl">0.493841</span> <span class="op">-</span><span class="fl">0.155434</span>  <span class="fl">1.397286</span>  <span class="fl">1.507055</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Suppose you wanted to fill forward each weekly value on the non-Wednesdays. The same filling or interpolation methods available in the <code>fillna</code> and <code>reindex</code> methods are available for resampling:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">229</span>]: frame.resample(<span class="st">"D"</span>).ffill()</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">229</span>]: </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>            Colorado     Texas  New York      Ohio</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span> <span class="op">-</span><span class="fl">0.896431</span>  <span class="fl">0.927238</span>  <span class="fl">0.482284</span> <span class="op">-</span><span class="fl">0.867130</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">6</span> <span class="op">-</span><span class="fl">0.896431</span>  <span class="fl">0.927238</span>  <span class="fl">0.482284</span> <span class="op">-</span><span class="fl">0.867130</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">7</span> <span class="op">-</span><span class="fl">0.896431</span>  <span class="fl">0.927238</span>  <span class="fl">0.482284</span> <span class="op">-</span><span class="fl">0.867130</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">8</span> <span class="op">-</span><span class="fl">0.896431</span>  <span class="fl">0.927238</span>  <span class="fl">0.482284</span> <span class="op">-</span><span class="fl">0.867130</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span> <span class="op">-</span><span class="fl">0.896431</span>  <span class="fl">0.927238</span>  <span class="fl">0.482284</span> <span class="op">-</span><span class="fl">0.867130</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">10</span> <span class="op">-</span><span class="fl">0.896431</span>  <span class="fl">0.927238</span>  <span class="fl">0.482284</span> <span class="op">-</span><span class="fl">0.867130</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">11</span> <span class="op">-</span><span class="fl">0.896431</span>  <span class="fl">0.927238</span>  <span class="fl">0.482284</span> <span class="op">-</span><span class="fl">0.867130</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">12</span>  <span class="fl">0.493841</span> <span class="op">-</span><span class="fl">0.155434</span>  <span class="fl">1.397286</span>  <span class="fl">1.507055</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can similarly choose to only fill a certain number of periods forward to limit how far to continue using an observed value:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">230</span>]: frame.resample(<span class="st">"D"</span>).ffill(limit<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">230</span>]: </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>            Colorado     Texas  New York      Ohio</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span> <span class="op">-</span><span class="fl">0.896431</span>  <span class="fl">0.927238</span>  <span class="fl">0.482284</span> <span class="op">-</span><span class="fl">0.867130</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">6</span> <span class="op">-</span><span class="fl">0.896431</span>  <span class="fl">0.927238</span>  <span class="fl">0.482284</span> <span class="op">-</span><span class="fl">0.867130</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">7</span> <span class="op">-</span><span class="fl">0.896431</span>  <span class="fl">0.927238</span>  <span class="fl">0.482284</span> <span class="op">-</span><span class="fl">0.867130</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">8</span>       NaN       NaN       NaN       NaN</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span>       NaN       NaN       NaN       NaN</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">10</span>       NaN       NaN       NaN       NaN</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">11</span>       NaN       NaN       NaN       NaN</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">12</span>  <span class="fl">0.493841</span> <span class="op">-</span><span class="fl">0.155434</span>  <span class="fl">1.397286</span>  <span class="fl">1.507055</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Notably, the new date index need not coincide with the old one at all:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">231</span>]: frame.resample(<span class="st">"W-THU"</span>).ffill()</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">231</span>]: </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>            Colorado     Texas  New York      Ohio</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">6</span> <span class="op">-</span><span class="fl">0.896431</span>  <span class="fl">0.927238</span>  <span class="fl">0.482284</span> <span class="op">-</span><span class="fl">0.867130</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">13</span>  <span class="fl">0.493841</span> <span class="op">-</span><span class="fl">0.155434</span>  <span class="fl">1.397286</span>  <span class="fl">1.507055</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="tseries_period_resampling" class="level3">
<h3 class="anchored" data-anchor-id="tseries_period_resampling">Resampling with Periods</h3>
<p>Resampling data indexed by periods is similar to timestamps:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">232</span>]: frame <span class="op">=</span> pd.DataFrame(np.random.standard_normal((<span class="dv">24</span>, <span class="dv">4</span>)),</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>   .....:                      index<span class="op">=</span>pd.period_range(<span class="st">"1-2000"</span>, <span class="st">"12-2001"</span>,</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>   .....:                                            freq<span class="op">=</span><span class="st">"M"</span>),</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>   .....:                      columns<span class="op">=</span>[<span class="st">"Colorado"</span>, <span class="st">"Texas"</span>, <span class="st">"New York"</span>, <span class="st">"Ohio"</span>])</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">233</span>]: frame.head()</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">233</span>]: </span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>         Colorado     Texas  New York      Ohio</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span> <span class="op">-</span><span class="fl">1.179442</span>  <span class="fl">0.443171</span>  <span class="fl">1.395676</span> <span class="op">-</span><span class="fl">0.529658</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>  <span class="fl">0.787358</span>  <span class="fl">0.248845</span>  <span class="fl">0.743239</span>  <span class="fl">1.267746</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>  <span class="fl">1.302395</span> <span class="op">-</span><span class="fl">0.272154</span> <span class="op">-</span><span class="fl">0.051532</span> <span class="op">-</span><span class="fl">0.467740</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">4</span> <span class="op">-</span><span class="fl">1.040816</span>  <span class="fl">0.426419</span>  <span class="fl">0.312945</span> <span class="op">-</span><span class="fl">1.115689</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span>  <span class="fl">1.234297</span> <span class="op">-</span><span class="fl">1.893094</span> <span class="op">-</span><span class="fl">1.661605</span> <span class="op">-</span><span class="fl">0.005477</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">234</span>]: annual_frame <span class="op">=</span> frame.resample(<span class="st">"A-DEC"</span>).mean()</span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">235</span>]: annual_frame</span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">235</span>]: </span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>      Colorado     Texas  New York      Ohio</span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span>  <span class="fl">0.487329</span>  <span class="fl">0.104466</span>  <span class="fl">0.020495</span> <span class="op">-</span><span class="fl">0.273945</span></span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span>  <span class="fl">0.203125</span>  <span class="fl">0.162429</span>  <span class="fl">0.056146</span> <span class="op">-</span><span class="fl">0.103794</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Upsampling is more nuanced, as before resampling you must make a decision about which end of the time span in the new frequency to place the values. The <code>convention</code> argument defaults to <code>"start"</code> but can also be <code>"end"</code>:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Q-DEC: Quarterly, year ending in December</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">236</span>]: annual_frame.resample(<span class="st">"Q-DEC"</span>).ffill()</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">236</span>]: </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>        Colorado     Texas  New York      Ohio</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="er">Q1</span>  <span class="fl">0.487329</span>  <span class="fl">0.104466</span>  <span class="fl">0.020495</span> <span class="op">-</span><span class="fl">0.273945</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="er">Q2</span>  <span class="fl">0.487329</span>  <span class="fl">0.104466</span>  <span class="fl">0.020495</span> <span class="op">-</span><span class="fl">0.273945</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="er">Q3</span>  <span class="fl">0.487329</span>  <span class="fl">0.104466</span>  <span class="fl">0.020495</span> <span class="op">-</span><span class="fl">0.273945</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="er">Q4</span>  <span class="fl">0.487329</span>  <span class="fl">0.104466</span>  <span class="fl">0.020495</span> <span class="op">-</span><span class="fl">0.273945</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="er">Q1</span>  <span class="fl">0.203125</span>  <span class="fl">0.162429</span>  <span class="fl">0.056146</span> <span class="op">-</span><span class="fl">0.103794</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="er">Q2</span>  <span class="fl">0.203125</span>  <span class="fl">0.162429</span>  <span class="fl">0.056146</span> <span class="op">-</span><span class="fl">0.103794</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="er">Q3</span>  <span class="fl">0.203125</span>  <span class="fl">0.162429</span>  <span class="fl">0.056146</span> <span class="op">-</span><span class="fl">0.103794</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="er">Q4</span>  <span class="fl">0.203125</span>  <span class="fl">0.162429</span>  <span class="fl">0.056146</span> <span class="op">-</span><span class="fl">0.103794</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">237</span>]: annual_frame.resample(<span class="st">"Q-DEC"</span>, convention<span class="op">=</span><span class="st">"end"</span>).asfreq()</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">237</span>]: </span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>        Colorado     Texas  New York      Ohio</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="er">Q4</span>  <span class="fl">0.487329</span>  <span class="fl">0.104466</span>  <span class="fl">0.020495</span> <span class="op">-</span><span class="fl">0.273945</span></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="er">Q1</span>       NaN       NaN       NaN       NaN</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="er">Q2</span>       NaN       NaN       NaN       NaN</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="er">Q3</span>       NaN       NaN       NaN       NaN</span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="er">Q4</span>  <span class="fl">0.203125</span>  <span class="fl">0.162429</span>  <span class="fl">0.056146</span> <span class="op">-</span><span class="fl">0.103794</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Since periods refer to time spans, the rules about upsampling and downsampling are more rigid:</p>
<ul>
<li><p>In downsampling, the target frequency must be a <em>subperiod</em> of the source frequency.</p></li>
<li><p>In upsampling, the target frequency must be a <em>superperiod</em> of the source frequency.</p></li>
</ul>
<p>If these rules are not satisfied, an exception will be raised. This mainly affects the quarterly, annual, and weekly frequencies; for example, the time spans defined by <code>Q-MAR</code> only line up with <code>A-MAR</code>, <code>A-JUN</code>, <code>A-SEP</code>, and <code>A-DEC</code>:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">238</span>]: annual_frame.resample(<span class="st">"Q-MAR"</span>).ffill()</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">238</span>]: </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>        Colorado     Texas  New York      Ohio</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2000</span><span class="er">Q4</span>  <span class="fl">0.487329</span>  <span class="fl">0.104466</span>  <span class="fl">0.020495</span> <span class="op">-</span><span class="fl">0.273945</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="er">Q1</span>  <span class="fl">0.487329</span>  <span class="fl">0.104466</span>  <span class="fl">0.020495</span> <span class="op">-</span><span class="fl">0.273945</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="er">Q2</span>  <span class="fl">0.487329</span>  <span class="fl">0.104466</span>  <span class="fl">0.020495</span> <span class="op">-</span><span class="fl">0.273945</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="er">Q3</span>  <span class="fl">0.487329</span>  <span class="fl">0.104466</span>  <span class="fl">0.020495</span> <span class="op">-</span><span class="fl">0.273945</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2001</span><span class="er">Q4</span>  <span class="fl">0.203125</span>  <span class="fl">0.162429</span>  <span class="fl">0.056146</span> <span class="op">-</span><span class="fl">0.103794</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2002</span><span class="er">Q1</span>  <span class="fl">0.203125</span>  <span class="fl">0.162429</span>  <span class="fl">0.056146</span> <span class="op">-</span><span class="fl">0.103794</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2002</span><span class="er">Q2</span>  <span class="fl">0.203125</span>  <span class="fl">0.162429</span>  <span class="fl">0.056146</span> <span class="op">-</span><span class="fl">0.103794</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2002</span><span class="er">Q3</span>  <span class="fl">0.203125</span>  <span class="fl">0.162429</span>  <span class="fl">0.056146</span> <span class="op">-</span><span class="fl">0.103794</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="pandas-groupby-timegrouper" class="level3">
<h3 class="anchored" data-anchor-id="pandas-groupby-timegrouper">Grouped Time Resampling</h3>
<p>For time series data, the <code>resample</code> method is semantically a group operation based on a time intervalization. Here's a small example table:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">239</span>]: N <span class="op">=</span> <span class="dv">15</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">240</span>]: times <span class="op">=</span> pd.date_range(<span class="st">"2017-05-20 00:00"</span>, freq<span class="op">=</span><span class="st">"1min"</span>, periods<span class="op">=</span>N)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">241</span>]: df <span class="op">=</span> pd.DataFrame({<span class="st">"time"</span>: times,</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>   .....:                    <span class="st">"value"</span>: np.arange(N)})</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">242</span>]: df</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">242</span>]: </span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>                  time  value</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>  <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">00</span>:<span class="dv">00</span>      <span class="dv">0</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">1</span>:<span class="dv">00</span>      <span class="dv">1</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">2</span>:<span class="dv">00</span>      <span class="dv">2</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">3</span>:<span class="dv">00</span>      <span class="dv">3</span></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>  <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">4</span>:<span class="dv">00</span>      <span class="dv">4</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>  <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">5</span>:<span class="dv">00</span>      <span class="dv">5</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>  <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">6</span>:<span class="dv">00</span>      <span class="dv">6</span></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>  <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">7</span>:<span class="dv">00</span>      <span class="dv">7</span></span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>  <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">8</span>:<span class="dv">00</span>      <span class="dv">8</span></span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span>  <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">9</span>:<span class="dv">00</span>      <span class="dv">9</span></span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">10</span>:<span class="dv">00</span>     <span class="dv">10</span></span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span> <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">11</span>:<span class="dv">00</span>     <span class="dv">11</span></span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span> <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">12</span>:<span class="dv">00</span>     <span class="dv">12</span></span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span> <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">13</span>:<span class="dv">00</span>     <span class="dv">13</span></span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a><span class="dv">14</span> <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">14</span>:<span class="dv">00</span>     <span class="dv">14</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Here, we can index by <code>"time"</code> and then resample:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">243</span>]: df.set_index(<span class="st">"time"</span>).resample(<span class="st">"5min"</span>).count()</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">243</span>]: </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>                     value</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>time                      </span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">00</span>:<span class="dv">00</span>      <span class="dv">5</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">5</span>:<span class="dv">00</span>      <span class="dv">5</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">10</span>:<span class="dv">00</span>      <span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Suppose that a DataFrame contains multiple time series, marked by an additional group key column:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">244</span>]: df2 <span class="op">=</span> pd.DataFrame({<span class="st">"time"</span>: times.repeat(<span class="dv">3</span>),</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>   .....:                     <span class="st">"key"</span>: np.tile([<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>], N),</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>   .....:                     <span class="st">"value"</span>: np.arange(N <span class="op">*</span> <span class="fl">3.</span>)})</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">245</span>]: df2.head(<span class="dv">7</span>)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">245</span>]: </span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>                 time key  value</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">00</span>:<span class="dv">00</span>   a    <span class="fl">0.0</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">00</span>:<span class="dv">00</span>   b    <span class="fl">1.0</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">00</span>:<span class="dv">00</span>   c    <span class="fl">2.0</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">1</span>:<span class="dv">00</span>   a    <span class="fl">3.0</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">1</span>:<span class="dv">00</span>   b    <span class="fl">4.0</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">1</span>:<span class="dv">00</span>   c    <span class="fl">5.0</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">2</span>:<span class="dv">00</span>   a    <span class="fl">6.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To do the same resampling for each value of <code>"key"</code>, we introduce the <code>pandas.Grouper</code> object:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">246</span>]: time_key <span class="op">=</span> pd.Grouper(freq<span class="op">=</span><span class="st">"5min"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We can then set the time index, group by <code>"key"</code> and <code>time_key</code>, and aggregate:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">247</span>]: resampled <span class="op">=</span> (df2.set_index(<span class="st">"time"</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>   .....:              .groupby([<span class="st">"key"</span>, time_key])</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>   .....:              .<span class="bu">sum</span>())</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">248</span>]: resampled</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">248</span>]: </span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>                         value</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>key time                      </span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>a   <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">00</span>:<span class="dv">00</span>   <span class="fl">30.0</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">5</span>:<span class="dv">00</span>  <span class="fl">105.0</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">10</span>:<span class="dv">00</span>  <span class="fl">180.0</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>b   <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">00</span>:<span class="dv">00</span>   <span class="fl">35.0</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">5</span>:<span class="dv">00</span>  <span class="fl">110.0</span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">10</span>:<span class="dv">00</span>  <span class="fl">185.0</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>c   <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">00</span>:<span class="dv">00</span>   <span class="fl">40.0</span></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">5</span>:<span class="dv">00</span>  <span class="fl">115.0</span></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">10</span>:<span class="dv">00</span>  <span class="fl">190.0</span></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">249</span>]: resampled.reset_index()</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">249</span>]: </span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>  key                time  value</span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>   a <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">00</span>:<span class="dv">00</span>   <span class="fl">30.0</span></span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>   a <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">5</span>:<span class="dv">00</span>  <span class="fl">105.0</span></span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>   a <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">10</span>:<span class="dv">00</span>  <span class="fl">180.0</span></span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>   b <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">00</span>:<span class="dv">00</span>   <span class="fl">35.0</span></span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>   b <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">5</span>:<span class="dv">00</span>  <span class="fl">110.0</span></span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>   b <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">10</span>:<span class="dv">00</span>  <span class="fl">185.0</span></span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>   c <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">00</span>:<span class="dv">00</span>   <span class="fl">40.0</span></span>
<span id="cb101-29"><a href="#cb101-29" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>   c <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">0</span><span class="er">5</span>:<span class="dv">00</span>  <span class="fl">115.0</span></span>
<span id="cb101-30"><a href="#cb101-30" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span>   c <span class="dv">2017</span><span class="op">-</span><span class="dv">0</span><span class="er">5</span><span class="op">-</span><span class="dv">20</span> <span class="dv">00</span>:<span class="dv">10</span>:<span class="dv">00</span>  <span class="fl">190.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>One constraint with using <code>pandas.Grouper</code> is that the time must be the index of the Series or DataFrame.</p>
</section>
</section>
<section id="tseries_moving_funcs" class="level2" data-number="11.7">
<h2 data-number="11.7" class="anchored" data-anchor-id="tseries_moving_funcs"><span class="header-section-number">11.7</span> Moving Window Functions</h2>
<p>An important class of array transformations used for time series operations are statistics and other functions evaluated over a sliding window or with exponentially decaying weights. This can be useful for smoothing noisy or gappy data. I call these <em>moving window functions</em>, even though they include functions without a fixed-length window like exponentially weighted moving average. Like other statistical functions, these also automatically exclude missing data.</p>
<p>Before digging in, we can load up some time series data and resample it to business day frequency:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">250</span>]: close_px_all <span class="op">=</span> pd.read_csv(<span class="st">"examples/stock_px.csv"</span>,</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>   .....:                            parse_dates<span class="op">=</span><span class="va">True</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">251</span>]: close_px <span class="op">=</span> close_px_all[[<span class="st">"AAPL"</span>, <span class="st">"MSFT"</span>, <span class="st">"XOM"</span>]]</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">252</span>]: close_px <span class="op">=</span> close_px.resample(<span class="st">"B"</span>).ffill()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>I now introduce the <code>rolling</code> operator, which behaves similarly to <code>resample</code> and <code>groupby</code>. It can be called on a Series or DataFrame along with a <code>window</code> (expressed as a number of periods; see <a href="#apple_daily_ma250">Apple price with 250-day moving average</a> for the plot created):</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">253</span>]: close_px[<span class="st">"AAPL"</span>].plot()</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">253</span>]: <span class="op">&lt;</span>Axes: <span class="op">&gt;</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">254</span>]: close_px[<span class="st">"AAPL"</span>].rolling(<span class="dv">250</span>).mean().plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-apple_daily_ma250" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figs/apple_daily_ma250.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;11.4: Apple price with 250-day moving average</figcaption>
</figure>
</div>
<p>The expression <code>rolling(250)</code> is similar in behavior to <code>groupby</code>, but instead of grouping, it creates an object that enables grouping over a 250-day sliding window. So here we have the 250-day moving window average of Apple's stock price.</p>
<p>By default, rolling functions require all of the values in the window to be non-NA. This behavior can be changed to account for missing data and, in particular, the fact that you will have fewer than <code>window</code> periods of data at the beginning of the time series (see <a href="#apple_daily_std250">Apple 250-day daily return standard deviation</a>):</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">255</span>]: plt.figure()</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">255</span>]: <span class="op">&lt;</span>Figure size <span class="dv">1000</span><span class="er">x600</span> <span class="cf">with</span> <span class="dv">0</span> Axes<span class="op">&gt;</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">256</span>]: std250 <span class="op">=</span> close_px[<span class="st">"AAPL"</span>].pct_change().rolling(<span class="dv">250</span>, min_periods<span class="op">=</span><span class="dv">10</span>).std</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>()</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">257</span>]: std250[<span class="dv">5</span>:<span class="dv">12</span>]</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">257</span>]: </span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="dv">2003</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span>         NaN</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2003</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">10</span>         NaN</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2003</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">13</span>         NaN</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2003</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">14</span>         NaN</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2003</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">15</span>         NaN</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2003</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">16</span>    <span class="fl">0.009628</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a><span class="dv">2003</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">17</span>    <span class="fl">0.013818</span></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>Freq: B, Name: AAPL, dtype: float64</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">258</span>]: std250.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-apple_daily_std250" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figs/apple_daily_std250.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;11.5: Apple 250-day daily return standard deviation</figcaption>
</figure>
</div>
<p>To compute an <em>expanding window mean</em>, use the <code>expanding</code> operator instead of <code>rolling</code>. The expanding mean starts the time window from the same point as the rolling window and increases the size of the window until it encompasses the whole series. An expanding window mean on the <code>std250</code> time series looks like this:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">259</span>]: expanding_mean <span class="op">=</span> std250.expanding().mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Calling a moving window function on a DataFrame applies the transformation to each column (see <a href="#stocks_daily_ma60">Stock prices 60-day moving average (log y-axis)</a>):</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">261</span>]: plt.style.use(<span class="st">'grayscale'</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">262</span>]: close_px.rolling(<span class="dv">60</span>).mean().plot(logy<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-stocks_daily_ma60" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figs/stocks_daily_ma60.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;11.6: Stock prices 60-day moving average (log y-axis)</figcaption>
</figure>
</div>
<p>The <code>rolling</code> function also accepts a string indicating a fixed-size time offset rolling() in moving window functions rather than a set number of periods. Using this notation can be useful for irregular time series. These are the same strings that you can pass to <code>resample</code>. For example, we could compute a 20-day rolling mean like so:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">263</span>]: close_px.rolling(<span class="st">"20D"</span>).mean()</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">263</span>]: </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>                  AAPL       MSFT        XOM</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2003</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">2</span>    <span class="fl">7.400000</span>  <span class="fl">21.110000</span>  <span class="fl">29.220000</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="dv">2003</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">3</span>    <span class="fl">7.425000</span>  <span class="fl">21.125000</span>  <span class="fl">29.230000</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="dv">2003</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">6</span>    <span class="fl">7.433333</span>  <span class="fl">21.256667</span>  <span class="fl">29.473333</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="dv">2003</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">7</span>    <span class="fl">7.432500</span>  <span class="fl">21.425000</span>  <span class="fl">29.342500</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="dv">2003</span><span class="op">-</span><span class="dv">0</span><span class="er">1</span><span class="op">-</span><span class="dv">0</span><span class="er">8</span>    <span class="fl">7.402000</span>  <span class="fl">21.402000</span>  <span class="fl">29.240000</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>...                ...        ...        ...</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">10</span><span class="op">-</span><span class="dv">10</span>  <span class="fl">389.351429</span>  <span class="fl">25.602143</span>  <span class="fl">72.527857</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">10</span><span class="op">-</span><span class="dv">11</span>  <span class="fl">388.505000</span>  <span class="fl">25.674286</span>  <span class="fl">72.835000</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">10</span><span class="op">-</span><span class="dv">12</span>  <span class="fl">388.531429</span>  <span class="fl">25.810000</span>  <span class="fl">73.400714</span></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">10</span><span class="op">-</span><span class="dv">13</span>  <span class="fl">388.826429</span>  <span class="fl">25.961429</span>  <span class="fl">73.905000</span></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a><span class="dv">2011</span><span class="op">-</span><span class="dv">10</span><span class="op">-</span><span class="dv">14</span>  <span class="fl">391.038000</span>  <span class="fl">26.048667</span>  <span class="fl">74.185333</span></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2292</span> rows x <span class="dv">3</span> columns]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="tseries_moving_expw" class="level3">
<h3 class="anchored" data-anchor-id="tseries_moving_expw">Exponentially Weighted Functions</h3>
<p>An alternative to using a fixed window size with equally weighted observations is to specify a constant <em>decay factor</em> to give more weight to more recent observations. There are a couple of ways to specify the decay factor. A popular one is using a <em>span</em>, which makes the result comparable to a simple moving window function with window size equal to the span.</p>
<p>Since an exponentially weighted statistic places more weight on more recent observations, it “adapts” faster to changes compared with the equal-weighted version.</p>
<p>pandas has the <code>ewm</code> operator (which stands for exponentially weighted moving) to go along with <code>rolling</code> and <code>expanding</code>. Here’s an example comparing a 30-day moving average of Apple’s stock price with an exponentially weighted (EW) moving average with <code>span=60</code> (see <a href="#timeseries_ewma">Simple moving average versus exponentially weighted</a>):</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">265</span>]: aapl_px <span class="op">=</span> close_px[<span class="st">"AAPL"</span>][<span class="st">"2006"</span>:<span class="st">"2007"</span>]</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">266</span>]: ma30 <span class="op">=</span> aapl_px.rolling(<span class="dv">30</span>, min_periods<span class="op">=</span><span class="dv">20</span>).mean()</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">267</span>]: ewma30 <span class="op">=</span> aapl_px.ewm(span<span class="op">=</span><span class="dv">30</span>).mean()</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">268</span>]: aapl_px.plot(style<span class="op">=</span><span class="st">"k-"</span>, label<span class="op">=</span><span class="st">"Price"</span>)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">268</span>]: <span class="op">&lt;</span>Axes: <span class="op">&gt;</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">269</span>]: ma30.plot(style<span class="op">=</span><span class="st">"k--"</span>, label<span class="op">=</span><span class="st">"Simple Moving Avg"</span>)</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">269</span>]: <span class="op">&lt;</span>Axes: <span class="op">&gt;</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">270</span>]: ewma30.plot(style<span class="op">=</span><span class="st">"k-"</span>, label<span class="op">=</span><span class="st">"EW MA"</span>)</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>Out[<span class="dv">270</span>]: <span class="op">&lt;</span>Axes: <span class="op">&gt;</span></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">271</span>]: plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-timeseries_ewma" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figs/timeseries_ewma.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;11.7: Simple moving average versus exponentially weighted</figcaption>
</figure>
</div>
</section>
<section id="tseries_moving_binary" class="level3">
<h3 class="anchored" data-anchor-id="tseries_moving_binary">Binary Moving Window Functions</h3>
<p>Some statistical operators, like correlation and covariance, need to operate on two time series. As an example, financial analysts are often interested in a stock’s correlation to a benchmark index like the S&amp;P 500. To have a look at this, we first compute the percent change for all of our time series of interest:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">273</span>]: spx_px <span class="op">=</span> close_px_all[<span class="st">"SPX"</span>]</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">274</span>]: spx_rets <span class="op">=</span> spx_px.pct_change()</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">275</span>]: returns <span class="op">=</span> close_px.pct_change()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>After we call <code>rolling</code>, the <code>corr</code> aggregation function can then compute the rolling correlation with <code>spx_rets</code> (see <a href="#roll_correl_aapl">Six-month AAPL return correlation to S&amp;P 500</a> for the resulting plot):</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">276</span>]: corr <span class="op">=</span> returns[<span class="st">"AAPL"</span>].rolling(<span class="dv">125</span>, min_periods<span class="op">=</span><span class="dv">100</span>).corr(spx_rets)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">277</span>]: corr.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-roll_correl_aapl" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figs/roll_correl_aapl.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;11.8: Six-month AAPL return correlation to S&amp;P 500</figcaption>
</figure>
</div>
<p>Suppose you wanted to compute the rolling correlation of the S&amp;P 500 index with many stocks at once. You could write a loop computing this for each stock like we did for Apple above, but if each stock is a column in a single DataFrame, we can compute all of the rolling correlations in one shot by calling <code>rolling</code> on the DataFrame and passing the <code>spx_rets</code> Series.</p>
<p>See <a href="#roll_correl_all">Six-month return correlations to S&amp;P 500</a> for the plot of the result:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">279</span>]: corr <span class="op">=</span> returns.rolling(<span class="dv">125</span>, min_periods<span class="op">=</span><span class="dv">100</span>).corr(spx_rets)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">280</span>]: corr.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-roll_correl_all" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figs/roll_correl_all.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;11.9: Six-month return correlations to S&amp;P 500</figcaption>
</figure>
</div>
</section>
<section id="tseries_moving_custom" class="level3">
<h3 class="anchored" data-anchor-id="tseries_moving_custom">User-Defined Moving Window Functions</h3>
<p>The <code>apply</code> method on <code>rolling</code> and related methods provides a way to apply an array function of your own creation over a moving window. The only requirement is that the function produce a single value (a reduction) from each piece of the array. For example, while we can compute sample quantiles using <code>rolling(...).quantile(q)</code>, we might be interested in the percentile rank of a particular value over the sample. The <code>scipy.stats.percentileofscore</code> function does just this (see <a href="#roll_apply_ex">Percentile rank of 2% AAPL return over one-year window</a> for the resulting plot):</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">282</span>]: <span class="im">from</span> scipy.stats <span class="im">import</span> percentileofscore</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">283</span>]: <span class="kw">def</span> score_at_2percent(x):</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>   .....:     <span class="cf">return</span> percentileofscore(x, <span class="fl">0.02</span>)</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">284</span>]: result <span class="op">=</span> returns[<span class="st">"AAPL"</span>].rolling(<span class="dv">250</span>).<span class="bu">apply</span>(score_at_2percent)</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>In [<span class="dv">285</span>]: result.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-roll_apply_ex" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figs/roll_apply_ex.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;11.10: Percentile rank of 2% AAPL return over one-year window</figcaption>
</figure>
</div>
<p>If you don't have SciPy installed already, you can install it with conda or pip:</p>
<pre><code>conda install scipy</code></pre>
</section>
</section>
<section id="timeseries-conclusion" class="level2" data-number="11.8">
<h2 data-number="11.8" class="anchored" data-anchor-id="timeseries-conclusion"><span class="header-section-number">11.8</span> Conclusion</h2>
<p>Time series data calls for different types of analysis and data transformation tools than the other types of data we have explored in previous chapters.</p>
<p>In the following chapter, we will show how to start using modeling libraries like statsmodels and scikit-learn.</p>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>The choice of the default values for <code>closed</code> and <code>label</code> might seem a bit odd to some users. The default is <code>closed="left"</code> for all but a specific set (<code>"M"</code>, <code>"A"</code>, <code>"Q"</code>, <code>"BM"</code>, <code>"BQ"</code>, and <code>"W"</code>) for which the default is <code>closed="right"</code>. The defaults were chosen to make the results more intuitive, but it is worth knowing that the default is not always one or the other.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

<script async="" defer="" src="https://scripts.simpleanalyticscdn.com/latest.js"></script></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a class='pagination-link' href='/book/data-aggregation'>
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data Aggregation and Group Operations</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a class='pagination-link' href='/book/modeling'>
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Modeling Libraries in Python</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2023, Wes McKinney. All Rights Reserved.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/wesmckinn">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script async="" src="https://media.ethicalads.io/media/client/ethicalads.min.js"></script>



</body></html>